<html>
<head>
<title> 109/10/07 V1.00.42 Allen Ho Initial 紅利積點兌換贈品登錄檔維護作業</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8;">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
<link rel="stylesheet" href="js/Calendar/calendar.css">
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>
<script language="JavaScript" src="js/jquery.js"></script>
</head>

<body background="${water_mark}" >
<form name="dataForm"  method="post" action="">

<table border="0" cellpadding="0" cellspacing="0" style="margin-bottom:10px;">
<!-- Button **************************************************************-->
 <tr>
   <td width="100">&nbsp;</td>
   <td colspan="4">
     <img height="30" src="images/upperLevel.gif" style="cursor:hand;" onClick="top.upperLevel()"; alt="回上層"; onmouseout="top.light_img(this);"; onmouseover="top.dark_img(this);">&nbsp;
     <input type="Button" name="btnUpdate"  value="存檔"  ${btnUpdate_disable} onClick="return top.submitControl('U')" class="btUpdate" >&nbsp;&nbsp;
     <input type="Button" name="btnDelete"  value="刪除" ${btnDelete_disable} onClick="return top.submitControl('D')" class="btDelete" >&nbsp;&nbsp;
   </td>
 </tr>
</table>
<div id="dataBlock">
<!-- Detail data detl *************************************************** -->
 <table width="80%" border="0" cellspacing="0" cellpadding="4">
   <tr>
     <td nowrap class="colKey">卡　　號:
       <span class="dsp_text">${card_no}</span>
       <input   type="hidden" name="card_no" value="${card_no}" />
     </td>
     <td  nowrap  >放行狀態: 
       <span class="dsp_text">${aud_type}.${commfunc_aud_type}</span>
       <input       type="hidden" name="aud_type" value="${aud_type}" />
       <input    type="hidden" name="commfunc_aud_type" value="${commfunc_aud_type}" />
     </td>
   </tr>
   <tr>
     <td nowrap class="colKey" colspan="4">商品代碼:
       <span class="dsp_text">${gift_no}</span>
       <input   type="hidden" name="gift_no" value="${gift_no}" />
              -${comm_gift_no}
     <input    type="hidden" name="comm_gift_no" value="${comm_gift_no}" />
     </td>
   </tr>
   <tr>
     <td nowrap class="colKey" colspan="4">交易序號:
       <span class="dsp_text">${tran_seqno}</span>
       <input   type="hidden" name="tran_seqno" value="${tran_seqno}" />
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="80%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　　　　　卡友基本資料　　　　　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td  nowrap  >帳戶類別: 
       <input      size="2" class="dsp_text" type="text" name="acct_type" value="${acct_type}" readonly/>
               - ${comm_acct_type}
     <input    type="hidden" name="comm_acct_type" value="${comm_acct_type}" />
         　身分證號: 
       <input      zEdit="="any,canTW"" class="dsp_text" type="text" name="id_no" value="${id_no}" readonly/>
         　VIP: 
       <input      size="1" class="dsp_text" type="text" name="vip_code" value="${vip_code}" readonly/>
              ${comm_vip_code}
     <input    type="hidden" name="comm_vip_code" value="${comm_vip_code}" />
     </td>
   </tr>
   <tr>
   </tr>
   <tr>
   </tr>
   <tr>
     <td nowrap>收件人姓名:&nbsp; 
       <input type="text" class="col_any" name="chi_name" value="${chi_name}"
              zEdit="any,canTW" maxlength="50" size="50" />
     </td>
   </tr>
   <tr>
     <td nowrap>手機號碼:&nbsp; 
       <input type="text" class="col_any" name="cellar_phone" value="${cellar_phone}"
              zEdit="any" maxlength="15" size="15" />
     </td>
   </tr>
   <tr>
     <td nowrap>電話：(H)&nbsp; 
       <input type="text" class="col_any" name="home_area_code1" value="${home_area_code1}"
              zEdit="any,canTW" maxlength="4" size="4" />
         - 
       <input type="text" class="col_any" name="home_tel_no1" value="${home_tel_no1}"
              zEdit="any,canTW" maxlength="10" size="10" />
         - 
       <input type="text" class="col_any" name="home_tel_ext1" value="${home_tel_ext1}"
              zEdit="any,canTW" maxlength="6" size="6" />
              (O)
         - 
       <input type="text" class="col_any" name="office_area_code1" value="${office_area_code1}"
              zEdit="any,canTW" maxlength="4" size="4" />
         - 
       <input type="text" class="col_any" name="office_tel_no1" value="${office_tel_no1}"
              zEdit="any,canTW" maxlength="10" size="10" />
         - 
       <input type="text" class="col_any" name="office_tel_ext1" value="${office_tel_ext1}"
              zEdit="any,canTW" maxlength="6" size="6" />
     </td>
   </tr>
   <tr>
     <td nowrap>收件人地址：&nbsp;
       <select name="bill_sending_zip" class="col_ddlb" id="ajaxh_bill_sending_zip"  onChange="columnItemChange('2')" />
               ${dddw_zipcode}
       </select>
          
       <input type="text" class="col_any" name="bill_sending_addr1" value="${bill_sending_addr1}"
              zEdit="any,canTW" maxlength="10" size="10" />
              縣市
          
       <input type="text" class="col_any" name="bill_sending_addr2" value="${bill_sending_addr2}"
              zEdit="any,canTW" maxlength="10" size="10" />
              鄉鎮市區
          
       <input type="text" class="col_any" name="bill_sending_addr3" value="${bill_sending_addr3}"
              zEdit="any,canTW" maxlength="12" size="12" />
              村里
     </td>
   </tr>
   <tr>
     <td nowrap>　　　　　　&nbsp; 
       <input type="text" class="col_any" name="bill_sending_addr4" value="${bill_sending_addr4}"
              zEdit="any,canTW" maxlength="12" size="12" />
              鄰
          
       <input type="text" class="col_any" name="bill_sending_addr5" value="${bill_sending_addr5}"
              zEdit="any,canTW" maxlength="56" size="56" />
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="80%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　　　　　　　兌換登錄處理　　　　　　　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td  nowrap  >贈品類別: 
       <input      size="1" class="dsp_text" type="text" name="gift_type" value="${gift_type}" readonly/>
               - ${comm_gift_type}
     <input    type="hidden" name="comm_gift_type" value="${comm_gift_type}" />
         　基金代碼: 
       <input      size="10" class="dsp_text" type="text" name="fund_code" value="${fund_code}" readonly/>
               - ${comm_fund_code}
     <input    type="hidden" name="comm_fund_code" value="${comm_fund_code}" />
         　來源管道: 
       <span class="dsp_text">${from_mark}</span>
       <input      size="1"  type="hidden" name="from_mark" value="${from_mark}" />
               - ${comm_from_mark}
     <input    type="hidden" name="comm_from_mark" value="${comm_from_mark}" />
     </td>
   </tr>
   <tr>
     <td nowrap>兌換數量:&nbsp; 
       <input type="text" class="col_number" name="exchg_cnt" value="${exchg_cnt}"
              zEdit="number" maxlength="5" size="5"  onChange="columnItemChange('6')"/>
              單位
         　贈品價格: 
       <input      size="8" class="dsp_text" type="text" name="cash_value" value="${cash_value}" readonly/>
              元
         　　代碼： 
       <input      size="4" class="dsp_text" type="text" name="bonus_type" value="${bonus_type}" readonly/>
               - ${comm_bonus_type}
     <input    type="hidden" name="comm_bonus_type" value="${comm_bonus_type}" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >每單位應扣點數: 
       <input      size="8" class="dsp_text" type="text" name="exchg_pt" value="${exchg_pt.(999)}" readonly/>
         自付金額: 
       <input      size="12" class="dsp_text" type="text" name="exchg_amt" value="${exchg_amt.(999)}" readonly/>
         累計應扣點數: 
       <input      size="8" class="dsp_text" type="text" name="total_pt" value="${total_pt.(999)}" readonly/>
     </td>
   </tr>
   <tr>
     <td  nowrap  >兌換時點數餘額: 
       <input      size="10" class="dsp_text" type="text" name="end_tran_bp" value="${end_tran_bp.(999)}" readonly/>
       (<input      size="10" class="dsp_text" type="text" name="end_tran_bp01" value="${end_tran_bp01.(999)}" readonly/>
       +<input      size="10" class="dsp_text" type="text" name="end_tran_bp90" value="${end_tran_bp90.(999)}" readonly/>
       )<input      size="40" zEdit="="any,canTW"" class="dsp_text" type="text" name="diff_pt_msg" value="${diff_pt_msg}" readonly/>
     </td>
   </tr>
   <tr>
     <td nowrap>兌換註記:&nbsp; 
       <input type="text" class="col_any" name="exchg_mark" value="${exchg_mark}"
              zEdit="any,canTW" maxlength="40" size="40" />
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="80%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　　　　　　　兌換處理結果　　　　　　　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td  nowrap  >兌換日期: 
       <span class="dsp_date">${tran_date.YMD}</span>
       <input      size="8"  type="hidden" name="tran_date" value="${tran_date}" />
         　最後覆核類別: 
       <span class="dsp_text">${proc_flag}</span>
       <input      size="1"  type="hidden" name="proc_flag" value="${proc_flag}" />
               - ${comm_proc_flag}
     <input    type="hidden" name="comm_proc_flag" value="${comm_proc_flag}" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >兌換進度: 
       <span class="dsp_text">${status_flag}</span>
       <input      size="1"  type="hidden" name="status_flag" value="${status_flag}" />
               - ${comm_status_flag}
     <input    type="hidden" name="comm_status_flag" value="${comm_status_flag}" />
         　　兌換扣點註記: 
       <span class="dsp_text">${deduct_flag}</span>
       <input      size="1"  type="hidden" name="deduct_flag" value="${deduct_flag}" />
               - ${comm_deduct_flag}
     <input    type="hidden" name="comm_deduct_flag" value="${comm_deduct_flag}" />
         　　扣點日期: 
       <span class="dsp_date">${deduct_date.YMD}</span>
       <input      size="8"  type="hidden" name="deduct_date" value="${deduct_date}" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >兌換覆核人員: 
       <span class="dsp_text">${exg_apr_user}</span>
       <input      size="10"  type="hidden" name="exg_apr_user" value="${exg_apr_user}" />
               - ${comm_exg_apr_user}
     <input    type="hidden" name="comm_exg_apr_user" value="${comm_exg_apr_user}" />
         　　兌換覆核日期: 
       <span class="dsp_date">${exg_apr_date.YMD}</span>
       <input      size="8"  type="hidden" name="exg_apr_date" value="${exg_apr_date}" />
         　　兌換起帳日期: 
       <span class="dsp_date">${exg_gl_date.YMD}</span>
       <input      size="8"  type="hidden" name="exg_gl_date" value="${exg_gl_date}" />
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="80%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　　　　　電子商品　　　　　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td  nowrap  >電子商品批號: 
       <span class="dsp_text">${ecoupon_bno}</span>
       <input      size="10"  type="hidden" name="ecoupon_bno" value="${ecoupon_bno}" />
         有效起迄日: 
       <span class="dsp_date">${ecoupon_date_s.YMD}</span>
       <input      size="8"  type="hidden" name="ecoupon_date_s" value="${ecoupon_date_s}" />
         ~ 
       <span class="dsp_date">${ecoupon_date_e.YMD}</span>
       <input      size="8"  type="hidden" name="ecoupon_date_e" value="${ecoupon_date_e}" />
         給號日期: 
       <span class="dsp_date">${ecoupon_date.YMD}</span>
       <input      size="8"  type="hidden" name="ecoupon_date" value="${ecoupon_date}" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >未請款數量: 
       <span class="dsp_text">${unpay_cnt}</span>
       <input      size="8"  type="hidden" name="unpay_cnt" value="${unpay_cnt}" />
         屆期回沖日期: 
       <span class="dsp_date">${ecoupon_ret_date.YMD}</span>
       <input      size="8"  type="hidden" name="ecoupon_ret_date" value="${ecoupon_ret_date}" />
         回沖啟帳日期: 
       <span class="dsp_date">${ecoupon_gl_date.YMD}</span>
       <input      size="8"  type="hidden" name="ecoupon_gl_date" value="${ecoupon_gl_date}" />
     </td>
   </tr>
   <tr>
     <td nowrap>簡訊旗標:&nbsp;
       <select name="sms_flag" class="col_ddlb"  >
       <option value=" ">--</option>
       <option value="N" ${sms_flag-N} >N.未發送簡訊</option>
       <option value="Y" ${sms_flag-Y} >Y.已發送簡訊</option>
       <option value="R" ${sms_flag-R} >R.重發送簡訊</option>
       </select>
         　　簡訊發送日期: 
       <span class="dsp_date">${sms_date.YMD}</span>
       <input      size="8"  type="hidden" name="sms_date" value="${sms_date}" />
     </td>
   </tr>
   <tr>
     <td nowrap>簡訊重送備註:&nbsp; 
       <input type="text" class="col_any" name="sms_resend_desc" value="${sms_resend_desc}"
              zEdit="any,canTW" maxlength="40" size="40" />
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="80%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　　　　　航空里程　　　　　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td  nowrap  >航空公司: 
       <input      size="2" class="dsp_text" type="text" name="air_type" value="${air_type}" readonly/>
               - ${comm_air_type}
     <input    type="hidden" name="comm_air_type" value="${comm_air_type}" />
     </td>
   </tr>
   <tr>
     <td nowrap>航空會員編號:&nbsp; 
       <input type="text" class="col_any" name="cal_dfpno" value="${cal_dfpno}"
              zEdit="any" maxlength="10" size="10" />
         身分證號: 
       <input type="text" class="col_text" name="air_id_no" value="${air_id_no}"
              zEdit="any,upper" maxlength="10" size="10" />
         出生日期: 
       <input type="text" class="col_any" name="air_birthday" value="${air_birthday}"
              zEdit="any" maxlength="8" size="8" />
     </td>
   </tr>
   <tr>
     <td nowrap>護照名/姓名:&nbsp; 
       <input type="text" class="col_any" name="passport_name" value="${passport_name}"
              zEdit="any" maxlength="25" size="25" />
         護照姓: 
       <input type="text" class="col_any" name="passport_surname" value="${passport_surname}"
              zEdit="any" maxlength="10" size="10" />
              (國泰航空姓與名請分開輸入)
     </td>
   </tr>
   <tr>
     <td  nowrap  >送檔日期: 
       <span class="dsp_date">${send_date.YMD}</span>
       <input      size="8"  type="hidden" name="send_date" value="${send_date}" />
         - 
       <span class="dsp_text">${send_time}</span>
       <input      size="6"  type="hidden" name="send_time" value="${send_time}" />
         　　收檔日期: 
       <span class="dsp_date">${recv_date.YMD}</span>
       <input      size="8"  type="hidden" name="recv_date" value="${recv_date}" />
         - 
       <span class="dsp_text">${recv_time}</span>
       <input      size="6"  type="hidden" name="recv_time" value="${recv_time}" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >回覆識別: 
       <span class="dsp_text">${rjct_flag}</span>
       <input      size="1"  type="hidden" name="rjct_flag" value="${rjct_flag}" />
               - ${comm_rjct_flag}
     <input    type="hidden" name="comm_rjct_flag" value="${comm_rjct_flag}" />
         　退件代號: 
       <span class="dsp_text">${rjct_code}</span>
       <input      size="2"  type="hidden" name="rjct_code" value="${rjct_code}" />
         　退件訊息: 
       <span class="dsp_text">${rjct_msg}</span>
       <input      size="50"  type="hidden" name="rjct_msg" value="${rjct_msg}" />
     </td>
   </tr>
   <tr>
     <td nowrap>退件處理:&nbsp;
       <select name="rjct_proc_code" class="col_ddlb"  >
       <option value=" ">--</option>
       <option value="2" ${rjct_proc_code-2} >2.修改重送</option>
       <option value="C" ${rjct_proc_code-C} >C.結案取消</option>
       </select>
     </td>
   </tr>
   <tr>
     <td nowrap>退件處理說明:&nbsp; 
       <input type="text" class="col_any" name="rjct_proc_remark" value="${rjct_proc_remark}"
              zEdit="any,canTW" maxlength="60" size="60" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >航空覆核人員: 
       <span class="dsp_text">${air_apr_user}</span>
       <input      size="10"  type="hidden" name="air_apr_user" value="${air_apr_user}" />
               - ${comm_air_apr_user}
     <input    type="hidden" name="comm_air_apr_user" value="${comm_air_apr_user}" />
         　航空覆核日期: 
       <span class="dsp_date">${air_apr_date.YMD}</span>
       <input      size="8"  type="hidden" name="air_apr_date" value="${air_apr_date}" />
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="80%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　　　　　出貨明細　　　　　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td nowrap>出貨日期:&nbsp; 
       <input type="text" class="col_date" name="out_date" value="${out_date}"
              zEdit="date,yyyymmdd" maxlength="8" size="8" />
      <script language="JavaScript">
                new tcal ({'formname': 'dataForm','controlname': 'out_date'});
      </script>
         　　出貨單號: 
       <input type="text" class="col_any" name="out_batchno" value="${out_batchno}"
              zEdit="any,canTW" maxlength="20" size="20" />
     </td>
   </tr>
   <tr>
     <td nowrap>出貨備註:&nbsp; 
       <input type="text" class="col_any" name="out_mark" value="${out_mark}"
              zEdit="any,canTW" maxlength="40" size="40" />
         　掛號號碼: 
       <input type="text" class="col_any" name="register_no" value="${register_no}"
              zEdit="any,canTW" maxlength="20" size="20" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >出貨覆核人員: 
       <span class="dsp_text">${out_apr_user}</span>
       <input      size="10"  type="hidden" name="out_apr_user" value="${out_apr_user}" />
               - ${comm_out_apr_user}
     <input    type="hidden" name="comm_out_apr_user" value="${comm_out_apr_user}" />
         　出貨覆核日期: 
       <span class="dsp_date">${out_apr_date.YMD}</span>
       <input      size="8"  type="hidden" name="out_apr_date" value="${out_apr_date}" />
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="80%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　　　　　請款明細　　　　　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td nowrap>請款日期:&nbsp; 
       <input type="text" class="col_date" name="pay_date" value="${pay_date}"
              zEdit="date,yyyymmdd" maxlength="8" size="8" />
      <script language="JavaScript">
                new tcal ({'formname': 'dataForm','controlname': 'pay_date'});
      </script>
         　請款起帳日期: 
       <span class="dsp_date">${pay_gl_date.YMD}</span>
       <input      size="8"  type="hidden" name="pay_gl_date" value="${pay_gl_date}" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >請款覆核人員: 
       <span class="dsp_text">${pay_apr_user}</span>
       <input      size="10"  type="hidden" name="pay_apr_user" value="${pay_apr_user}" />
               - ${comm_pay_apr_user}
     <input    type="hidden" name="comm_pay_apr_user" value="${comm_pay_apr_user}" />
         　請款覆核日期: 
       <span class="dsp_date">${pay_apr_date.YMD}</span>
       <input      size="8"  type="hidden" name="pay_apr_date" value="${pay_apr_date}" />
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="80%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　　　取消兌換/退貨/電子商品註銷 明細資料　　　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td nowrap>退貨日期:&nbsp; 
       <input type="text" class="col_date" name="return_date" value="${return_date}"
              zEdit="date,yyyymmdd" maxlength="8" size="8" />
      <script language="JavaScript">
                new tcal ({'formname': 'dataForm','controlname': 'return_date'});
      </script>
         　退貨原因: 
       <select name="return_reason" class="col_ddlb" />
               ${dddw_return_reason}
       </select>
     </td>
   </tr>
   <tr>
     <td nowrap>退貨說明:&nbsp; 
       <input type="text" class="col_any" name="return_mark" value="${return_mark}"
              zEdit="any,canTW" maxlength="60" size="60" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >退貨覆核人員: 
       <span class="dsp_text">${ret_apr_user}</span>
       <input      size="10"  type="hidden" name="ret_apr_user" value="${ret_apr_user}" />
               - ${comm_ret_apr_user}
     <input    type="hidden" name="comm_ret_apr_user" value="${comm_ret_apr_user}" />
         　退貨覆核日期: 
       <span class="dsp_date">${ret_apr_date.YMD}</span>
       <input      size="8"  type="hidden" name="ret_apr_date" value="${ret_apr_date}" />
         　退貨起帳日期: 
       <span class="dsp_text">${ret_gl_date}</span>
       <input      size="8"  type="hidden" name="ret_gl_date" value="${ret_gl_date}" />
     </td>
   </tr>
 </table>
 <table width="80%" border="0" cellspacing="0" cellpadding="4">
   <tr>
     <td  nowrap  >維護日期： 
       <span class="dsp_date">${crt_date.YMD}</span>
       <input      size="8"  type="hidden" name="crt_date" value="${crt_date}" />
     </td>
     <td  nowrap  >維護經辦： 
       <span class="dsp_text">${crt_user}</span>
       <input      size="10"  type="hidden" name="crt_user" value="${crt_user}" />
               - ${comm_crt_user}
     <input    type="hidden" name="comm_crt_user" value="${comm_crt_user}" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >覆核日期： 
       <span class="dsp_date">${apr_date.YMD}</span>
       <input      size="8"  type="hidden" name="apr_date" value="${apr_date}" />
     </td>
     <td  nowrap  >覆核人員： 
       <span class="dsp_text">${apr_user}</span>
       <input      size="10"  type="hidden" name="apr_user" value="${apr_user}" />
               - ${comm_apr_user}
     <input    type="hidden" name="comm_apr_user" value="${comm_apr_user}" />
   </tr>
 </table>
</div>
<!-- trail ************************************************************** -->
<input type="hidden" name="p_seqno" value="${p_seqno}">
<input type="hidden" name="id_p_seqno" value="${id_p_seqno}">
<input type="hidden" name="tran_time" value="${tran_time}">
 <input type="hidden" name="data_k1" value="" >
 <input type="hidden" name="data_k2" value="" >
 <input type="hidden" name="data_k3" value="" >
 <input type="hidden" name="data_k4" value="" >
 <input type="hidden" name="data_k5" value="" >
<input type="hidden" name="fst_apr_flag" value="${fst_apr_flag}">
<input type="hidden" name="ROWID" value="${rowid}">
<input type="hidden" name="CONTROL_TAB_NAME" value="${control_tab_name}">
<input type="hidden" name="MOD_PGM" value="mktm0270">
<input type="hidden" name="MOD_USER" value="${MOD_USER}">
<input type="hidden" name="MOD_SEQNO" value="${mod_seqno}">
<input type="hidden" name="HIDE" value="${HIDE_DATA}">
<input type="hidden" name="pageType" value="detl">
<input type="hidden" name="apr_flag" value="N">
<input type="hidden" name="deduct_bp01"  value="${deduct_bp01}">
<input type="hidden" name="deduct_bp90"  value="${deduct_bp90}">
<input type="hidden" name="redeem_id"  value="${redeem_id}">
</form>
</body>
</html>
<!-- script d2 *********************************************************** -->
<script language="JavaScript" src="js/AJAXFunction_11.js"></script>
<script language="javascript">

 top.refreshButton2('1');

 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }

    return true;
  }


 function columnItemChange(ps1)
  {
   var  win_card_no =document.forms["dataForm"]["card_no"].value;
   var  win_gift_no =document.forms["dataForm"]["gift_no"].value;
   var  win_exchg_cnt =document.forms["dataForm"]["exchg_cnt"].value;
   var  win_bill_sending_zip =document.forms["dataForm"]["bill_sending_zip"].value;
   var  win_tran_seqno =document.forms["dataForm"]["tran_seqno"].value;
   var  win_redeem_id =document.forms["dataForm"]["id_no"].value;
   idCode = ps1;
   top.actionCode = "AJAX";
   if ( idCode == '3' )
      {
       resetJSON();
       addJSON("ajaxMethod","wfAjaxFunc3");
       addJSON("ax_win_card_no",win_card_no);
       addJSON("ax_win_gift_no",win_gift_no);
       addJSON("ax_win_exchg_cnt",win_exchg_cnt);
       addJSON("ax_win_redeem_id",win_redeem_id);
      }

   if ( idCode == '1' )
      {
       resetJSON();
       addJSON("ajaxMethod","wfAjaxFunc1");
       addJSON("ax_win_gift_no",win_gift_no);
       addJSON("ax_win_card_no",win_card_no);
       addJSON("ax_win_exchg_cnt",win_exchg_cnt);
       addJSON("ax_win_redeem_id",win_redeem_id);
      }

   if ( idCode == '2' )
      {
       resetJSON();
       addJSON("ajaxMethod","wfAjaxFunc2");
       addJSON("ax_win_bill_sending_zip",win_bill_sending_zip);
       addJSON("ax_win_redeem_id",win_redeem_id);
      }

   if ( idCode == '6' )
      {
       resetJSON();
       addJSON("ajaxMethod","wfAjaxFunc6");
       addJSON("ax_win_exchg_cnt",win_exchg_cnt);
       addJSON("ax_win_card_no",win_card_no);
       addJSON("ax_win_gift_no",win_gift_no);
       addJSON("ax_win_tran_seqno",win_tran_seqno);
       addJSON("ax_win_redeem_id",win_redeem_id);
      }

   processAJAX();
 }


 function buttonAjaxFunc(ps1)
  {
   var  win_card_no =document.forms["dataForm"]["card_no"].value;
   var  win_gift_no =document.forms["dataForm"]["gift_no"].value;
   var  win_exchg_cnt =document.forms["dataForm"]["exchg_cnt"].value;
   var  win_exchg_pt =document.forms["dataForm"]["exchg_pt"].value;
   var  win_tran_seqno =document.forms["dataForm"]["tran_seqno"].value;
   var  win_redeem_id =document.forms["dataForm"]["redeem_id"].value;
   
   idCode = ps1;
   top.actionCode = "AJAX";
   if ( idCode == '5' )
      {
       resetJSON();
       addJSON("ajaxMethod","wfButtonFunc5");
       addJSON("ax_win_card_no",win_card_no);
       addJSON("ax_win_redeem_id",win_redeem_id);
      }
   if ( idCode == '7' )
      { 
       resetJSON();
       addJSON("ajaxMethod","wfButtonFunc7");
       addJSON("ax_win_card_no",win_card_no);
       addJSON("ax_win_redeem_id",win_redeem_id);
      }
   if ( idCode == '4' )
      {
       resetJSON();
       addJSON("ajaxMethod","wfButtonFunc4");
       addJSON("ax_win_gift_no",win_gift_no);
       addJSON("ax_win_card_no",win_card_no);
       addJSON("ax_win_exchg_cnt",win_exchg_cnt);
       addJSON("ax_win_exchg_pt",win_exchg_pt);
       addJSON("ax_win_tran_seqno",win_tran_seqno);
       addJSON("ax_win_redeem_id",win_redeem_id);
      }
   processAJAX();
 }

 function ajaxResponse()
 {
  top.respHtml ="mktm0270_detl";
  var len = 0;

  if (idCode == '3' )
     {
       document.dataForm.acct_type.value =getJSONvalue("acct_type",0);
       document.dataForm.acct_type_name.value =getJSONvalue("acct_type_name",0);
       document.dataForm.vip_code.value =getJSONvalue("vip_code",0);
       document.dataForm.id_p_seqno.value =getJSONvalue("id_p_seqno",0);
       document.dataForm.p_seqno.value =getJSONvalue("p_seqno",0);
       document.dataForm.gift_type_name.value =getJSONvalue("gift_type_name",0);
       document.dataForm.fund_code_name.value =getJSONvalue("fund_code_name",0);
       document.dataForm.end_tran_bp.value =getJSONvalue("end_tran_bp",0);
       document.dataForm.end_tran_bp01.value =getJSONvalue("end_tran_bp01",0);
       document.dataForm.end_tran_bp90.value =getJSONvalue("end_tran_bp90",0);
       document.dataForm.deduct_bp01.value =getJSONvalue("deduct_bp01",0);
       document.dataForm.deduct_bp90.value =getJSONvalue("deduct_bp90",0);
       document.dataForm.cash_value.value =getJSONvalue("cash_value",0);
       document.dataForm.total_pt.value =getJSONvalue("total_pt",0);
       document.dataForm.diff_pt_msg.value =getJSONvalue("diff_pt_msg",0);
      document.dataForm.chi_name.value =getJSONvalue("chi_name",0);
      document.dataForm.cellar_phone.value =getJSONvalue("cellar_phone",0);
      document.dataForm.home_area_code1.value =getJSONvalue("home_area_code1",0);
      document.dataForm.home_tel_no1.value =getJSONvalue("home_tel_no1",0);
      document.dataForm.home_tel_ext1.value =getJSONvalue("home_tel_ext1",0);
      document.dataForm.office_area_code1.value =getJSONvalue("office_area_code1",0);
      document.dataForm.office_tel_no1.value =getJSONvalue("office_tel_no1",0);
      document.dataForm.office_tel_ext1.value =getJSONvalue("office_tel_ext1",0);
      document.dataForm.bill_sending_zip.value =getJSONvalue("bill_sending_zip",0);
      document.dataForm.bill_sending_addr1.value =getJSONvalue("bill_sending_addr1",0);
      document.dataForm.bill_sending_addr2.value =getJSONvalue("bill_sending_addr2",0);
      document.dataForm.bill_sending_addr3.value =getJSONvalue("bill_sending_addr3",0);
      document.dataForm.bill_sending_addr4.value =getJSONvalue("bill_sending_addr4",0);
      document.dataForm.bill_sending_addr5.value =getJSONvalue("bill_sending_addr5",0);
      document.dataForm.cal_dfpno.value =getJSONvalue("cal_dfpno",0);
      document.dataForm.air_id_no.value =getJSONvalue("air_id_no",0);
      document.dataForm.air_birthday.value =getJSONvalue("air_birthday",0);
      document.dataForm.passport_name.value =getJSONvalue("passport_name",0);
      document.dataForm.passport_surname.value =getJSONvalue("passport_surname",0);
      return false;
     }
  if (idCode == '1' )
     {
       document.dataForm.id_no.value =getJSONvalue("id_no",0);
       document.dataForm.gift_type.value =getJSONvalue("gift_type",0);
       document.dataForm.fund_code.value =getJSONvalue("fund_code",0);
       document.dataForm.cash_value.value =getJSONvalue("cash_value",0);
       document.dataForm.bonus_type.value =getJSONvalue("bonus_type",0);
       document.dataForm.bonus_type_name.value =getJSONvalue("bonus_type_name",0);
       document.dataForm.air_type.value =getJSONvalue("air_type",0);
       document.dataForm.air_type_name.value =getJSONvalue("air_type_name",0);
       document.dataForm.gift_type_name.value =getJSONvalue("gift_type_name",0);
       document.dataForm.fund_code_name.value =getJSONvalue("fund_code_name",0);
       document.dataForm.exchg_pt.value =getJSONvalue("exchg_pt",0);
       document.dataForm.exchg_amt.value =getJSONvalue("exchg_amt",0);
       document.dataForm.total_pt.value =getJSONvalue("total_pt",0);
       document.dataForm.diff_pt_msg.value =getJSONvalue("diff_pt_msg",0);
       document.dataForm.end_tran_bp.value =getJSONvalue("end_tran_bp",0);
       document.dataForm.end_tran_bp01.value =getJSONvalue("end_tran_bp01",0);
       document.dataForm.end_tran_bp90.value =getJSONvalue("end_tran_bp90",0);
       document.dataForm.deduct_bp01.value =getJSONvalue("deduct_bp01",0);
       document.dataForm.deduct_bp90.value =getJSONvalue("deduct_bp90",0);
      document.dataForm.cal_dfpno.value =getJSONvalue("cal_dfpno",0);
      document.dataForm.air_id_no.value =getJSONvalue("air_id_no",0);
      document.dataForm.air_birthday.value =getJSONvalue("air_birthday",0);
      document.dataForm.passport_name.value =getJSONvalue("passport_name",0);
      document.dataForm.passport_surname.value =getJSONvalue("passport_surname",0);
      return false;
     }
  if (idCode == '2' )
     {
      document.dataForm.bill_sending_addr1.value =getJSONvalue("bill_sending_addr1",0);
      document.dataForm.bill_sending_addr2.value =getJSONvalue("bill_sending_addr2",0);
      return false;
     }
  if (idCode == '6' )
     {
       document.dataForm.exchg_pt.value =getJSONvalue("exchg_pt",0);
       document.dataForm.exchg_amt.value =getJSONvalue("exchg_amt",0);
       document.dataForm.total_pt.value =getJSONvalue("total_pt",0);
       document.dataForm.diff_pt_msg.value =getJSONvalue("diff_pt_msg",0);
      return false;
     }
  if (idCode == '5' )
     {
      document.dataForm.chi_name.value =getJSONvalue("chi_name",0);
      document.dataForm.cellar_phone.value =getJSONvalue("cellar_phone",0);
      document.dataForm.home_area_code1.value =getJSONvalue("home_area_code1",0);
      document.dataForm.home_tel_no1.value =getJSONvalue("home_tel_no1",0);
      document.dataForm.home_tel_ext1.value =getJSONvalue("home_tel_ext1",0);
      document.dataForm.office_area_code1.value =getJSONvalue("office_area_code1",0);
      document.dataForm.office_tel_no1.value =getJSONvalue("office_tel_no1",0);
      document.dataForm.office_tel_ext1.value =getJSONvalue("office_tel_ext1",0);
      document.dataForm.bill_sending_zip.value =getJSONvalue("bill_sending_zip",0);
      document.dataForm.bill_sending_addr1.value =getJSONvalue("bill_sending_addr1",0);
      document.dataForm.bill_sending_addr2.value =getJSONvalue("bill_sending_addr2",0);
      document.dataForm.bill_sending_addr3.value =getJSONvalue("bill_sending_addr3",0);
      document.dataForm.bill_sending_addr4.value =getJSONvalue("bill_sending_addr4",0);
      document.dataForm.bill_sending_addr5.value =getJSONvalue("bill_sending_addr5",0);
      return false;
     }
  if (idCode == '7' )
     {
      document.dataForm.chi_name.value =getJSONvalue("chi_name",0);
      document.dataForm.cellar_phone.value =getJSONvalue("cellar_phone",0);
      document.dataForm.home_area_code1.value =getJSONvalue("home_area_code1",0);
      document.dataForm.home_tel_no1.value =getJSONvalue("home_tel_no1",0);
      document.dataForm.home_tel_ext1.value =getJSONvalue("home_tel_ext1",0);
      document.dataForm.office_area_code1.value =getJSONvalue("office_area_code1",0);
      document.dataForm.office_tel_no1.value =getJSONvalue("office_tel_no1",0);
      document.dataForm.office_tel_ext1.value =getJSONvalue("office_tel_ext1",0);
      document.dataForm.bill_sending_zip.value =getJSONvalue("bill_sending_zip",0);
      document.dataForm.bill_sending_addr1.value =getJSONvalue("bill_sending_addr1",0);
      document.dataForm.bill_sending_addr2.value =getJSONvalue("bill_sending_addr2",0);
      document.dataForm.bill_sending_addr3.value =getJSONvalue("bill_sending_addr3",0);
      document.dataForm.bill_sending_addr4.value =getJSONvalue("bill_sending_addr4",0);
      document.dataForm.bill_sending_addr5.value =getJSONvalue("bill_sending_addr5",0);
      return false;
     }
  if (idCode == '4' )
     {
      document.dataForm.end_tran_bp.value =getJSONvalue("end_tran_bp",0);
      document.dataForm.end_tran_bp01.value =getJSONvalue("end_tran_bp01",0);
      document.dataForm.end_tran_bp90.value =getJSONvalue("end_tran_bp90",0);
      document.dataForm.deduct_bp01.value =getJSONvalue("deduct_bp01",0);
      document.dataForm.deduct_bp90.value =getJSONvalue("deduct_bp90",0);
      document.dataForm.diff_pt_msg.value =getJSONvalue("diff_pt_msg",0);
      return false;
     }
 }

 function clearListObj(listObj)
  {
    for( var i = listObj.length - 1; i>=0; i--)
       { listObj.remove(i);  }
  }

</script>
<!-- ******************************************************************** -->
