<html>
<head>
<title> 109/10/07 V1.00.42 Allen Ho Initial 紅利積點兌換贈品登錄檔維護作業</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
<link rel="stylesheet" href="js/Calendar/calendar.css">
</head>
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>

<body background="${water_mark}" >
<form  name="dataForm" method="post" action="" >
<div id="condBlock">
<!-- query key *************************************************************-->
 <table width="60%" border="0" cellspacing="0" cellpadding="22">
   <tr>
   <td nowrap>&nbsp;身分證號：
      <input type="text" class="col_text" 
          name="ex_id_no" value="${ex_id_no}"
         zeditType="any,upper"  maxlength=11 size=11 />
   卡號：
      <input type="text" class="col_any" 
          name="ex_card_no" value="${ex_card_no}"
         zeditType="any"  maxlength=19 size=19 />
   商品代號
      <input type="text" class="col_any" 
          name="ex_gift_no" value="${ex_gift_no}"
         zeditType="any"  maxlength=8 size=8 />
     </td>
   <td nowrap>&nbsp;兌換管道:
      <select  name="ex_from_mark" class="col_ddlb"  >
       <option value=" ">--</option>
         <option value="1" ${ex_from_mark-1} >1.人工登錄</option>
         <option value="2" ${ex_from_mark-2} >2.語音</option>
         <option value="3" ${ex_from_mark-3} >3.網路</option>
       </select>
     </td>
   </tr>
   <tr>
   <td nowrap>&nbsp;兌換期間：
      <input type="text" class="col_date"  onChange="columnItemChange('8')"
          name="ex_tran_date_s" value="${ex_tran_date_s}"
         zeditType="date,yyyymmdd"  maxlength=8 size=8 />
      <script language="JavaScript">
                new tcal ({'formname': 'dataForm','controlname': 'ex_tran_date_s'});
      </script>
      --
      <input type="text" class="col_date"  onChange="columnItemChange('8')"
          name="ex_tran_date_e" value="${ex_tran_date_e}"
         zeditType="date,yyyymmdd"  maxlength=8 size=8 />
      <script language="JavaScript">
                new tcal ({'formname': 'dataForm','controlname': 'ex_tran_date_e'});
      </script>
   航空公司:
      <select size="1" name="ex_air_type" class="col_ddlb" >
         ${dddw_air_type_b}
      </select>
     </td>
   <td nowrap>&nbsp;兌換進度:
      <select  name="ex_status_code" class="col_ddlb"  >
       <option value=" ">--</option>
         <option value="1" ${ex_status_code-1} >兌換失敗</option>
         <option value="2" ${ex_status_code-2} >未出貨</option>
         <option value="3" ${ex_status_code-3} >已出貨</option>
         <option value="4" ${ex_status_code-4} >已退貨/取消</option>
         <option value="5" ${ex_status_code-5} >已請款</option>
       </select>
     </td>
   </tr>
   <tr>
   <td nowrap>&nbsp;供應商代號:
      <select size="1" name="ex_vendor_no" class="col_ddlb" id="ajaxh_vendor_no"  >
         ${dddw_vendor_no}
      </select>
     </td>
   </tr>
   <tr>
   <td nowrap>&nbsp;交易序號:
      <input type="text" class="col_any" 
          name="ex_tran_seqno" value="${ex_tran_seqno}"
         zeditType="any"  maxlength=10 size=10 />
   VIP:
      <select  name="ex_vip_code" class="col_ddlb"  >
       <option value=" ">--</option>
         <option value="Y" ${ex_vip_code-Y} >VIP</option>
       </select>
   主管覆核:
       <input type="radio" value="Y" name="ex_apr_flag" ${ex_apr_flag-Y} checked  />(全部:不含新增)
       <input type="radio" value="N" name="ex_apr_flag" ${ex_apr_flag-N} />未覆核
     </td>
   <td nowrap>&nbsp;
      <input type="Button" name="btnQuery" value="查詢" onClick="return top.submitControl('Q')" class="btQuery" >&nbsp;&nbsp;
      <input type="Button" name="btnClear" value="清除" onClick="return top.submitControl('L')" class="btClear" >&nbsp;&nbsp;
      <input type="Button" name="btnAdd" ${btnAdd_disable} value="新增" onclick="modifyScreen('${SER_NUM}','','','','')" class="btAdd" >&nbsp;&nbsp;
   </td>
  </tr>
 </table>
</div>
<!-- browse ************************************************************** -->
 <table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="8">
  <tr>
    <th nowrap class="list_th" width="5%">No&nbsp;</th>
    <th nowrap class="list_th">交易序號</th>
    <th nowrap class="list_th">兌換日期</th>
    <th nowrap class="list_th">身分證號</th>
    <th nowrap class="list_th">姓名</th>
    <th nowrap class="list_th">卡號</th>
    <th nowrap class="list_th">商品代號</th>
    <th nowrap class="list_th">兌換<BR>數量</th>
    <th nowrap class="list_th">最後<BR>覆核類別</th>
    <th nowrap class="list_th">兌換狀況</th>
    <th nowrap class="list_th">應扣點數</th>
    <th nowrap class="list_th">維護經辦</th>
  </tr>
  <!-- BEGIN DYNAMIC : DETAIL -->
  <tr onclick="detailScreen('${SER_NUM}','${rowid}','','','','')" style="cursor:hand">
    <td nowrap class="list_no">
       <span class="dsp_flag">${ok_flag}</span> 
        ${SER_NUM}&nbsp;
        <input type="hidden" name="rowid" value="${rowid}"/>
    </td>
    <td nowrap class="list_cc"> ${tran_seqno}</td>
    <td nowrap class="list_cc"> ${tran_date.YMD}</td>
    <td  nowrap class="list_cc">${comm_id_no}</td>
    <td  nowrap class="list_ll">${comm_chi_name}</td>
    <td nowrap class="list_cc"> ${card_no}</td>
    <td  nowrap class="list_ll"> ${gift_no}-${comm_gift_no}</td>
    <td nowrap class="list_rr"> ${exchg_cnt}</td>
    <td  nowrap class="list_ll"> ${proc_flag}-${comm_proc_flag}</td>
    <td  nowrap class="list_cc"> ${status_flag}-${comm_status_flag}</td>
    <td nowrap class="list_rr"> ${total_pt.(999)}</td>
    <td  nowrap class="list_ll"> ${crt_user}-${comm_crt_user}</td>
    <td nowrap style="visibility:hidden;"> ${id_p_seqno} </td>
  </tr>
  <!-- END DYNAMIC : DETAIL -->
 </table>
<!-- hidden ************************************************************** -->
 <input type="hidden" name="WPROWID" value="${wprowid}">
 <input type="hidden" name="control_tab_name" value="${control_tab_name}" >
 <input type="hidden" name="data_k1" value="" >
 <input type="hidden" name="data_k2" value="" >
 <input type="hidden" name="data_k3" value="" >
 <input type="hidden" name="data_k4" value="" >
 <input type="hidden" name="data_k5" value="" >
 <input type="hidden"  name="data_apr_flag" value="${ex_apr_flag}" >

 <input type="hidden"  name="HIDE"  value="${HIDE_DATA}">
 <input type="hidden"  name="pageType"  value="cond">

</form>
</body>
<!-- script1 ************************************************************* -->
<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
        tigra_tables('table1');
</script>
<!00 script2 ************************************************************* -->
<script language="JavaScript" src="js/AJAXFunction_11.js"></script>
<script language="javascript">

 top.refreshButton2('0');
 top.pageRows="20";


 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }

    return true;
  }

 function detailScreen(serNum,parm,parm2,parm3,parm4,parm5)
  {
    top.respLevel = 1;
    top.currRows  = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    document.dataForm.data_k4.value = parm4;
    document.dataForm.data_k5.value = parm5;
    top.respHtml  = "mktm0270_detl";
    top.submitControl('S');
    return true;
  }

 function modifyScreen(serNum,parm,parm2,parm3,parm4)
  {
    top.respLevel = 1;
    top.currRows  = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    document.dataForm.data_k4.value = parm4;
    top.respHtml  = "mktm0270_nadd";
    top.submitControl('I');
    return true;
  }

 function columnItemChange(ps1)
  {
   var  win_tran_date_s =document.forms["dataForm"]["ex_tran_date_s"].value;
   var  win_tran_date_e =document.forms["dataForm"]["ex_tran_date_e"].value;

   idCode = ps1;
   top.actionCode = "Q";
   if ( idCode == '8' )
      {
       clearListObj(document.getElementById("ajaxh_vendor_no"));
       top.methodName = "wf_ajax_func_8";
       resetJSON();
       addJSON("ax_win_tran_date_s",win_tran_date_s);
       addJSON("ax_win_tran_date_e",win_tran_date_e);
      }

   processAJAX();
 }

 function ajaxResponse()
 {
  top.respHtml ="mktm0270";
  var len = 0;

  if (idCode == '8' )
     {
      var listObj = document.getElementById("ajaxh_vendor_no");
      len = getJSONlength("ajaxj_vendor_no");
      for ( var ii=0; ii<len; ii++)
          listObj.options.add(new Option(getJSONvalue("ajaxj_vendor_no",ii)
                                        +" "+getJSONvalue("ajaxj_vendor_name",ii)
                                        ,getJSONvalue("ajaxj_vendor_no",ii)));
      return false;
     }
 }

 function clearListObj(listObj)
  {
    for( var i = listObj.length - 1; i>=0; i--)
       { listObj.remove(i);  }
  }


</script>
<!-- ******************************************************************** -->
