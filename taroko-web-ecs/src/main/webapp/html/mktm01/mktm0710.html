<html>

<head>
    <title>紅利折抵特店群組代碼維護-V.2018-0611-Andy-[Initial]</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="css/ecsBank.css" type="text/css">
    <script language="JavaScript" src="js/jquery.js"></script>
    <script language="JavaScript" src="js/AJAXFunction_11.js"></script>
</head>
<script language="JavaScript">
    function wf_add_newrow() {
    var ind = document.getElementById('table1').rows.length - 1;
    var rowNum = document.getElementById('table1').rows.length - 1;
    var colNum = 0;
    var fi = 0;
    //console.log("a:"+ind);
    var num = '${ser_num}';
    if(num==''){
        ind=document.getElementById( 'table1' ).rows.length-2;
    }
    colNum = 0
    rowNum++;
    ind++;
    var myRow = document.all.table1.insertRow(rowNum);
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_no";
    myCell.noWrap = "nowrap";

    var serNo = "";
    if (ind < 10) {
        serNo = "0" + ind;
    } else {
        serNo = "" + ind;
    }
    fi++;

    var con = document.createElement('span');
    con.textContent = serNo;
    myCell.appendChild(con);

    var ip = document.createElement('input');
    ip.className = 'col_ckbox';
    ip.type = 'checkbox';
    ip.name = 'opt';
    ip.value = serNo;
    myCell.appendChild(ip);

    var ip1 = document.createElement('input');
    ip1.type = 'hidden';
    ip1.name = 'ser_num';
    ip1.value = serNo;
    myCell.appendChild(ip1);

    var ip2 = document.createElement('input');
    ip2.type = 'hidden';
    ip2.name = 'rowid';
    ip2.value = '';
    myCell.appendChild(ip2);
    ///////////////////////////////////////    


    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";


    var mo1 = document.createElement('input');
    mo1.setAttribute('class', 'col_any');
    mo1.setAttribute('zEdit', 'any');
    mo1.type = 'text';
    mo1.name = 'mcht_group_id';
    mo1.maxLength = 10;
    mo1.size = 11;
    mo1.value = '';
    myCell.appendChild(mo1);

    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";


    var mo2 = document.createElement('input');
    mo2.setAttribute('class', 'col_any');
    mo2.setAttribute('zEdit', 'canTW');
    mo2.type = 'text';
    mo2.name = 'mcht_group_desc';
    mo2.maxLength = 60;
    mo2.size = 60;
    mo2.value = '';
    myCell.appendChild(mo2);
}
</script>

<body background="${water_mark}">
    <form name="dataForm" method="post" action="">
        ${#PLUGIN:htmcomm_plugin.apr_user}
        <table border="0" width="60%">
            <tr>
                <td>
                    <span class="dsp_text">&nbsp;&nbsp;同一商店多家連鎖特店之聯信平台紅利折抵複製設定</span>
                </td>
            </tr>
        </table>
        <div id="condBlock">
            <!--COND -->
            <table id="table2" width="60%" border="0" cellspacing="0" cellpadding="4">
                <tr>
                    <td nowrap>&nbsp;特店群組代碼:
                        <input type="text" class="col_text" name="mcht_group_id1" value="${mcht_group_id1}" zEdit="any" maxlength=10 size=11 />
                        --
                        <input type="text" class="col_text" name="mcht_group_id2" value="${mcht_group_id2}" zEdit="any" maxlength=10 size=11 />
                    </td>
                    <td nowrap>&nbsp;
                        <input type="Button"  value="查詢" onClick="return top.submitControl('Q')" class="btQuery">&nbsp;&nbsp;
                        <input type="Button"  value="清除" onClick="return top.submitControl('L')" class="btClear">&nbsp;&nbsp;
                        <input type="Button"  value="存檔" ${btnUpdate_disable} onClick="return top.submitControl('S2')" class="btAdd">&nbsp;&nbsp;
                    </td>
                </tr>
            </table>
        </div>
        <hr>
        <table border="0" width="60%">
            <tr>
                <td align="left">
                    <input type="Button" name="detl_btnAdd" value="新增明細" ${btnSelect_disable} onclick="wf_add_newrow()" class="btAdd_detl" />&nbsp;
                </td>
            </tr>
        </table>
        <!--List -->
        <table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4" width="40%">
            <tr>
                <th nowrap class="list_th" width="5%">刪除&nbsp;</th>
                <!--<input type="checkbox" name="ex_selectAll" value="Y" onChange="selectAll();">刪除&nbsp;</th>-->
                <th nowrap class="list_th" width="100">特店群組代碼</th>
                <th nowrap class="list_th" width="100">特店群組說明</th>
                <th nowrap class="list_th" width="100" style="display:none"></th>
            </tr>
            <!-- BEGIN DYNAMIC : DETAIL -->
            <tr>
                <td nowrap class="list_no">
                    <span class="dsp_flag">${ok_flag}</span> ${SER_NUM}
                    <input type="checkbox" name="opt" value="${ser_num}">
                    <input type="hidden" name="ser_num" value="${ser_num}">
                    <input type="hidden" name="rowid" value="${rowid}">
                </td>
                <td nowrap class="list_ll">
                    <input type="text" class="col_any" name="mcht_group_id" value="${mcht_group_id}" zEdit="any" maxlength=10 size=11 />
                </td>
                <td nowrap class="list_ll">
                    <input type="text" class="col_any" name="mcht_group_desc" value="${mcht_group_desc}" zEdit="canTW" maxlength=60 size=60 />
                </td>
            </tr>
            <!-- END DYNAMIC : DETAIL -->
        </table>
        <input type="hidden" name="data_k1" value="">
        <input type="hidden" name="data_k2" value="">
        <input type="hidden" name="data_k3" value="">
        <input type="hidden" name="HIDE" value="${HIDE_DATA}">
        <input type="hidden" name="pageType" value="cond">
        <input type="hidden" name="mod_pgm" value="mktm0710">
        <input type="hidden" name="data2" id="data2" value="${data2}">
    </form>
</body>

</html>
<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>
<script language="javascript">
top.refreshButton2('0');
top.pageRows = "20";

function validateInput() {
    if (!top.checkFormat()) { return false; }

    if (top.actionCode == "S2") {
        if (!chkdata()) {
            return false;
        }
    }
    return true;
}

function detailScreen(serNum, parm, parm2, parm3) {
    top.respLevel = 1;
    top.currRows = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    top.respHtml = "mktm0710_detl";
    top.submitControl('S');
    return true;
}
//全選
function selectAll() {
    var aElements = document.dataForm.getElementsByTagName("input");
    for (var i = 0; i < aElements.length; i++) {
        if (aElements[i].type == "checkbox") {
            aElements[i].checked = document.dataForm.ex_selectAll.checked;
        }
    }

    return;
}

function chkdata() {
    var agy = 0;
    $("input[name=opt]").each(function() {
        agy++;
    })
    if (agy == 0) {
        return false;
    }
    return true;
}
</script>