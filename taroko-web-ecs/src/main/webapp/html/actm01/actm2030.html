<html> 
<head>
<title>帳戶免收違約金/循環息維護作業-106-11-06-V1.00.00-OrisChang-[Initial]
       112-12-05-V1.00.01-Simon-[update]
</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
</head>

<body background="${water_mark}">
    <form name="dataForm" method="post" action="">
        <div id="condBlock">
            <table width="80%" border="0" cellspacing="0" cellpadding="4">
            	<tr>
	                <td nowrap>&nbsp;帳戶帳號:
	                    <select size="1" name="ex_acct_type" class="col_ddlb">
  	                    ${dddw_acct_type}
	                    </select>--
	                    <input type="text" class="col_text" name="ex_acct_key" value="${ex_acct_key}" maxlength="11" size="13" zRequire ="k"/>
	                </td>
	                <td>
	                </td>
<!--
	                <td nowrap>&nbsp;作業類別:
						<select size="1" name="ex_no_flag" class="col_ddlb">
							<option value="1" ${ex_no_flag-1} >1.違約金</option>
							<option value="2" ${ex_no_flag-2} >2.循環息</option>
						</select>
				  	<input type="hidden" name="ex_no_flag" value="${ex_no_flag}">
	                </td>
-->
				</tr>
				<tr>
					<td nowrap>&nbsp;姓名（公司）:${ex_cname}
					<input type="hidden" name="ex_cname" value="${ex_cname}"></td>
					<td nowrap>&nbsp;帳戶現狀碼:${tt_acct_status}
					<input type="hidden" name="ex_acct_status" value="${ex_acct_status}">
					<input type="hidden" name="tt_acct_status" value="${tt_acct_status}"></td>
				</tr>
                <tr>
                    <td nowrap colspan=2>
          				<input type="Button" name="btnClear" ${btnClear_disable} value="清除" onClick="return top.submitControl('L')" class="btClear">&nbsp;&nbsp;
						<input type="Button" name="btnQuery" ${btnQuery_disable} value="查詢" onClick="return top.submitControl('Q')" class="btQuery">&nbsp;&nbsp;
						<input type="Button" name="btnUpdate" ${btnUpdate_disable} value="存檔" onClick="return top.submitControl('U')" class="btUpdate">&nbsp;&nbsp;
				  	<input type="hidden" name="btnUpdate" value="${btnUpdate}">
                    </td>
                </tr>
            </table>
        </div>
        <hr>
       <!-- 明細============================ -->
    <table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
      <tr>
<!--		<th nowrap class="list_th">修改</th>  -->
        <th nowrap class="list_th" width="5%">No&nbsp;</th>
				<th nowrap class="list_th">刪除</th>
				<th nowrap class="list_th">作業類別</th>
				<th nowrap class="list_th">待覆核</th>
<!--  	<th nowrap class="list_th">雙幣幣別</th>  -->
				<th nowrap class="list_th">幣別</th>
				<th nowrap class="list_th">免收旗標</th>
				<th nowrap class="list_th">生效年月起</th>
				<th nowrap class="list_th">生效年月迄</th>
				<th nowrap class="list_th">異動日期</th>
				<!-- <th nowrap class="list_th">異動時間</th> -->
				<th nowrap class="list_th">異動經辦</th>
      </tr>
      <!-- BEGIN DYNAMIC : DETAIL -->
      <tr>
				<td nowrap class=list_no">${ser_num}&nbsp;
			    <span class="dsp_flag">${a-ok_flag}</span>
<!--			<input type="checkbox" name="aopt" value="${ser_num}" ${aopt-Y}/>  -->
				</td>
				<td nowrap class="list_cc">
			    <span class="dsp_flag">${d-ok_flag}</span>
					<input type="checkbox" name="dopt" value="${ser_num}" ${del_disable} ${dopt-Y}/>
				</td>
				<td nowrap class="list_ll"><span>${tt_no_flag_type}&nbsp;</span></td>
				<td nowrap class="list_cc"><span style="color:DarkBlue;">${wk_dual}&nbsp;</span></td>
				<td nowrap class="list_ll"><span style="color:#930093; font-weight:bold;">${tt_curr_code}&nbsp;</span></td>
				<td nowrap class="list_cc"><input type="checkbox" name="no_flag" value="${ser_num}"  
					${no_flag-Y}  onchange="setOnFlag(this);" /></td>
				<td nowrap class="list_ll"><input type="text" class="col_date" name="no_s_month" value="${no_s_month}" 
					  zEdit="date,yyyymm" maxlength="6" size="8" onchange="setOnAopt(this);" /></td>
				<td nowrap class="list_ll"><input type="text" class="col_date" name="no_e_month" value="${no_e_month}" 
					zEdit="date,yyyymm" maxlength="6" size="8" onchange="setOnAopt(this);" /></td>
				<td nowrap class="list_cc">${chg_date.YMD}&nbsp;</td>
				<td nowrap class="list_ll">${chg_user}&nbsp;
					<input type="hidden" name="ser_num" value="${ser_num}" />
					<input type="hidden" name="tt_no_flag_type" value="${tt_no_flag_type}" />
					<input type="hidden" name="rowid" value="${rowid}">
					<input type="hidden" name="wk_dual" value="${wk_dual}">
					<input type="hidden" name="curr_code" value="${curr_code}">
					<input type="hidden" name="tt_curr_code" value="${tt_curr_code}">
					<input type="hidden" name="chg_date" value="${chg_date}">
					<input type="hidden" name="chg_user" value="${chg_user}">
					<input type="hidden" name="del_disable" value="${del_disable}">
					<input type="hidden" name="chk_no_flag" value="${chk_no_flag}">
					<input type="hidden" name="chk_no_s_month" value="${chk_no_s_month}">
					<input type="hidden" name="chk_no_e_month" value="${chk_no_e_month}">
          <input type="hidden" name="ex_save_flag" value="${ex_save_flag}">
				</td>
      </tr>
      <!-- END DYNAMIC : DETAIL -->
    </table>
        <!--保留功能-->
        <input type="hidden" name="data_k1" value="">
        <input type="hidden" name="data_k2" value="">
        <input type="hidden" name="data_k3" value="">
        <input type="hidden" name="HIDE" value="${HIDE_DATA}">
        <input type="hidden" name="pageType" value="cond">
        <input type="hidden" name="p_seqno" value="${p_seqno}">
        <input type="hidden" name="acct_type" value="${acct_type}">
        <input type="hidden" name="acct_key" value="${acct_key}">
        <input type="hidden" name="next_acct_month" value="${next_acct_month}">

    </form>
</body>

</html>
<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>
<script language="javascript">
top.refreshButton2('0');
top.pageRows = "20";

document.dataForm.ex_acct_key.focus();

function validateInput() {
    if (!top.checkFormat()) {return false;}
    
/***
    if ( top.actionCode == "U" ) {
    	if ( !chkdata() ) { 
    		return false; 
    	} 
    }
***/    
    return true;
}

function chkdata() {
	var seq = 0;
	var agy = document.getElementsByName('aopt');
	var dgy = document.getElementsByName('dopt');
	var ll = agy.length;
	for ( var i=0; i < ll; i++ ) {
		if(agy[i].checked){	seq++; }
		if(dgy[i].checked){	seq++; }
	}
	//好像不需要判斷undefined, 只要前面用getElementsByName 就不會出錯誤訊息
	//if (typeof ll === 'undefined') {
	//	if (agy.checked){ seq++; }
	//	if (dgy.checked){ seq++; }
	//}else{
	//	for ( var i=0; i < ll; i++ ) {
	//		if(agy[i].checked){	seq++; }
	//		if(dgy[i].checked){	seq++; }
	//	}
	//}

	if(seq == 0){
		alert("請至少勾選一筆資料!");
		return false;
	}
	return true;
}

function setOnAopt(obj) {
//var num = obj.parentNode.parentNode.rowIndex -1;
//document.getElementsByName('aopt')[num].checked = true;
//document.getElementsByName('no_flag')[num].checked = true;
  return true;
}

function setOnFlag(obj) {
  var num = obj.parentNode.parentNode.rowIndex -1;
	var flagOn = document.getElementsByName('no_flag');
//var defaultAcctMonth = document.getElementsByName('next_acct_month').value;
  var defaultAcctMonth = document.dataForm.next_acct_month.value;
  //alert("num:"+num);
  //alert("flagOn[num].value:"+flagOn[num].value);
	if(flagOn[num].checked){
		document.getElementsByName('no_s_month')[num].value=defaultAcctMonth; 
	//document.getElementsByName('no_s_month')[num].textContent=defaultAcctMonth; 
		document.getElementsByName('no_e_month')[num].value=defaultAcctMonth; 
	//document.getElementsByName('no_e_month')[num].textContent=defaultAcctMonth; 
	} else {
		document.getElementsByName('no_s_month')[num].value=""; 
		document.getElementsByName('no_e_month')[num].value=""; 
	}

  return true;
}


</script>
