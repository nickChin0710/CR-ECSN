<!--**************************************************************************-->
<!--                                                                          -->
<!--                              MODIFICATION LOG                            -->
<!--                                                                          -->
<!--    DATE    VERSION     AUTHOR                 DESCRIPTION                -->
<!-- ---------  --------  -----------    ------------------------------------ -->
<!-- 106-08-03  V1.00.00  ryan           Initial                              -->
<!-- 109-02-07  V1.00.01  JustinWu       add remark_40 input                  -->
<!--**************************************************************************-->
<html>
<head>
<title>卡號區間指定覆核作業</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link rel="stylesheet" href="css/ecsBank.css" type="text/css">
<link rel="stylesheet" href="js/Calendar/calendar.css">
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>
<script language="JavaScript" src="js/jquery.js"></script>
</head>
<body background="${water_mark}">
<form name="dataForm" method="post" action="">
<div id="condBlock">
    <!-- ${#PLUGIN:htmcomm_plugin.apr_user} -->
<!--COND -->
<table width="60%" border="0" cellspacing="0" cellpadding="4">
    <tr>
        <td nowrap>&nbsp;異動日期:
            <input type="text" class="col_date" name="ex_date1" value="${ex_date1}" zEdit="date,yyyymmdd" maxlength="8" size="8" />
            <script language="JavaScript">
                new tcal({ 'formname': 'dataForm', 'controlname': 'ex_date1' });
            </script>
            --
            <input type="text" class="col_date" name="ex_date2" value="${ex_date2}" zEdit="date,yyyymmdd" maxlength="8" size="8" />
            <script language="JavaScript">
                new tcal({ 'formname': 'dataForm', 'controlname': 'ex_date2' });
            </script>&nbsp;
        </td>
        <td nowrap >&nbsp;勾選覆核筆數:<span class="dsp_text" id="num"></span></td>
        <td nowrap>&nbsp;建檔人員:
      		<!--  <select size="1" name="ex_crt_user" class="col_ddlb">
        		${dddw_user_id}
      		</select>-->
      		<input type="text" class="col_any" zEdit="any" name="ex_crt_user" value="${ex_crt_user}"
      		maxlength="12" size="10"/>
    	</td>
    </tr>
    <tr>
    	  <td nowrap>&nbsp;團體代號:
    		<select size="1" id="select" name="ex_grcode" class="col_ddlb" >
                ${ex_grcode2}
            </select>
    	</td>
        <td nowrap>&nbsp;卡片種類:
            <select size="1" name="ex_crdtype" class="col_ddlb">
                ${ex_crdtype}
            </select>
        </td>
        <td nowrap>&nbsp;卡號用途註記:
            <select   size="1"  name="ex_card_flag" class="col_ddlb" >
             	 <option value="">--</option>
                 <option value="1" ${ex_card_flag-1}>一般用</option>
<!--                   
                 <option value="2" ${ex_card_flag-2}>緊急替代用</option>
-->                 
                 <option value="5" ${ex_card_flag-5}>HCE TPAN用</option>
                 <option value="7" ${ex_card_flag-7}>GOOGLE PAY</option>
            </select>
        </td>
    </tr>
    <tr>
        <td nowrap>&nbsp;主管覆核:
            <span class="col_radio">
         		<input type="radio" value="0" name="ex_charge" ${ex_charge-0} />全部
         		<input type="radio" value="1" name="ex_charge" ${ex_charge-1} ${DEFAULT-ex_charge} />未覆核
         		<input type="radio" value="2" name="ex_charge" ${ex_charge-2} />已覆核
      		</span>
        </td>
        <td nowrap >&nbsp;覆核主管:
        	<span class="dsp_text">${ex_aprid}</span>
            <input type="hidden" class="col_any" name="ex_aprid" value="${ex_aprid}" />
        </td>
        <td nowrap>&nbsp;
            <input type="Button" id="btnQuery" value="查詢" onClick="return top.submitControl('Q')" class="btQuery">&nbsp;&nbsp;
            <input type="Button" id="btnClear" value="清除" onClick="return top.submitControl('L')" class="btClear">&nbsp;&nbsp;
            <input type="Button" id="btnAdd" value="執行" onClick="return top.submitControl('C')" class="btAdd">&nbsp;&nbsp;
        </td>
    </tr>
</table>
</div>
<hr>
<!--List -->
<table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
    <tr>
        <th nowrap class="list_th" width="5%">
            <input type="checkbox" name="ex_selectAll" id="allcheck" value="Y" onChange="selectAll();checkNum()">覆核&nbsp;</th>
        <th nowrap class="list_th">異動日期</th>
        <th nowrap class="list_th">卡種</th>
        <th nowrap class="list_th">卡號用途註記</th>
        <th nowrap class="list_th">團體代號</th>
        <th nowrap class="list_th">Bin No</th>
        <th nowrap class="list_th">起流水號</th>
        <th nowrap class="list_th">迄流水號</th>
        <th nowrap class="list_th">錯誤訊息</th>
        <th nowrap class="list_th">主管覆核日期</th>
        <th nowrap class="list_th">主管</th>
        <th nowrap class="list_th">建檔日期</th>
        <th nowrap class="list_th">建檔人員</th>
        <th nowrap class="list_th">備註說明</th>
    </tr>
<!-- BEGIN DYNAMIC : DETAIL -->
    <tr>
        <td nowrap class="list_no">
            <span class="col_key">${ok_flag}</span>
            <input type="checkbox" name="opt" class="check" value="${ser_num}" onChange="checkNum()"/> ${SER_NUM}&nbsp;
            <input type="hidden" name="ser_num" value="${ser_num}" />
            <input type="hidden" name="rowid" value="${rowid}">
            <input type="hidden" name="trans_date" value="${trans_date}">
            <input type="hidden" name="card_type" value="${card_type}">
            <input type="hidden" name="group_code" value="${group_code}">
            <input type="hidden" name="bin_no" value="${bin_no}">
            <input type="hidden" name="beg_seqno" value="${beg_seqno}">
            <input type="hidden" name="end_seqno" value="${end_seqno}">
            <input type="hidden" name="error_msg" value="${error_msg}">
            <input type="hidden" name="charge_date" value="${charge_date}">
            <input type="hidden" name="charge_id" value="${charge_id}">
            <input type="hidden" name="crt_date" value="${crt_date}">
            <input type="hidden" name="crt_user" value="${crt_user}">
            <input type="hidden" name="remark_40" value="${remark_40}">
            <input type="hidden" name="mod_seqno" value="${mod_seqno}">
            <input type="hidden" name="trans_no" value="${trans_no}">
            <input type="hidden" name="card_flag" value="${card_flag}">
            <input type="hidden" name="tt_card_flag" value="${tt_card_flag}">
        </td>
        <td nowrap class="list_ll"> ${trans_date.YMD}&nbsp; </td>
        <td nowrap class="list_ll"> ${card_type}&nbsp; </td>
        <td nowrap class="list_ll"> ${tt_card_flag}&nbsp; </td>
        <td nowrap class="list_ll"> ${group_code}&nbsp; </td>
        <td nowrap class="list_ll"> ${bin_no}&nbsp; </td>
        <td nowrap class="list_ll"> ${beg_seqno}&nbsp;</td>
        <td nowrap class="list_ll"> ${end_seqno}&nbsp; </td>
        <td nowrap class="list_ll"> ${error_msg}&nbsp; </td>
        <td nowrap class="list_ll"> ${charge_date.YMD}&nbsp; </td>
        <td nowrap class="list_ll"> ${charge_id}&nbsp; </td>
        <td nowrap class="list_ll"> ${crt_date.YMD}&nbsp; </td>
        <td nowrap class="list_ll"> ${crt_user}&nbsp; </td>
        <td nowrap class="list_ll"> ${remark_40}&nbsp; </td>
    </tr>
<!-- END DYNAMIC : DETAIL -->
</table>
<input type="hidden" name="data_k1" value="">
<input type="hidden" name="data_k2" value="">
<input type="hidden" name="data_k3" value="">
<input type="hidden" name="MOD_PGM" value="crdp0020">
<input type="hidden" name="HIDE" value="${HIDE_DATA}">
<input type="hidden" name="pageType" value="cond">
<input type="hidden" name="ex_aprid" value="${ex_aprid}">
</form>
</body>

</html>
<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>
<script language="javascript">
top.refreshButton2('0');
top.pageRows = "20";

document.dataForm.ex_date1.focus();

function validateInput() {
    if (!top.checkFormat()) { return false; }

    if (top.actionCode == "X") {
        top.respLevel = 1;
        top.respHtml = "crdp0020_detl_notuse";
    }

    //if ( top.actionCode == "Q" ) {
    //  if ( !chkdata() )
    //  { return false; } 
    //}
    if (top.actionCode == "C") {
        if (!chkdata()) {
            return false;
        }
        if (confirm("是否執行 覆核作業?!") === false) {
            return false;
        }
    }
    return true;
}

function detailScreen(serNum, parm, parm2, parm3) {
    top.respLevel = 1;
    top.currRows = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    top.respHtml = "crdp0020_detl_notuse";
    top.submitControl('S');
    return true;
}

function selectAll() {
    var aElements = document.dataForm.getElementsByTagName("input");
    for (var i = 0; i < aElements.length; i++) {
        if (aElements[i].type == "checkbox") {
            aElements[i].checked = document.dataForm.ex_selectAll.checked;
        }
    }

    return;
}

function chkdata() {
	 var agy =0;
	 $("input[name=opt]").each(function (){
		 if($(this).prop("checked")==true){
			 agy++; 
		 }
	 })
	 if(agy == 0){
		 alert("未選取"+$(".ex_selectAll").text()+"資料!");
		 return false;
 	 }
	 return true;
}

function checkNum(){
	var num = 0;
	$('input[name=opt]').each(function(){
		if($(this).prop("checked")==true){
			num++;
		}
	})
	$("#num").text(num);
}
$(document).ready(function() {
	checkNum();
});
</script>