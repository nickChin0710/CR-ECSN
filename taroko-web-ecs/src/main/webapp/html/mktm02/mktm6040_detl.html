<html>
<head>
<title> 108/12/12 V1.00.01 Allen Ho Initial 專案免年費參數檔維護</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
<link rel="stylesheet" href="js/Calendar/calendar.css">
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>
<script language="JavaScript" src="js/jquery.js"></script>
</head>

<body background="${water_mark}" >
<form name="dataForm"  method="post" action="">

<table border="0" cellpadding="0" cellspacing="0" style="margin-bottom:10px;">
<!-- Button **************************************************************-->
 <tr>
   <td width="100">&nbsp;</td>
   <td colspan="4">
     <img height="30" src="images/upperLevel.gif" style="cursor:hand;" onClick="top.upperLevel()"; alt="回上層"; onmouseout="top.light_img(this);"; onmouseover="top.dark_img(this);">&nbsp;
     <input type="Button"   value="存檔"  ${btnUpdate_disable} onClick="return top.submitControl('U')" class="btUpdate" >&nbsp;&nbsp;
     <input type="Button"   value="刪除" ${btnDelete_disable} onClick="return top.submitControl('D')" class="btDelete" >&nbsp;&nbsp;
   </td>
 </tr>
</table>
<div id="dataBlock">
<!-- Detail data detl *************************************************** -->
 <table width="80%" border="0" cellspacing="0" cellpadding="4">
   <tr>
     <td nowrap class="colKey">專案代號
       <span class="dsp_text">${project_no}</span>
       <input  type="hidden" name="project_no" value="${project_no}" />
     </td>
     <td  nowrap  >放行狀態: 
       <span class="dsp_text">${aud_type}.${commfunc_aud_type}</span>
       <input       type="hidden" name="aud_type" value="${aud_type}" />
       <input  type="hidden" name="commfunc_aud_type" value="${commfunc_aud_type}" />
     </td>
   </tr>
 </table>
 <table width="80%" border="0" cellspacing="0" cellpadding="4">
   <tr>
     <td nowrap>專案名稱:&nbsp; 
       <input type="text" class="col_any" name="project_name" value="${project_name}"
              zEdit="any,canTW" maxlength="30" size="60" />
     </td>
   </tr>
   <tr>
     <td nowrap >帳戶類別:&nbsp;
       <input type="radio" value="0" name="acct_type_sel" ${acct_type_sel-0} checked  onChange="columnOnChange('1')" />全部
       <input type="radio" value="1" name="acct_type_sel" ${acct_type_sel-1} onChange="columnOnChange('1')" />指定
       <input type="radio" value="2" name="acct_type_sel" ${acct_type_sel-2} onChange="columnOnChange('1')" />排除
        <input type="Button" class="btOther"  id="btnacty"  value="帳戶類別" ${btnacty_disable}
               onClick="return buttonScreen('2','acty','data_type','1')" >
     </td>
   </tr>
   <tr>
     <td nowrap >團體代碼:&nbsp;
       <input type="radio" value="0" name="group_code_sel" ${group_code_sel-0} checked  onChange="columnOnChange('2')" />全部
       <input type="radio" value="1" name="group_code_sel" ${group_code_sel-1} onChange="columnOnChange('2')" />指定
       <input type="radio" value="2" name="group_code_sel" ${group_code_sel-2} onChange="columnOnChange('2')" />排除
        <input type="Button" class="btOther"  id="btngpcd"  value="團體代碼" ${btngpcd_disable}
               onClick="return buttonScreen('2','gpcd','data_type','2')" >
     </td>
   </tr>
   <tr>
     <td nowrap >來源代號:&nbsp;
       <input type="radio" value="0" name="source_code_sel" ${source_code_sel-0} checked  onChange="columnOnChange('3')" />全部
       <input type="radio" value="1" name="source_code_sel" ${source_code_sel-1} onChange="columnOnChange('3')" />指定
       <input type="radio" value="2" name="source_code_sel" ${source_code_sel-2} onChange="columnOnChange('3')" />排除
        <input type="Button" class="btOther"  id="btnsrcd"  value="來源代號" ${btnsrcd_disable}
               onClick="return buttonScreen('2','srcd','data_type','3')" >
     </td>
   </tr>
   <tr>
     <td nowrap>
      <input type="checkbox" value="Y" name="recv_month_tag" ${recv_month_tag-Y} >&nbsp;
         收件期間: 
       <input type="text" class="col_date" name="recv_s_date" value="${recv_s_date}"
              zEdit="date,yyyymmdd" maxlength="8" size="8" />
      <script language="JavaScript">
                new tcal ({'formname': 'dataForm','controlname': 'recv_s_date'});
      </script>
         － 
       <input type="text" class="col_date" name="recv_e_date" value="${recv_e_date}"
              zEdit="date,yyyymmdd" maxlength="8" size="8" />
      <script language="JavaScript">
                new tcal ({'formname': 'dataForm','controlname': 'recv_e_date'});
      </script>
     </td>
   </tr>
   <tr>
     <td nowrap>
      <input type="checkbox" value="Y" name="issue_date_tag" ${issue_date_tag-Y} >&nbsp;
         發卡期間: 
       <input type="text" class="col_date" name="issue_date_s" value="${issue_date_s}"
              zEdit="date,yyyymmdd" maxlength="8" size="8" />
      <script language="JavaScript">
                new tcal ({'formname': 'dataForm','controlname': 'issue_date_s'});
      </script>
         － 
       <input type="text" class="col_date" name="issue_date_e" value="${issue_date_e}"
              zEdit="date,yyyymmdd" maxlength="8" size="8" />
      <script language="JavaScript">
                new tcal ({'formname': 'dataForm','controlname': 'issue_date_e'});
      </script>
     </td>
   </tr>
   <tr>
     <td nowrap>免年費對象:&nbsp;
      <input type="checkbox" value="Y" name="mcard_cond" ${mcard_cond-Y} >
              正卡
          
      <input type="checkbox" value="Y" name="scard_cond" ${scard_cond-Y} >
              附卡
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="80%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　ABC條件只運算第二年之年費，若不需要免勾選　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td nowrap>
      <input type="checkbox" value="Y" name="cnt_months_tag" ${cnt_months_tag-Y} >&nbsp;
         A.發卡後 
       <input type="text" class="col_number" name="cnt_months" value="${cnt_months}"
              zEdit="number" maxlength="4" size="4" />
              月，累積刷卡次數滿
          
       <input type="text" class="col_number" name="accumulate_cnt" value="${accumulate_cnt}"
              zEdit="number" maxlength="4" size="4" />
              次(含)以上
         ，或平均每次達 
       <input type="text" class="col_number" name="average_amt" value="${average_amt}"
              zEdit="dignumber" maxlength="8" size="8" />
              元(含)以上
     </td>
   </tr>
   <tr>
     <td nowrap>　　消費金額本金類：&nbsp;
      <input type="checkbox" value="Y" name="cnt_bl_flag" ${cnt_bl_flag-Y} >
              簽帳款(BL)　
         　 
      <input type="checkbox" value="Y" name="cnt_ca_flag" ${cnt_ca_flag-Y} >
              預借現金(CA)
         　　　 
      <input type="checkbox" value="Y" name="cnt_it_flag" ${cnt_it_flag-Y} >
              分期付款(IT)
     </td>
   </tr>
   <tr>
     <td nowrap>　　　　　　　　　　&nbsp;
      <input type="checkbox" value="Y" name="cnt_ao_flag" ${cnt_ao_flag-Y} >
              餘額代償(AO)
         　 
      <input type="checkbox" value="Y" name="cnt_id_flag" ${cnt_id_flag-Y} >
              代收款(ID)　
         　　　 
      <input type="checkbox" value="Y" name="cnt_ot_flag" ${cnt_ot_flag-Y} >
              其他應收款(OT)
     </td>
   </tr>
   <tr>
     <td nowrap>
      <input type="checkbox" value="Y" name="amt_months_tag" ${amt_months_tag-Y} >&nbsp;
         B.發卡後 
       <input type="text" class="col_number" name="amt_months" value="${amt_months}"
              zEdit="number" maxlength="4" size="4" />
              月，累積消費總金額
         滿 
       <input type="text" class="col_number" name="accumulate_amt" value="${accumulate_amt}"
              zEdit="dignumber" maxlength="8" size="8" />
              元(含)以上
     </td>
   </tr>
   <tr>
     <td nowrap>　　消費金額本金類：&nbsp;
      <input type="checkbox" value="Y" name="amt_bl_flag" ${amt_bl_flag-Y} >
              簽帳款(BL)　
         　 
      <input type="checkbox" value="Y" name="amt_ca_flag" ${amt_ca_flag-Y} >
              預借現金(CA)
         　　　 
      <input type="checkbox" value="Y" name="amt_it_flag" ${amt_it_flag-Y} >
              分期付款(IT)
     </td>
   </tr>
   <tr>
     <td nowrap>　　　　　　　　　　&nbsp;
      <input type="checkbox" value="Y" name="amt_ao_flag" ${amt_ao_flag-Y} >
              餘額代償(AO)
         　 
      <input type="checkbox" value="Y" name="amt_id_flag" ${amt_id_flag-Y} >
              代收款(ID)　
         　　　 
      <input type="checkbox" value="Y" name="amt_ot_flag" ${amt_ot_flag-Y} >
              其他應收款(OT)
     </td>
   </tr>
   <tr>
     <td nowrap>
      <input type="checkbox" value="Y" name="adv_months_tag" ${adv_months_tag-Y} >&nbsp;
         C.發卡後 
       <input type="text" class="col_number" name="adv_months" value="${adv_months}"
              zEdit="number" maxlength="4" size="4" />
              月，累積預借現金次數
         滿 
       <input type="text" class="col_number" name="adv_cnt" value="${adv_cnt}"
              zEdit="number" maxlength="4" size="4" />
              次(含)以上
         ，且累積金額達 
       <input type="text" class="col_number" name="adv_amt" value="${adv_amt}"
              zEdit="dignumber" maxlength="8" size="8" />
              元(含)以上
     </td>
   </tr>
   <tr>
     <td nowrap>最後一期M code為&nbsp;
       <select name="mcode" class="col_ddlb"  >
       <option value="  ">--</option>
       <option value="0" ${mcode-0} >0</option>
       <option value="1" ${mcode-1} >1</option>
       <option value="2" ${mcode-2} >2</option>
       <option value="3" ${mcode-3} >3</option>
       <option value="4" ${mcode-4} >4</option>
       <option value="5" ${mcode-5} >5</option>
       <option value="6" ${mcode-6} >6</option>
       <option value="7" ${mcode-7} >7</option>
       <option value="8" ${mcode-8} >8</option>
       <option value="9" ${mcode-9} >9</option>
       <option value="10" ${mcode-10} >10</option>
       <option value="11" ${mcode-11} >11</option>
       <option value="12" ${mcode-12} >12</option>
       <option value="13" ${mcode-13} >13</option>
       <option value="14" ${mcode-14} >14</option>
       <option value="15" ${mcode-15} >15</option>
       <option value="16" ${mcode-16} >16</option>
       <option value="17" ${mcode-17} >17</option>
       <option value="18" ${mcode-18} >18</option>
       <option value="19" ${mcode-19} >19</option>
       <option value="20" ${mcode-20} >20</option>
       <option value="21" ${mcode-21} >21</option>
       <option value="22" ${mcode-22} >22</option>
       <option value="23" ${mcode-23} >23</option>
       <option value="24" ${mcode-24} >24</option>
       </select>
              則免年費
     </td>
   </tr>
   <tr>
     <td nowrap>可免年費年數:&nbsp; 
       <input type="text" class="col_number" name="free_fee_cnt" value="${free_fee_cnt}"
              zEdit="number" maxlength="4" size="4" />
              年
     </td>
   </tr>
 </table>
 <table width="80%" border="0" cellspacing="0" cellpadding="4">
   <tr>
     <td  nowrap  >維護經辦： 
       <span class="dsp_text">${crt_user}</span>
       <input      size="10"  type="hidden" name="crt_user" value="${crt_user}" />
     </td>
     <td  nowrap  >維護日期： 
       <span class="dsp_date">${crt_date.YMD}</span>
       <input      size="8"  type="hidden" name="crt_date" value="${crt_date.YMD}" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >覆核人員： 
       <span class="dsp_text">${apr_user}</span>
       <input      size="10"  type="hidden" name="apr_user" value="${apr_user}" />
     </td>
     <td  nowrap  >覆核日期： 
       <span class="dsp_date">${apr_date.YMD}</span>
       <input      size="8"  type="hidden" name="apr_date" value="${apr_date.YMD}" />
   </tr>
 </table>
</div>
<!-- trail ************************************************************** -->
 <input type="hidden" name="data_k1" value="" >
 <input type="hidden" name="data_k2" value="" >
 <input type="hidden" name="data_k3" value="" >
 <input type="hidden" name="data_k4" value="" >
 <input type="hidden" name="data_k5" value="" >
<input type="hidden" name="fst_apr_flag" value="${fst_apr_flag}">
<input type="hidden" name="ROWID" value="${rowid}">
<input type="hidden" name="CONTROL_TAB_NAME" value="${control_tab_name}">
<input type="hidden" name="MOD_PGM" value="mktm6040">
<input type="hidden" name="MOD_USER" value="${MOD_USER}">
<input type="hidden" name="MOD_SEQNO" value="${mod_seqno}">
<input type="hidden" name="HIDE" value="${HIDE_DATA}">
<input type="hidden" name="pageType" value="detl">

</form>
</body>
</html>
<!-- script d2 *********************************************************** -->
<script language="JavaScript" src="js/AJAXFunction_11.js"></script>
<script language="javascript">

 top.refreshButton2('1');

 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }

    return true;
  }

 function buttonScreen(parm1,parm2,parm3,parm4)
   {
    top.respLevel = 2;
    top.respHtml  = "mktm6040_"+parm2;
    top.submitControl("R"+parm1);

    document.dataForm.data_k1.value = parm3;
    document.dataForm.data_k2.value = parm4;
    return true;
   }


 function columnOnChange(ps1)
  {
   var  win_aud_type = document.forms["dataForm"]["aud_type"].value;
   var  win_acct_type_sel0 = document.forms["dataForm"]["acct_type_sel"][0].checked;
   var  win_group_code_sel0 = document.forms["dataForm"]["group_code_sel"][0].checked;
   var  win_source_code_sel0 = document.forms["dataForm"]["source_code_sel"][0].checked;

   idCode = ps1;
   if ( idCode == '1' )
      {
       if (win_acct_type_sel0 == true)
           {
            document.getElementById("btnacty").disabled = true;
            document.getElementById("btnacty").style.backgroundColor = "lightgray";
           }
        else
           {
            document.getElementById("btnacty").disabled = false;
            document.getElementById("btnacty").style.backgroundColor = "green";
           }
      }

   if ( idCode == '2' )
      {
       if (win_group_code_sel0 == true)
           {
            document.getElementById("btngpcd").disabled = true;
            document.getElementById("btngpcd").style.backgroundColor = "lightgray";
           }
        else
           {
            document.getElementById("btngpcd").disabled = false;
            document.getElementById("btngpcd").style.backgroundColor = "green";
           }
      }

   if ( idCode == '3' )
      {
       if (win_source_code_sel0 == true)
           {
            document.getElementById("btnsrcd").disabled = true;
            document.getElementById("btnsrcd").style.backgroundColor = "lightgray";
           }
        else
           {
            document.getElementById("btnsrcd").disabled = false;
            document.getElementById("btnsrcd").style.backgroundColor = "green";
           }
      }

 }

  $(document).ready(function()
   {
    var ls_acct_type_sel = $("input[name=acct_type_sel]:checked").val();
    if (ls_acct_type_sel != 0 )
       {
        document.getElementById("btnacty").disabled = false;
        document.getElementById("btnacty").style.backgroundColor = "green";
       }
    else
       {
        document.getElementById("btnacty").disabled = true;
        document.getElementById("btnacty").style.backgroundColor = "lightgray";
       }

    var ls_group_code_sel = $("input[name=group_code_sel]:checked").val();
    if (ls_group_code_sel != 0 )
       {
        document.getElementById("btngpcd").disabled = false;
        document.getElementById("btngpcd").style.backgroundColor = "green";
       }
    else
       {
        document.getElementById("btngpcd").disabled = true;
        document.getElementById("btngpcd").style.backgroundColor = "lightgray";
       }

    var ls_source_code_sel = $("input[name=source_code_sel]:checked").val();
    if (ls_source_code_sel != 0 )
       {
        document.getElementById("btnsrcd").disabled = false;
        document.getElementById("btnsrcd").style.backgroundColor = "green";
       }
    else
       {
        document.getElementById("btnsrcd").disabled = true;
        document.getElementById("btnsrcd").style.backgroundColor = "lightgray";
       }

   });
</script>
<!-- ******************************************************************** -->
