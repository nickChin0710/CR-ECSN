<html>
<head>
<title> 109/08/28 V1.00.01 Allen Ho Initial 專案現金回饋參數檔維護</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
<link rel="stylesheet" href="js/Calendar/calendar.css">
<script language="JavaScript" src="js/jquery.js"></script>
</head>

<body background="${water_mark}" >
<form name="dataForm"  method="post" action="">

<table border="0" cellpadding="0" cellspacing="0" style="margin-bottom:10px;">
<!-- Button **************************************************************-->
 <tr>
   <td width="100">&nbsp;</td>
   <td colspan="4">
     <img height="30" src="images/upperLevel.gif" style="cursor:hand;" onClick="top.upperLevel()"; alt="回上層"; onmouseout="top.light_img(this);"; onmouseover="top.dark_img(this);">&nbsp;
     <input type="Button" name="btnUpdate"  value="存檔"  ${btnUpdate_disable} onClick="return top.submitControl('U')" class="btUpdate" >&nbsp;&nbsp;
     <input type="Button" name="btnDelete"  value="刪除" ${btnDelete_disable} onClick="return top.submitControl('D')" class="btDelete" >&nbsp;&nbsp;
   </td>
 </tr>
</table>
<div id="dataBlock">
<!-- Detail data detl *************************************************** -->
 <table width="60%" border="0" cellspacing="0" cellpadding="4">
   <tr>
     <td nowrap class="colKey">現金回饋代碼：
       <span class="dsp_text">${fund_code}</span>
       <input   type="hidden" name="fund_code" value="${fund_code}" />
     </td>
     <td  nowrap  >放行狀態: 
       <span class="dsp_text">${aud_type}.${commfunc_aud_type}</span>
       <input       type="hidden" name="aud_type" value="${aud_type}" />
       <input    type="hidden" name="commfunc_aud_type" value="${commfunc_aud_type}" />
     </td>
   </tr>
 </table>
 <table width="60%" border="0" cellspacing="0" cellpadding="4">
   <tr>
     <td nowrap>現金回饋名稱：&nbsp; 
       <input type="text" class="col_any" name="fund_name" value="${fund_name}"
              zEdit="any,canTW" maxlength="40" size="40" />
     </td>
   </tr>
   <tr>
     <td nowrap>現金回饋有效月數：&nbsp; 
       <input type="text" class="col_number" name="effect_months" value="${effect_months}"
              zEdit="number" maxlength="4" size="4" />
              月(月數為0 ,表示無效期)
         　　 
      <input type="checkbox" value="Y" name="stop_flag" ${stop_flag-Y} >
              停用註記
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="60%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　名單匯入　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td nowrap>
      <input type="checkbox" value="Y" name="list_cond" ${list_cond-Y} onChange="columnOnChange('A')" >&nbsp;
         名單類別: 
       <select name="list_flag" class="col_ddlb"  >
       <option value=" ">--</option>
       <option value="1" ${list_flag-1} >1.身分證號</option>
       <option value="2" ${list_flag-2} >2.卡號(TPAN,SIR)</option>
       <option value="3" ${list_flag-3} >3.一卡通卡號</option>
       <option value="4" ${list_flag-4} >4.悠遊卡號</option>
       <option value="5" ${list_flag-5} >5.愛金卡號</option>
       <option value="6" ${list_flag-6} >6.TCB_ID(生日禮)</option>
       </select>
      <img src="images/uperLoad.gif" onclick="return upload_click('4','list')" style="cursor:hand"
           type="Button" id="upllist" ${upllist_disable}  />
          
       <span class="dsp_text">${list_flag_cnt}</span>
       <input       type="hidden" name="list_flag_cnt" value="${list_flag_cnt}" />
         回饋日期: 
       <span class="dsp_date">${list_feedback_date.YMD}</span>
       <input      size="8"  type="hidden" name="list_feedback_date" value="${list_feedback_date}" />
     </td>
   </tr>
   <tr>
     <td nowrap>　　＊ 匯檔錯誤請至ecsq0040查詢錯誤說明，要完全成功才匯入檔&nbsp; 
     </td>
   </tr>
   <tr>
     <td nowrap>　　＊ 匯入之名單請至mktq4070查詢&nbsp; 
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="60%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　會計分錄代碼　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td nowrap>＊未輸入值表使用現金回饋標準分錄代碼&nbsp; 
     </td>
   </tr>
   <tr>
     <td nowrap>新增標準分錄代碼:&nbsp; 
       <input type="text" class="col_any" name="add_vouch_no" value="${add_vouch_no}"
              zEdit="any" maxlength="4" size="4" />
         　　移除標準分錄代碼: 
       <input type="text" class="col_any" name="rem_vouch_no" value="${rem_vouch_no}"
              zEdit="any" maxlength="4" size="4" />
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="60%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　現金回饋條件　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td nowrap >帳戶類別:&nbsp;
       <input type="radio" value="0" name="acct_type_sel" ${acct_type_sel-0} checked  onChange="columnOnChange('1')" />全部
       <input type="radio" value="1" name="acct_type_sel" ${acct_type_sel-1} onChange="columnOnChange('1')" />指定
       <input type="radio" value="2" name="acct_type_sel" ${acct_type_sel-2} onChange="columnOnChange('1')" />排除
        <input type="Button" class="btOther" name="btnactp" id="btnactp"  value="帳戶類別" ${btnactp_disable}
               onClick="return buttonScreen('2','actp','data_type','1')" >
          
       <span class="dsp_text">${acct_type_sel_cnt}</span>
       <input       type="hidden" name="acct_type_sel_cnt" value="${acct_type_sel_cnt}" />
     </td>
   </tr>
   <tr>
     <td nowrap >團體代號:&nbsp;
       <input type="radio" value="0" name="group_code_sel" ${group_code_sel-0} checked  onChange="columnOnChange('2')" />全部
       <input type="radio" value="1" name="group_code_sel" ${group_code_sel-1} onChange="columnOnChange('2')" />指定
       <input type="radio" value="2" name="group_code_sel" ${group_code_sel-2} onChange="columnOnChange('2')" />排除
        <input type="Button" class="btOther" name="btngpcd" id="btngpcd"  value="團體代號" ${btngpcd_disable}
               onClick="return buttonScreen('2','gpcd','data_type','2')" >
      <img src="images/uperLoad.gif" onclick="return upload_click('2','gpcd')" style="cursor:hand"
           type="Button" id="uplgpcd" ${uplgpcd_disable}  />
          
       <span class="dsp_text">${group_code_sel_cnt}</span>
       <input       type="hidden" name="group_code_sel_cnt" value="${group_code_sel_cnt}" />
     </td>
   </tr>
   <tr>
     <td nowrap>　　
      <input type="checkbox" value="Y" name="group_oppost_cond" ${group_oppost_cond-Y} >
              團代停卡三個月後該活動基金移除
     </td>
   </tr>
   <tr>
     <td nowrap>回饋上限：&nbsp; 
       <input type="text" class="col_number" name="feedback_lmt" value="${feedback_lmt}"
              zEdit="dignumber" maxlength="8" size="8" />
              元(金額為0 ,表示無上限)
     </td>
   </tr>
   <tr>
     <td nowrap >抵用方式:&nbsp;
       <input type="radio" value="1" name="res_flag" ${res_flag-1} checked  />1.分次贈送期(月)數
          
       <input type="text" class="col_number" name="res_total_cnt" value="${res_total_cnt}"
              zEdit="number" maxlength="4" size="4" />
              (回饋金額除以次數,未除盡金額歸首期)
     </td>
   </tr>
   <tr>
     <td nowrap >　 　　　&nbsp;
       <input type="radio" value="2" name="res_flag" ${res_flag-2} />2.回灌可使用第一次週期後,第
          
       <input type="text" class="col_number" name="exec_s_months" value="${exec_s_months}"
              zEdit="number" maxlength="3" size="3" />
              個月可開始抵用(0 表可立即抵用)
     </td>
   </tr>
   <tr>
   </tr>
 </table>
 <table  width="60%" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap>　　　　　　　　　　　　　　　　現金回饋抵用方式　　　　　　　　　　　　　　　　&nbsp;</th>
  </tr>
   <tr>
     <td nowrap>抵用餘額撥入溢付款:&nbsp;
       <select name="move_cond" class="col_ddlb"  >
       <option value="N" ${move_cond-N} >N.繼續存於現金回饋檔</option>
       <option value="Y" ${move_cond-Y} >Y.撥入溢付款</option>
       </select>
     </td>
   </tr>
   <tr>
     <td nowrap>
      <input type="checkbox" value="Y" name="bil_mcht_cond" ${bil_mcht_cond-Y} >
              使用分期卡排除特店 (bilm0810 維護)
     </td>
   </tr>
   <tr>
     <td nowrap >特店代號:&nbsp;
       <input type="radio" value="0" name="merchant_sel" ${merchant_sel-0} checked  onChange="columnOnChange('C')" />全部
       <input type="radio" value="1" name="merchant_sel" ${merchant_sel-1} onChange="columnOnChange('C')" />指定
       <input type="radio" value="2" name="merchant_sel" ${merchant_sel-2} onChange="columnOnChange('C')" />排除
        <input type="Button" class="btOther" name="btnmrch" id="btnmrch"  value="特店代號" ${btnmrch_disable}
               onClick="return buttonScreen('3','mrch','data_type','3')" >
      <img src="images/uperLoad.gif" onclick="return upload_click('1','aaa1')" style="cursor:hand"
           type="Button" id="uplaaa1" ${uplaaa1_disable}  />
          
       <span class="dsp_text">${merchant_sel_cnt}</span>
       <input       type="hidden" name="merchant_sel_cnt" value="${merchant_sel_cnt}" />
     </td>
   </tr>
   <tr>
     <td nowrap >特店群組:&nbsp;
       <input type="radio" value="0" name="mcht_group_sel" ${mcht_group_sel-0} checked  onChange="columnOnChange('D')" />全部
       <input type="radio" value="1" name="mcht_group_sel" ${mcht_group_sel-1} onChange="columnOnChange('D')" />指定
       <input type="radio" value="2" name="mcht_group_sel" ${mcht_group_sel-2} onChange="columnOnChange('D')" />排除
        <input type="Button" class="btOther" name="btnaaa1" id="btnaaa1"  value="特店群組" ${btnaaa1_disable}
               onClick="return buttonScreen('2','aaa1','data_type','4')" >
          
       <span class="dsp_text">${mcht_group_sel_cnt}</span>
       <input       type="hidden" name="mcht_group_sel_cnt" value="${mcht_group_sel_cnt}" />
     </td>
   </tr>
   <!-- 
      <tr>
     <td nowrap>抵用限制：1.有效卡(依抵用條件)&nbsp; 
       <input type="text" class="col_number" name="issue_a_months" value="${issue_a_months}"
              zEdit="number" maxlength="4" size="4" />
              個月內未開卡者，不再抵用
     </td>
   </tr>
   -->   
      <input type="hidden" name="issue_a_months" value="99"/>
   <tr>
     <!-- 
     <td nowrap>　　　　　2.M_code >=&nbsp; 
       <input type="text" class="col_number" name="mcode" value="${mcode}"
              zEdit="number" maxlength="4" size="4" />
              時，不抵扣消費
     </td>
      -->
     <td nowrap>抵用限制： M_code >=&nbsp; 
       <input type="text" class="col_number" name="mcode" value="${mcode}"
              zEdit="number" maxlength="4" size="4" />
              時，不抵扣消費
     </td>
   </tr>
   <!--          
   <tr>
     <td nowrap>抵用範圍：* 比率&nbsp; 
       <input type="text" class="col_number" name="cancel_rate" value="${cancel_rate}"
              zEdit="dignumber" maxlength="4" size="4" />
              ％
     </td>     
   </tr>
 -->
      <input type="hidden" name="cancel_rate" value="100.00"/>
   <tr>
     <td nowrap >抵用範圍：&nbsp;
       <input type="radio" value="1" name="cancel_scope" ${cancel_scope-1} checked />1.當期簽帳款(六大本金)
     </td>
   </tr>
   <tr>
     <td nowrap >　　　　　&nbsp;
       <input type="radio" value="2" name="cancel_scope" ${cancel_scope-2} />2.當期全部信用卡款(所有本金+費用+利息)
     </td>
   </tr>
   <tr>
     <td nowrap >　　　　　&nbsp;
       <input type="radio" value="3" name="cancel_scope" ${cancel_scope-3} />3.全部簽帳款(六大本金)
     </td>
   </tr>
   <tr>
     <td nowrap >　　　　　&nbsp;
       <input type="radio" value="4" name="cancel_scope" ${cancel_scope-4} />4.全部信用卡款(所有本金+費用+利息)
     </td>
   </tr>
   <tr>
     <td nowrap >抵用條件：*&nbsp;
       <input type="radio" value="1" name="cancel_event" ${cancel_event-1} checked  />1.不限
       <input type="radio" value="2" name="cancel_event" ${cancel_event-2} />2.有有效卡
       <input type="radio" value="3" name="cancel_event" ${cancel_event-3} />3.有聯名卡有效卡
     </td>
   </tr>
   <tr>
     <td nowrap>＊抵用條件中的「有聯名有效卡」是指上列參數條件中所設的「團體代號」&nbsp; 
     </td>
   </tr>
 </table>
 <table width="60%" border="0" cellspacing="0" cellpadding="4">
   <tr>
     <td  nowrap  >維護經辦： 
       <span class="dsp_text">${crt_user}</span>
       <input      size="10"  type="hidden" name="crt_user" value="${crt_user}" />
     </td>
     <td  nowrap  >維護日期： 
       <span class="dsp_date">${crt_date.YMD}</span>
       <input      size="8"  type="hidden" name="crt_date" value="${crt_date}" />
     </td>
   </tr>
   <tr>
     <td  nowrap  >覆核人員： 
       <span class="dsp_text">${apr_user}</span>
       <input      size="10"  type="hidden" name="apr_user" value="${apr_user}" />
     </td>
     <td  nowrap  >覆核日期： 
       <span class="dsp_date">${apr_date.YMD}</span>
       <input      size="8"  type="hidden" name="apr_date" value="${apr_date}" />
     </td>
   </tr>
   <tr>
       <input type="hidden" class="col_any" name="payment_type" value="${payment_type}"
              zEdit="any" maxlength="0" />
   </tr>
 </table>
</div>
<!-- trail ************************************************************** -->
 <input type="hidden"  name="sys_upload_type" value="" />
 <input type="hidden"  name="sys_upload_alias" value="" />
 <input type="hidden"  name="upload_file" value="" />
 <input type="hidden" class="dsp_text"  name="zz_file_name" value="" zEdit="any,canTw" />
<input type="hidden" name="payment_type" value="${payment_type}">
 <input type="hidden" name="data_k1" value="" >
 <input type="hidden" name="data_k2" value="" >
 <input type="hidden" name="data_k3" value="" >
 <input type="hidden" name="data_k4" value="" >
 <input type="hidden" name="data_k5" value="" >
<input type="hidden" name="fst_apr_flag" value="${fst_apr_flag}">
<input type="hidden" name="ROWID" value="${rowid}">
<input type="hidden" name="CONTROL_TAB_NAME" value="${control_tab_name}">
<input type="hidden" name="MOD_PGM" value="mktm4070">
<input type="hidden" name="MOD_USER" value="${MOD_USER}">
<input type="hidden" name="MOD_SEQNO" value="${mod_seqno}">
<input type="hidden" name="HIDE" value="${HIDE_DATA}">
<input type="hidden" name="pageType" value="detl">
<input type="hidden" name="apr_flag" value="${apr_flag}">

</form>
</body>
</html>
<!-- script d2 *********************************************************** -->
<script language="JavaScript" src="js/AJAXFunction_11.js"></script>
<script language="javascript">

 top.refreshButton2('1');

 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }

    return true;
  }

 function buttonScreen(parm1,parm2,parm3,parm4)
   {
    top.respLevel = 2;
    top.respHtml  = "mktm4070_"+parm2;
    top.submitControl("R"+parm1);

    document.dataForm.data_k1.value = parm3;
    document.dataForm.data_k2.value = parm4;
    return true;
   }


 function columnItemChange(ps1)
  {
   var  win_fund_code =document.forms["dataForm"]["fund_code"].value;

   idCode = ps1;
   top.actionCode = "Q";
   if ( idCode == '1' )
      {
       top.methodName = "wf_ajax_func_1";
       resetJSON();
       addJSON("ax_win_fund_code",win_fund_code);
      }

   processAJAX();
 }


 function columnOnChange(ps1)
  {
   var  win_aud_type = document.forms["dataForm"]["aud_type"].value;
   var  win_list_cond = document.forms["dataForm"]["list_cond"].checked;
   var  win_acct_type_sel0 = document.forms["dataForm"]["acct_type_sel"][0].checked;
   var  win_group_code_sel0 = document.forms["dataForm"]["group_code_sel"][0].checked;
   var  win_merchant_sel0 = document.forms["dataForm"]["merchant_sel"][0].checked;
   var  win_mcht_group_sel0 = document.forms["dataForm"]["mcht_group_sel"][0].checked;

   idCode = ps1;
   if ( idCode == '1' )
      {
       if (win_acct_type_sel0 == true)
           {
            document.getElementById("btnactp").disabled = true;
            document.getElementById("btnactp").style.backgroundColor = "lightgray";
           }
        else
           {
            document.getElementById("btnactp").disabled = false;
            document.getElementById("btnactp").style.backgroundColor = "green";
           }
      }

   if ( idCode == 'A' )
      {
       if (win_list_cond == false)
           {
            document.getElementById("upllist").disabled = true;
           }
        else
           {
            document.getElementById("upllist").disabled = false;
           }
      }

   if ( idCode == '2' )
      {
       if (win_group_code_sel0 == true)
           {
            document.getElementById("btngpcd").disabled = true;
            document.getElementById("btngpcd").style.backgroundColor = "lightgray";
            document.getElementById("uplgpcd").disabled = true;
           }
        else
           {
            document.getElementById("btngpcd").disabled = false;
            document.getElementById("btngpcd").style.backgroundColor = "green";
            document.getElementById("uplgpcd").disabled = false;
           }
      }

   if ( idCode == 'C' )
      {
       if (win_merchant_sel0 == true)
           {
            document.getElementById("btnmrch").disabled = true;
            document.getElementById("btnmrch").style.backgroundColor = "lightgray";
            document.getElementById("uplaaa1").disabled = true;
           }
        else
           {
            document.getElementById("btnmrch").disabled = false;
            document.getElementById("btnmrch").style.backgroundColor = "green";
            document.getElementById("uplaaa1").disabled = false;
           }
      }

   if ( idCode == 'D' )
      {
       if (win_mcht_group_sel0 == true)
           {
            document.getElementById("btnaaa1").disabled = true;
            document.getElementById("btnaaa1").style.backgroundColor = "lightgray";
           }
        else
           {
            document.getElementById("btnaaa1").disabled = false;
            document.getElementById("btnaaa1").style.backgroundColor = "green";
           }
      }

   if ((win_aud_type == "Y") ||
       (win_aud_type == "D"))
      {
       document.getElementById("upllist").disabled = true;
       document.getElementById("uplgpcd").disabled = true;
       document.getElementById("uplaaa1").disabled = true;
      }

 }

  $(document).ready(function()
   {
    var ls_list_cond = document.dataForm.list_cond.checked;
    if (ls_list_cond == true )
       {
        document.getElementById("btnlist").disabled = false;
        document.getElementById("btnlist").style.backgroundColor = "green";
       }
    else
       {
        document.getElementById("btnlist").disabled = true;
        document.getElementById("btnlist").style.backgroundColor = "lightgray";
       }

    var ls_acct_type_sel = $("input[name=acct_type_sel]:checked").val();
    if (ls_acct_type_sel != 0 )
       {
        document.getElementById("btnactp").disabled = false;
        document.getElementById("btnactp").style.backgroundColor = "green";
       }
    else
       {
        document.getElementById("btnactp").disabled = true;
        document.getElementById("btnactp").style.backgroundColor = "lightgray";
       }

    var ls_group_code_sel = $("input[name=group_code_sel]:checked").val();
    if (ls_group_code_sel != 0 )
       {
        document.getElementById("btngpcd").disabled = false;
        document.getElementById("btngpcd").style.backgroundColor = "green";
       }
    else
       {
        document.getElementById("btngpcd").disabled = true;
        document.getElementById("btngpcd").style.backgroundColor = "lightgray";
       }

    var ls_merchant_sel = $("input[name=merchant_sel]:checked").val();
    if (ls_merchant_sel != 0 )
       {
        document.getElementById("btnmrch").disabled = false;
        document.getElementById("btnmrch").style.backgroundColor = "green";
       }
    else
       {
        document.getElementById("btnmrch").disabled = true;
        document.getElementById("btnmrch").style.backgroundColor = "lightgray";
       }

    var ls_mcht_group_sel = $("input[name=mcht_group_sel]:checked").val();
    if (ls_mcht_group_sel != 0 )
       {
        document.getElementById("btnaaa1").disabled = false;
        document.getElementById("btnaaa1").style.backgroundColor = "green";
       }
    else
       {
        document.getElementById("btnaaa1").disabled = true;
        document.getElementById("btnaaa1").style.backgroundColor = "lightgray";
       }

   });
 function ajaxResponse()
 {
  top.respHtml ="mktm4070_detl";

  if (idCode == '1' )
     {
      document.dataForm.payment_type.value =getJSONvalue("payment_type",0);
      return false;
     }
 }

function upload_click(parm1,parm2)
 {

   if ( parm2 === 'list' )
      {
       var  win_list_flag     =document.forms["dataForm"]["list_flag"].value;
       if ( win_list_flag === ' ' )
          {
           alert("指定名單類別選項必須選擇!");
           return false;
          }
      }
   if ( parm2 === 'aaa1' )
      {
       var  win_merchant_sel = document.forms["dataForm"]["merchant_sel"][0].checked;
       if ( win_merchant_sel === true )
          {
           alert("特店代號選項不能為全部!");
           return false;
          }
      }
   if ( parm2 === 'gpcd' )
      {
       var  win_group_code_sel = document.forms["dataForm"]["group_code_sel"][0].checked;
       if ( win_group_code_sel === true )
          {
           alert("團體代號選項不能為全部!");
           return false;
          }
      }


  document.dataForm.zz_file_name.value = "";

  document.dataForm.sys_upload_type.value = parm1;
  document.dataForm.sys_upload_alias.value = parm2;
  var parmHtml    = "TarokoUpload";
  var parmName    = "upload_file,zz_file_name";
  var windowSize  = "width=700, height=250, top=100, left=200, resizable=yes";
  top.packageName = "taroko.com";
  top.javaName    = "TarokoUpload";
  top.methodName  = "showScreen";
  top.openWindow("",parmHtml,parmName,windowSize);

  top.packageName = "mktm02";
  top.javaName    = "Mktm4070";
  top.requHtml    = "mktm4070_detl";
  top.respHtml    = "mktm4070_detl";
  return true;
 }

function wf_uploadAfter()
 {
  var ss=document.dataForm.zz_file_name.value.trim();
  if (ss.length>0)  top.submitControl('UPLOAD2');
 }

</script>
<!-- ******************************************************************** -->
