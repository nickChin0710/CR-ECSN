<html>
<head>
<title>bilm0710-mcht-V.2017-1018-ryan-[Initial]</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
</head>
<script language="JavaScript">
function wf_add_newrow()
{
//debugger;
var ind=document.getElementById( 'table1' ).rows.length -1;
var rowNum=document.getElementById( 'table1' ).rows.length -1;
var colNum=0;
var fi=0;
//console.log("a:"+ind);
var num = '${ser_num}';
if(num==''){
	ind=document.getElementById( 'table1' ).rows.length-2;
}
    colNum=0 
    rowNum++;
    ind++;
    var myRow = document.all.table1.insertRow(rowNum);
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_no";
    myCell.noWrap ="nowrap";

    var serNo ="";
    if ( ind < 10 )
        { serNo = "0"+ind; }
    else
        { serNo = ""+ind;  }
    fi++;
	
	var con = document.createElement( 'span' );
    con.textContent = serNo;
    myCell.appendChild( con );
	
    var ip = document.createElement( 'input' );
    ip.className = 'col_ckbox';
    ip.type = 'checkbox';
    ip.name = 'opt';
    ip.value = serNo;
    myCell.appendChild( ip );
    
    var ip1 = document.createElement( 'input' );
    ip1.type = 'hidden';
    ip1.name = 'ser_num';
    ip1.value = serNo;
    myCell.appendChild( ip1 );
    
    var mno = document.createElement( 'input' );
    mno.type = 'hidden';
    mno.name = 'rowid1';
    mno.value = '';
    myCell.appendChild(mno);
    
    var ip2 = document.createElement( 'input' );
    ip2.type = 'hidden';
    ip2.name = 'data_code2';
    ip2.value = '';
    myCell.appendChild( ip2 );
    
	var ip3 = document.createElement( 'input' );
    ip3.type = 'hidden';
    ip3.name = 'mod_seqno';
    ip3.value = '';
    myCell.appendChild( ip3 );
    
    //======================================

    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_td";
    
    var mo1 = document.createElement( 'input' );
	mo1.setAttribute('class', 'col_any');
    mo1.type = 'text';
    mo1.name = 'data_code';
	mo1.size = 20;
	mo1.maxlength = 20;
    mo1.value = '';
    mo1.setAttribute('zEdit', 'any');
    myCell.appendChild(mo1);



}	
</script>
<body background="${water_mark}" >
<form name="dataForm"  method="post" action="">
<table border="0" cellpadding="0" cellspacing="0" style="margin-bottom:10px;width:20%">
  	<tr>
     	<td align="center">&nbsp;
        	<img height="30" src="images/upperLevel.gif" style="cursor:hand;" onClick="top.upperLevel()" alt="回上層" >&nbsp;
     	</td>
  	</tr>
</table>
<div id="dataBlock">
<table width="20%" border="0" cellspacing="0" cellpadding="4">
  	<tr>
    	<td>特店代號:
      		<input type="hidden" name="action_code2" value="${action_code2}"/>
      		<input type="hidden" name="action_code" value="${action_code}"/>
      		<span class="dsp_text">${action_code}</span>
    	</td>
  	</tr>
</table>
<hr>
<table border="0" width="5%">
  	<tr>
    	<td align="right">
       		<input type="Button"   value="新增明細" ${btnSelect_disable} onclick="wf_add_newrow()" class="btAdd_detl" />&nbsp;
    	</td>
    	<td> 
       		<input type="Button"    value="存檔" ${btnUpdate_disable} onClick="return top.submitControl('S10U')" class="btUpdate" >
            <img src="images/uperLoad.gif" onclick="return upload_click()" style="cursor:hand" />
    	</td>
  	</tr>
</table>
<table id="table1" width="20%" border="0" cellspacing="0" cellpadding="4">
	<tr>
		<th nowrap class="list_th" width="5%">刪除 </th>
    	<th nowrap class="list_th">特店代號</th>
  	</tr>
<!-- BEGIN DYNAMIC : DETAIL -->
  	<tr>
     	<td nowrap class="list_no">
			<span class="dsp_flag">${ok_flag}</span>
			${SER_NUM}
			<input type="checkbox" name="opt" value="${ser_num}"/>
			<input type="hidden" name="ser_num" value="${ser_num}"/>
			<input type="hidden" name="rowid1" value="${rowid1}" />
     	</td>
     	<td >
     		<input type=text class="col_any" name="data_code" value="${data_code}" zedit="any" maxlength="20" size="20" />
     	</td>
  	</tr>
<!-- END DYNAMIC : DETAIL -->
</table>
</div>

<!-- -->
<input type="hidden" name="MOD_PGM" value="bilm0710">
<input type="hidden" name="ROWID" value="${rowid}">
<input type="hidden" name="MOD_SEQNO" value="${mod_seqno}">
<input type="hidden" name="HIDE" value="${HIDE_DATA}">
<input type="hidden" name="pageType" value="nccc">
<input type="hidden"  name="h_data_code" id="h_data_code" value="${card_data_code}">
<input type="text" class="dsp_text"  name="zz_file_name" value="" zEdit="any,canTw" />
<input type="hidden" name="upload_file" value="" /> 
<input type="hidden" name="product_no" value="${product_no}">
</form>
</body>
</html>
<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="javascript">
 top.refreshButton2('2');
 top.pageRows="999";


 function validateInput() { 
   if ( !top.checkFormat() )
       { return false; }

   return true;
 }
 
 function upload_click() {
	    
     document.dataForm.zz_file_name.value = "";
     
     var parmHtml    = "TarokoUpload";
     var parmName    = "upload_file,zz_file_name";
     var windowSize  = "width=700, height=250, top=100, left=200, resizable=yes";
     top.packageName = "taroko.com";
     top.javaName    = "TarokoUpload";
     top.methodName  = "showScreen";
     top.openWindow("",parmHtml,parmName,windowSize);

     //alert("rskm1070-aaaa");
     top.packageName = "bilm01";
     top.javaName    = "Bilm0710";
     //methodName  = "actionFunction";
     top.requHtml    = "bilm0710_mcht";
     top.respHtml    = "bilm0710_mcht";
     return true;
   }
function wf_uploadAfter()
{
var ss=document.dataForm.zz_file_name.value.trim();
if (ss.length>0) {
 top.submitControl('UPLOAD1');
}
}
 
</script>
