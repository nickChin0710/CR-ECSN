<html>
<head>
<title>分期卡排除交易特店維護-V.2019-1202-Amber-[Update]</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
</head>

<body background="${water_mark}" >
<form  name="dataForm" method="post" action="" >
 ${#PLUGIN:htmcomm_plugin.apr_user}
<div id="condBlock">

<!--COND -->
<table width="60%" border="0" cellspacing="0" cellpadding="4">
    <tr>
        <td nowrap>&nbsp;銀行代號:
            <input type="text" class="col_text" name="ex_bank_no" id="ex_bank_no" value="${ex_bank_no}" zEdit="number" maxlength=3 size=4 />
            <select size="1" name="ddl_bank_no" id="ddl_bank_no"   class="col_ddlb" onChange="top.setBlockValue('ex_bank_no','ddl_bank_no')">
                ${dddw_bank_no}
            </select>
        </td>
        <td nowrap>&nbsp;特店代號:
            <input type="text" class="col_text" name="ex_merchant" value="${ex_merchant}" zEdit="any" maxlength=15 size=15 />
            &nbsp;&nbsp;
            <input type="Button"   value="..." onclick="processVendorCode()" class="btAdd_detl" />&nbsp;
        </td>
     </tr>
     <tr>
        <td nowrap colspan="2">&nbsp;
            <input type="Button"  value="查詢" onClick="return top.submitControl('Q')" class="btQuery" >&nbsp;&nbsp;
            <input type="Button"   value="清除" onClick="return top.submitControl('L')" class="btClear" >&nbsp;&nbsp;
            <input type="Button"     value="新增" ${btnAdd_disable} onClick="return top.submitControl('X')" class="btAdd" >&nbsp;&nbsp;
            <input type="Button"   value="匯入" onClick="return upload_click()" class="btProcess">&nbsp;&nbsp;
            <input type="Button"   value=" 刪除 " ${btnDelete_disable} onClick="return top.submitControl('D1')" class="btDelete">&nbsp;&nbsp;
        </td> 
    </tr>
 </table>
</div>
<hr>
<!-- 動態 BLOCK 視窗控制 -->
        <div id="disDiv" class="disScreen"></div>
        <div id="popDiv" class="popup1">
            <table id="popup2" style="top:-40px; left:350px; width:300px; height:100px;">
                <tr>
                    <td colspan="2"><img onClick="top.hideBlock('popDiv')" src="./images/close_div2.png" /></td>
                </tr>
                <tr>
                    <td colspan="2">&nbsp;</td>
                </tr>
                <tr>
                    <th nowrap style="width:40%;">特店代號：</th>
                    <td nowrap style="width:60%;">
                        <select size="1" name="merchant_2" id="merchant_2">
                            ${OPTION_LIST_2}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input type="Button" value=" ok " onClick="top.setBlockValue('ex_merchant','merchant_2'); top.hideBlock('popDiv');" class="btConfirm">
                    </td>
                </tr>
            </table>
        </div>
<!--List -->
<table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4" width="60%">
    <tr>
<!--         <th nowrap class="list_th" width="5%">No&nbsp;</th> -->
		<th nowrap class="list_th" width="5%">
            <input type="checkbox" name="ex_selectAll" value="Y" onChange="selectAll();" >刪除&nbsp;</th>
        <th nowrap class="list_th" width="10%">銀行代號</th>
		<th nowrap class="list_th" width="20%">特店代號</th>
		<th nowrap class="list_th">備註</th>
    </tr>
     <!-- BEGIN DYNAMIC : DETAIL -->
    
    		
    
    <tr>
<!-- 	   <td nowrap class="list_no"> ${SER_NUM}&nbsp;</td> -->
		<td nowrap class="list_no" >
          <span class="dsp_flag">${ok_flag}</span>
            ${SER_NUM}
          <input type="checkbox" name="opt" value="${ser_num}" ${aa_opt}>
          <input type="hidden" name="ser_num" value="${ser_num}"/>
          <input type="hidden" name="rowid" value="${rowid}"/>
          <input type="hidden" name="mod_seqno" value="${mod_seqno}"/>
        </td>
       <td nowrap class="list_ll"> ${bank_no}</td>
	   <td nowrap class="list_ll" onclick="detailScreen('${SER_NUM}','${bank_no}','${mcht_no}','')" style="cursor:hand">${mcht_no}</td>
<!-- 	   <td nowrap class="list_ll"> ${mcht_no}</td> -->
	   <td nowrap class="list_ll"> ${remark_40}</td>
	   <input type="hidden"  name="bank_no"  value="${bank_no}">
	   <input type="hidden"  name="mcht_no"  value="${mcht_no}">
	   <input type="hidden"  name="remark_40"  value="${remark_40}">

    </tr>
  <!-- END DYNAMIC : DETAIL -->
</table>


<input type="hidden"  name="data_k1" value="" >
<input type="hidden"  name="data_k2" value="" >
<input type="hidden"  name="data_k3" value="" >
<input type="hidden"  name="HIDE"  value="${HIDE_DATA}">
<input type="hidden"  name="pageType"  value="cond">
<input type="hidden" name="MOD_PGM" value="bilm0810">
<input type="text" class="dsp_text"  name="zz_file_name" value="" zEdit="any,canTw" readonly />
<input type="hidden"  name="upload_file" value="" /> 

</form>
</body>
</html>
<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript" src="js/AJAXFunction_11.js"></script>
<script language="JavaScript">
    tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>
<script language="javascript">

top.refreshButton2('0');
top.pageRows="20";


function validateInput()
{
    if ( !top.checkFormat() )
        { return false; }
    if ( top.actionCode == "X" ) {
        top.respLevel = 1;
        top.respHtml = "bilm0810_detl";
    }
    return true;
}

function detailScreen(serNum,parm,parm2,parm3) { 
    top.respLevel = 1;
    top.currRows  = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    top.respHtml  = "bilm0810_detl";
    top.submitControl('S');
    return true;
}
function upload_click() {

    document.dataForm.zz_file_name.value = "";
    
    var parmHtml    = "TarokoUpload";
    var parmName    = "upload_file,zz_file_name";
    var windowSize  = "width=700, height=250, top=100, left=200, resizable=yes";
    top.packageName = "taroko.com";
    top.javaName    = "TarokoUpload";
    top.methodName  = "showScreen";
    top.openWindow("",parmHtml,parmName,windowSize);

    //alert("rskm1070-aaaa");
    top.packageName = "bilm01";
    top.javaName    = "Bilm0810";
    //methodName  = "actionFunction";
    top.requHtml    = "bilm0810";
    top.respHtml    = "bilm0810";
    return true;
  }
  
 function wf_uploadAfter() {
    var ss=document.dataForm.zz_file_name.value.trim();
    if (ss.length>0) {
      top.submitControl('UPLOAD');
    }
 }

 // function set_bank_no(){
 //    var ss = 
 // } 
 /* 處理　PUPOP BLOCK */
function processVendorCode() {
    var vendorNo = document.dataForm.ex_merchant.value;

    if (vendorNo.length < 2) { alert("請輸入至少兩碼"); return false; }
    resetJSON();
    autoJSON = false;
    addJSON("ex_merchant", vendorNo);
    top.actionCode = "AJAX";
    top.methodName = "actionFunction";
    processAJAX();
    return true;
}

function ajaxResponse() {
    var vendorNo = document.dataForm.ex_merchant.value;
    var vendorList = document.getElementById("merchant_2");

    for (var i = vendorList.length - 1; i >= 0; i--) { vendorList.remove(i); }

    var len = getJSONlength("OPTION_TEXT");
    for (var i = 0; i < len; i++) {
        vendorList.options.add(new Option(getJSONvalue("OPTION_TEXT", i), getJSONvalue("OPTION_VALUE", i)));
        if (vendorList.options[i].value == vendorNo && vendorNo.length > 0) { vendorList.options[i].selected = true; }
    }

    top.popupBlock('popDiv');
}

//全選
function selectAll() {
    var aElements = document.dataForm.getElementsByTagName("input");
    for ( var i=0;  i < aElements.length; i++ ) {
        if  ( aElements[i].name == "opt" ) {
            aElements[i].checked = document.dataForm.ex_selectAll.checked;
        }
    }
    
    return;
}
</script>
