<!--**************************************************************************-->
<!--                                                                          -->
<!--                              MODIFICATION LOG                            -->
<!--                                                                          -->
<!--    DATE    VERSION     AUTHOR                 DESCRIPTION                -->
<!-- ---------  --------  -----------    ------------------------------------ -->
<!-- 106-10-23  V1.00.01  yash           Initial                              -->
<!--                                                                          -->
<!--**************************************************************************-->
<html>
<head>
<title>線上加檔登錄作業</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
</head>
<script language="JavaScript">
function wf_add_newrow()
{
var ind=document.getElementById( 'table1' ).rows.length -1;
var rowNum=document.getElementById( 'table1' ).rows.length -1;
var colNum=0;
var fi=0;
var num = '${ser_num}';
if(num==''){
    ind=document.getElementById( 'table1' ).rows.length-2;
}
    colNum=0 
    rowNum++;
    ind++;
    var myRow = document.all.table1.insertRow(rowNum);
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_no";
    myCell.noWrap ="nowrap";

    var serNo ="";
    if ( ind < 10 )
        { serNo = "0"+ind+" "; }
    else
        { serNo = ""+ind+" ";  }
    fi++;
	
	var con = document.createElement( 'span' );
    con.textContent = serNo; 
    myCell.appendChild( con );
	
    var ip = document.createElement( 'input' );
    ip.className = 'col_ckbox';
    ip.type = 'checkbox';
    ip.name = 'opt';
    ip.value = serNo;
    myCell.appendChild( ip );
    
    var ip1 = document.createElement( 'input' );
    ip1.type = 'hidden';
    ip1.name = 'ser_num';
    ip1.value = serNo;
    myCell.appendChild( ip1 );
    
    var ip2 = document.createElement( 'input' );
    ip2.type = 'hidden';
    ip2.name = 'rowid';
    ip2.value = '';
    myCell.appendChild( ip2 );

    var ip3 = document.createElement( 'input' );
    ip3.type = 'hidden';
    ip3.name = 'mod_seqno';
    ip3.value = '';
    myCell.appendChild( ip3 );
   //====================================== 
  
    colNum++;
	myCell = myRow.insertCell(colNum);
    myCell.className = "list_td";

    var mcode = document.createElement( 'select' );
	mcode.setAttribute('class', 'col_ddlb');
    mcode.name = 'acct_type';
    mcode.value ='';
	mcode.innerHTML=document.getElementById('h_acct_type').value;
    myCell.appendChild(mcode);
 
   //======================================  
    
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
    
    
    var mo1 = document.createElement( 'input' );
	mo1.setAttribute('class', 'col_text');
    mo1.type = 'text';
    mo1.name = 'id';
    mo1.zEdit='any';
	mo1.maxLength=10;
	mo1.size=10;
    mo1.value = '';
    myCell.appendChild(mo1);
	
    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
    
    

    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
    
    
   	
    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
    
    
	
    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
    
    
    var cno = document.createElement( 'input' );
	cno.setAttribute('class', 'col_text');
    cno.type = 'text';
    cno.name = 'corp_no';
    cno.zEdit='number';
	cno.maxLength=8;
	cno.size=8;
    cno.value = '';
    myCell.appendChild(cno);	

    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";

    //======================================   

    colNum++;
	myCell = myRow.insertCell(colNum);
    myCell.className = "list_td";

    var addi = document.createElement( 'select' );
	addi.setAttribute('class', 'col_ddlb');
    addi.name = 'add_item';
    addi.value ='';
	addi.innerHTML=document.getElementById('h_add_item').value;
    myCell.appendChild(addi); 

    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
    
    
    var crd = document.createElement( 'input' );
	crd.setAttribute('class', 'col_text');
    crd.type = 'text';
    crd.name = 'card_no';
    crd.zEdit='number';
	crd.maxLength=19;
	crd.size=19;
    crd.value = '';
    myCell.appendChild(crd);	

   //======================================   

    colNum++;
	myCell = myRow.insertCell(colNum);
    myCell.className = "list_td";

    var curr = document.createElement( 'select' );
	curr.setAttribute('class', 'col_ddlb');
    curr.name = 'curr_code';
    curr.value ='';
	curr.innerHTML=document.getElementById('h_curr_code').value;
    myCell.appendChild(curr); 

    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
    
    
    var dcamt = document.createElement( 'input' );
	dcamt.setAttribute('class', 'col_number');
    dcamt.type = 'text';
    dcamt.name = 'dc_dest_amt';
    dcamt.zEdit='dignumber';
	dcamt.maxLength=12;
	dcamt.size=12;
    dcamt.value = '';
    myCell.appendChild(dcamt);

    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
    
    
    var da = document.createElement( 'input' );
	da.setAttribute('class', 'col_number');
    da.type = 'text';
    da.name = 'dest_amt';
    da.zEdit='dignumber';
	da.maxLength=12;
	da.size=12;
    da.value = '';
    myCell.appendChild(da);

    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
    
    
    var pur = document.createElement( 'input' );
	pur.setAttribute('class', 'col_text');
    pur.type = 'text';
    pur.name = 'purchase_date';
    pur.zEdit='number';
	pur.maxLength=8;
	pur.size=8;
    pur.value = '';
    myCell.appendChild(pur);	

    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
    
    //======================================   
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_td";
    var dbcrarray = ["","收回誤入　貴戶之繳款","其他費用"];

    var bill_desc = document.createElement('select');
    bill_desc.setAttribute('class', 'col_ddlb');
    bill_desc.name = 'bill_desc';
    bill_desc.value = '';
    for (var i = 0; i < dbcrarray.length; i++) {
        var option = document.createElement("option");
        option.value = dbcrarray[i];
        if (dbcrarray[i] == "") {
            option.text = "--";
        } else if (dbcrarray[i] == "收回誤入　貴戶之繳款") {
            option.text = "收回誤入　貴戶之繳款";
        }else if (dbcrarray[i] == "其他費用") {
            option.text = "其他費用";
        }
        bill_desc.appendChild(option);
    }
    myCell.appendChild(bill_desc);

    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";

    //======================================
    colNum++;
    myCell = myRow.insertCell(colNum);
    myCell.className = "list_ll";
 
  
}	


</script>
<body background="${water_mark}" >
<form  name="dataForm" method="post" action="" >
<div id="condBlock">
<!--COND -->
<table width="40%" border="0" cellspacing="0" cellpadding="4">
    <tr>
        <td nowrap>&nbsp;登入批號:	 
            <input type="text" class="col_text" name="ex_key" value="${ex_key}" zEdit="number" maxlength=4 size=4  zRequire ="k"/>
        </td>
        <td nowrap>&nbsp;登入人員:	 
            <input type="text" class="col_text" name="ex_user" value="${ex_user}" zEdit="any" maxlength=10 size=10 />
        </td>
        <td nowrap>&nbsp;雙幣幣別:
          	<select  name="ex_curr_code" class="col_ddlb" >
            	${dddw_curr_code}
          	</select>   
      	</td>
    </tr>
  	<tr>
        <td nowrap>&nbsp;正卡身分證號:	 
            <input type="text" class="col_text" name="ex_id" value="${ex_id}" zEdit="any" maxlength=10 size=10 />
        </td>
        <td nowrapcolspan="2">&nbsp;卡號:	 
            <input type="text" class="col_text" name="ex_card" value="${ex_card}" zEdit="number" maxlength=19 size=19 />
        </td>
  	</tr>
  	<tr>
    	<td nowrap colspan="3">&nbsp;  
      		<input type="Button"  value="查詢" onClick="return top.submitControl('Q')" class="btQuery" >&nbsp;&nbsp;
      		<input type="Button"   value="清除" onClick="return top.submitControl('L')" class="btClear" >&nbsp;&nbsp;
      		<input type="Button"     value="存檔"  ${btnSelect_disable} onClick="return top.submitControl('S2')" class="btAdd" >&nbsp;&nbsp;
    	</td>   
  	</tr>
</table>
</div>
<hr>
<table border="0" width="5%">
  	<tr>
    	<td align="right">
      		<input type="Button"   value="新增明細" ${btnSelect_disable} onclick="wf_add_newrow()" class="btAdd_detl" />&nbsp;
    	</td>
  	</tr>
</table>
<!--List -->
<table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
  	<tr>
    	<th nowrap class="list_th" width="5%">
      		<input type="checkbox" name="ex_selectAll" value="Y" onChange="selectAll();" >刪除&nbsp;</th>
    	<th nowrap class="list_th">帳戶<br>類別</th>
    	<th nowrap class="list_th">正卡<br>身分證號</th>
    	<th nowrap class="list_th">帳戶狀態</th>
    	<th nowrap class="list_th">結清戶</th>
    	<th nowrap class="list_th">中文姓名</th>
    	<th nowrap class="list_th">法人<br>統編</th>
    	<th nowrap class="list_th">公司簡稱</th>
    	<th nowrap class="list_th">加檔項目</th>
    	<th nowrap class="list_th">加檔卡號</th>
    	<th nowrap class="list_th">結算<br>幣別</th>
    	<th nowrap class="list_th">結算金額</th>
    	<th nowrap class="list_th">金額<br>(台幣)</th>
    	<th nowrap class="list_th">消費日期</th> 
    	<th nowrap class="list_th">帳上餘額<br>(結算幣別)</th> 
    	<th nowrap class="list_th">對帳單文字</th> 
    	<th nowrap class="list_th">覆核人員</th> 
    	<th nowrap class="list_th">登入人員</th> 
  	</tr>
<!-- BEGIN DYNAMIC : DETAIL -->
  	<tr>
   		<td nowrap class="list_no" >
	  		<span class="dsp_flag">${ok_flag}</span>
        	${SER_NUM}
      		<input type="checkbox" name="opt" value="${ser_num}">
      		<input type="hidden" name="ser_num" value="${ser_num}">
      		<input type="hidden" name="rowid" value="${rowid}"/>
		    <input type="hidden" name="mod_seqno" value="${mod_seqno}"/>
   		</td>
        <td nowrap class="list_td">
          	<select name="acct_type" class="col_ddlb">
           		${dddw_acct_type}
          	</select>    
      	</td>
      	<td nowrap class="list_ll"> 
       		<input type="text" class="col_text" name="id" value="${id}" zEdit="any"  maxlength="10" size="10" />
     	</td>
      	<td nowrap class="list_ll"> ${db_status} </td>
      	<td nowrap class="list_ll"> ${db_end} </td>
      	<td nowrap class="list_ll"> ${db_name} </td>
        <td nowrap class="list_ll"> 
       		<input type="text" class="col_text" name="corp_no" value="${corp_no}" zEdit="number"  maxlength="8" size="8" />
     	</td>
        <td nowrap class="list_ll"> ${db_comp_brief}</td>
        <td nowrap class="list_td">
           	<select name="add_item" class="col_ddlb">
           		${dddw_add_item}
          	</select>   
      	</td>
    	<td nowrap class="list_ll"> 
       		<input type="text" class="col_text" name="card_no" value="${card_no}" zEdit="number"  maxlength="19" size="19" />
     	</td>
        <td nowrap class="list_td">
           	<select name="curr_code" class="col_ddlb">
           		${dddw_curr_code}
          	</select>   
      	</td>
      	<td nowrap class="list_rr"> 
       		<input type="text" class="col_number" name="dc_dest_amt" value="${dc_dest_amt}" zEdit="dignumber"  maxlength="12" size="12" />
     	</td>
        <td nowrap class="list_rr"> 
       		<input type="text" class="col_number" name="dest_amt" value="${dest_amt}" zEdit="dignumber"  maxlength="12" size="12" />
     	</td>
     	<td nowrap class="list_ll"> 
       		<input type="text" class="col_text" name="purchase_date" value="${purchase_date}" zEdit="number"  maxlength="8" size="8" />
     	</td>
     	<td nowrap class="list_ll"> ${dc_acct_jrnl_bal} </td>
        <td nowrap class="list_td">
          	<select  name="bill_desc" class="col_ddlb">
             	<option value="">--</option>
             	<option value="收回誤入　貴戶之繳款" ${bill_desc-收回誤入　貴戶之繳款} >收回誤入　貴戶之繳款</option>
			    <option value="其他費用" ${bill_desc-其他費用} >其他費用</option>
		    </select>
      	</td>
      	<td nowrap class="list_ll"> ${apr_user}</td>
      	<td nowrap class="list_ll"> ${mod_user}</td>
      	<input type="hidden" name="db_status" value="${db_status}"/>
      	<input type="hidden" name="db_end" value="${db_end}"/>
        <input type="hidden" name="db_name" value="${db_name}"/>
        <input type="hidden" name="db_comp_brief" value="${db_comp_brief}"/>
        <input type="hidden" name="dc_acct_jrnl_bal" value="${dc_acct_jrnl_bal}"/>
        <input type="hidden" name="apr_user" value="${apr_user}"/>
        <input type="hidden" name="mod_user" value="${mod_user}"/>
        <input type="hidden" name="post_flag" value="${post_flag}"/>
  	</tr>
<!-- END DYNAMIC : DETAIL -->
</table>
<input type="hidden"  name="data_k1" value="" >
<input type="hidden"  name="data_k2" value="" >
<input type="hidden"  name="data_k3" value="" >
<input type="hidden"  name="HIDE"  value="${HIDE_DATA}">
<input type="hidden"  name="pageType"  value="cond">
<input type="hidden" name="MOD_PGM" value="bilm0212">
<input type="hidden"  name="h_acct_type" id ="h_acct_type" value="${dddw_acct_type_h}">
<input type="hidden"  name="h_curr_code" id ="h_curr_code" value="${dddw_curr_code_h}">
<input type="hidden"  name="h_add_item" id ="h_add_item" value="${dddw_add_item_h}">
</form>
</body>
</html>

<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
	tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>

<script language="javascript">
top.refreshButton2('0');
top.pageRows="9999";

function validateInput()
{
    if ( !top.checkFormat() )
        { return false; }
    if ( top.actionCode == "X" ) {
        top.respLevel = 1;
        top.respHtml = "bilm0212_detl";
    }
    return true;
}

function detailScreen(serNum,parm,parm2,parm3) { 
    top.respLevel = 1;
    top.currRows  = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    top.respHtml  = "bilm0212_detl";
    top.submitControl('S');
    return true;
}
</script>
