<!--**************************************************************************-->
<!--                                                                          -->
<!--                              MODIFICATION LOG                            -->
<!--                                                                          -->
<!--    DATE    VERSION     AUTHOR                 DESCRIPTION                -->
<!-- ---------  --------  -----------    ------------------------------------ -->
<!--            V1.00.00                 initial                              -->     
<!-- 109-10-07  V1.00.01    JustinWu     add 團體代號+MCC CODE的按鈕           -->                                
<!--**************************************************************************-->
<html>
<head>
<title>卡友權益資格參數維護-01</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
</head>
<script language="JavaScript" src="js/jquery.js"></script>

<body background="${water_mark}" >
<form name="dataForm"  method="post" action="">

<table border="0" cellpadding="0" cellspacing="0" style="margin-bottom:10px;">
<tr>
 <td width="100">&nbsp;</td>
 <td>
  <img height="30" src="images/upperLevel.gif" style="cursor:hand;" onClick="return top.upperLevel()"; >&nbsp;
  <input type="Button"     value="讀取" onClick="return top.submitControl('R2')" class="btQuery" >&nbsp;&nbsp;
  <input type="Button"    value="存檔" ${btnUpdate_off} onClick="return top.submitControl('U2')" class="btUpdate" >&nbsp;&nbsp;
  </td>
</tr>
</table>

<div id="dataBlock">
<table width="60%" border="0" cellspacing="0" cellpadding="4">
  <tr>
   <td nowrap >權益代碼:
		<span class="col_key">${item_no}&nbsp;${tt_item_no}</span>
    	<input type=hidden name="item_no" value="${item_no}" />
    	<input type=hidden name="tt_item_no" value="${tt_item_no}" />
   </td>
   <td nowrap >專案代號:
   		<span class="col_key">${proj_code}</span>
    	<input type=hidden name="proj_code" value="${proj_code}">
  </tr>
  <tr>
   <td nowrap>參數類別:
      <span class="dsp_text">帳戶類別</span>
      <input type="hidden" name="data_type" value="01" />
   </td>
   <td nowrap >已覆核:
      <span class="col_key">${apr_flag}&nbsp;</span>
      <input type="hidden" name="apr_flag" value="${apr_flag}">
   </td>
  </tr>
  <tr>
   <td nowrap colspan="2" >
      <input type="Button"  value="01.帳戶類別" onclick="wf_detl_2page('01');" disabled />
      <input type="Button"  value="02.團體代號+卡種" onclick="wf_detl_2page('02');" class="btAdd_detl" />
      <input type="Button"  value="03.團體代號+卡種" onclick="wf_detl_2page('03');" class="btAdd_detl" />
      <input type="Button"  value="05.團體代號" onclick="wf_detl_2page('05');" class="btAdd_detl" />
      <input type="Button"  value="06.團體代號+MCC CODE" onclick="wf_detl_2page('06');" class="btAdd_detl" />
      <br>
      <!--  
      <input type="Button"  value="07.團體代號+MCC CODE" onclick="wf_detl_2page('07');" class="btAdd_detl" />
      <input type="Button"  value="08.團體代號+MCC CODE" onclick="wf_detl_2page('08');" class="btAdd_detl" />
      -->
   </td>
  </tr>
</table>
<table width="60%" border="0" cellspacing="0" cellpadding="4">
  <tr>
   <td nowrap >帳戶類別：
     <select size=1 name="ex_data_code" class="col_ddlb">
       <option value="">--</option>
       ${dddw_acct_type}
     </select>
     &nbsp;
     <input type="Button"  value="新增明細" ${btnUpdate_off} onClick="wf_insert()" class="btAdd_detl" />&nbsp;&nbsp;
    <input type="text" id="err_msg" class="dsp_text" style="color: red" value="" disabled />
   </td>
  </tr>
</table>
<hr>
 <table width="60%" id="table1" class="sortable" border="0" >
  <tr>
    <th nowrap class="list_cc" width="5%">刪除 </th>
    <th nowrap class="list_cc">帳戶名稱</th>
  </tr>
  <!-- BEGIN DYNAMIC : DETAIL -->
  <tr>
    <td nowrap class="list_no">
      <span class="dsp_flag"></span>
    	<input type="checkbox" name="opt" value="${ser_num}">
      ${SER_NUM}
      <input type="hidden" name="ser_num" value="${ser_num}">
      <input type="hidden" name="data_code" value="${data_code}">
      <input type="hidden" name="tt_data_code" value="${tt_data_code}">
    </td>
    <td nowrap class="list_ll">${data_code}&nbsp;${tt_data_code} </td>
  </tr>
  <!-- END DYNAMIC : DETAIL -->
</table>

<!--hidden -->
<input type=hidden name="data_k1" value="${item_no}" />
<input type=hidden name="data_k2" value="${proj_code}" />
<input type=hidden name="data_k3" value="01" />
<!-- -->
<input type="hidden" name="ROWID" value="${rowid}" />
<input type="hidden" name="MOD_SEQNO" value="${mod_seqno}" />
<input type="hidden" name="HIDE" value="${HIDE_DATA}" />
<input type="hidden" name="pageType" value="" />

</form>
</body>
</html>

<script language="JavaScript" src="js/AJAXFunction_20.js"></script>
<script language="javascript">

 top.refreshButton2('2');
 top.pageRows ="9999";

 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }

   return true;
  }

	function wf_detl_2page(parm) {

	 	if (parm==="01") {
		top.respHtml  = "cmsm4210_detl_01";
	 }
	 else if (parm==="02") {
		top.respHtml  = "cmsm4210_detl_02";
	 }
	 else if (parm=="03") {
		top.respHtml  = "cmsm4210_detl_03";
	 }
	 else if (parm=="05") {
		top.respHtml  = "cmsm4210_detl_05";
	 }
	 else if (parm=="06") {
		top.respHtml  = "cmsm4210_detl_06";
	 }
   else if (parm=="07") {
    top.respHtml  = "cmsm4210_detl_07";
   }
   else if (parm=="08") {
    top.respHtml  = "cmsm4210_detl_08";
   }

    top.respLevel = 2;
	  document.dataForm.data_k3.value = parm;
    top.submitControl("S2");
    return true;
 }

 function wf_insert() {
   $("#err_msg").val("");

    var ls_item_no =$("input[name=item_no]").val();
    var ls_proj_code =$("input[name=proj_code]").val();
    var ls_data_type =$("input[name=data_type]").val();
    var ls_code =$("select[name=ex_data_code]").val();
    // var ls_code2 =$("input[name=ex_data_code2]").val();
    // alert("code="+ls_code+", code2="+ls_code2);

    // top.actionCode ="Q";
    // top.methodName ="wf_insert";

    resetJSON();
    addJSON("item_no", ls_item_no);
    addJSON("proj_code", ls_proj_code);
    addJSON("data_type", ls_data_type);
    addJSON("apr_flag", "N");
    addJSON("ex_data_code", ls_code);
    // addJSON("ex_data_code2", ls_code2);
    //alert("item="+ls_item_no+", proj="+ls_proj_code+", type="+ls_data_type);

    processAJAX();
}

function ajaxResponse(){
    top.respHtml ="cmsm4210_detl_01";
    top.requHtml ="cmsm4210_detl_01";

    var li_rc =getJSONvalue("ax_rc",0);
    var ls_msg =getJSONvalue("ax_msg",0);
    if (li_rc != 1) {
      $("#err_msg").val(ls_msg);
      alert("新增失敗: "+ls_msg);
    }
    else {
      $("#err_msg").val("新增成功");
      alert("新增成功");
    }
    return false;
}

</script>
