<html>
<head>
<title>DeBit帳務明細D檔調整覆核作業-107-07-31-V1.00.00-phopho-[Initial]</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
</head>

<body background="${water_mark}" >
<form  name="dataForm" method="post" action="" >

<div id="condBlock">
<!--COND -->
<table width="60%" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <td nowrap colspan="3">&nbsp;  
      <input type="Button" value="查詢" onClick="return top.submitControl('Q')" class="btQuery" >&nbsp;&nbsp;
      <input type="Button" value="清除" onClick="return top.submitControl('L')" class="btClear" >&nbsp;&nbsp;
      <input type="Button" value="執行" onClick="return top.submitControl('C')" class="btAdd" >&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td nowrap>&nbsp;帳戶帳號：
      <select size="1" name="exAcctType" class="col_ddlb">${DbpAcctTypeList}</select>
      <input type="text" class="col_text" name="exAcctKey" value="${exAcctKey}" maxlength="11" size="13"/>
    </td>
    <td nowrap>
      <span class="col_radio">
        <input type="radio" value="1" name="exAprFlag" ${exAprFlag-1} checked/>未放行&nbsp;
        <input type="radio" value="2" name="exAprFlag" ${exAprFlag-2} />已放行&nbsp;
      </span>
    </td>
    <td nowrap>&nbsp;登錄人員：
      <select size="1" name="exCrtUser" class="col_ddlb">${SecUserIDNameList}</select>
    </td>
  </tr>
</table>
</div>
<hr>

<!--List -->
 <table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap class="list_th" width="5%">
      <input type="checkbox" name="ex_selectAll" value="Y" onChange="selectAll();" >執行&nbsp;</th>
    <th nowrap class="list_th">待放行<br>解放行</th>
    <th nowrap class="list_th">卡別</th>
    <th nowrap class="list_th">帳戶帳號</th>
    <th nowrap class="list_th">中文姓名</th>
    <th nowrap class="list_th">科目<br>代號</th>
    <th nowrap class="list_th">消費日期</th>
    <th nowrap class="list_th">借方金額</th>
    <th nowrap class="list_th">貸方金額</th>
    <th nowrap class="list_th">正卡ID</th>
    <th nowrap class="list_th">科目名稱</th>
    <th nowrap class="list_th">借貸方科目</th>
    <th nowrap class="list_th">入帳日</th>
    <th nowrap class="list_th">銷帳鍵值</th>
    <th nowrap class="list_th">利息指示碼</th>
    <th nowrap class="list_th">原始金額</th>
    <th nowrap class="list_th">目前餘額</th>
    <th nowrap class="list_th">最新金額</th>
    <th nowrap class="list_th">目前可D數</th>
    <th nowrap class="list_th">最新可D數</th>
    <th nowrap class="list_th">交易參考號</th>
    <th nowrap class="list_th">調整類別</th>
    <th nowrap class="list_th">卡號</th>
    <th nowrap class="list_th">調整原因</th>
    <th nowrap class="list_th">調整備註</th>
    <th nowrap class="list_th">修改人員</th>
    <th nowrap class="list_th">覆核人員</th>
    <th nowrap class="list_th">覆核日期</th>
  </tr>
  <!-- BEGIN DYNAMIC : DETAIL -->
  <tr >
   <td nowrap class="list_no">
	<span class="col_key">${ok_flag}</span>
	<input type="checkbox" name="opt" value="${ser_num}" ${opt_disabled}/>
 	 ${SER_NUM}&nbsp;
	<input type="hidden" name="ser_num" value="${ser_num}" />
	<input type="hidden" name="rowid" value="${rowid}">
	<input type="hidden" name="mod_seqno" value="${mod_seqno}">
	<input type="hidden" name="apr_flag" value="${apr_flag}">
	<input type="hidden" name="tt_apr_flag" value="${tt_apr_flag}">
	<input type="hidden" name="acct_type" value="${acct_type}">
	<input type="hidden" name="acct_key" value="${acct_key}">
	<input type="hidden" name="chi_name" value="${chi_name}">
	<input type="hidden" name="acct_code" value="${acct_code}">
	<input type="hidden" name="purchase_date" value="${purchase_date}">
	<input type="hidden" name="dr_amt" value="${dr_amt}">
	<input type="hidden" name="cr_amt" value="${cr_amt}">
	<input type="hidden" name="id_no" value="${id_no}">
	<input type="hidden" name="id_code" value="${id_code}">
	<input type="hidden" name="debt_chi" value="${debt_chi}">
	<input type="hidden" name="debit_item" value="${debit_item}">
	<input type="hidden" name="post_date" value="${post_date}">
	<input type="hidden" name="c_debt_key" value="${c_debt_key}">
	<input type="hidden" name="value_type" value="${value_type}">
	<input type="hidden" name="tt_value_type" value="${tt_value_type}">
	<input type="hidden" name="orginal_amt" value="${orginal_amt}">
	<input type="hidden" name="bef_amt" value="${bef_amt}">
	<input type="hidden" name="aft_amt" value="${aft_amt}">
	<input type="hidden" name="bef_d_amt" value="${bef_d_amt}">
	<input type="hidden" name="aft_d_amt" value="${aft_d_amt}">
	<input type="hidden" name="reference_no" value="${reference_no}">
	<input type="hidden" name="adjust_type" value="${adjust_type}">
	<input type="hidden" name="card_no" value="${card_no}">
	<input type="hidden" name="adj_reason_code" value="${adj_reason_code}">
	<input type="hidden" name="adj_comment" value="${adj_comment}">
	<input type="hidden" name="chg_user" value="${chg_user}">
	<input type="hidden" name="apr_user" value="${apr_user}">
	<input type="hidden" name="apr_date" value="${apr_date}">
	<input type="hidden" name="opt_disabled" value="${opt_disabled}" />
   </td>
   <td nowrap class="list_cc"> ${tt_apr_flag}&nbsp;</td>
   <td nowrap class="list_cc"> ${acct_type}&nbsp;</td>
   <td nowrap class="list_cc"> ${acct_key}&nbsp;</td>
   <td nowrap class="list_ll"> ${chi_name}&nbsp;</td>
   <td nowrap class="list_cc"> ${acct_code}&nbsp;</td>
   <td nowrap class="list_cc"> ${purchase_date.YMD}&nbsp;</td>
   <td nowrap class="list_rr"> ${dr_amt.(999)}&nbsp;</td>
   <td nowrap class="list_rr"> ${cr_amt.(999)}&nbsp;</td>
   <td nowrap class="list_ll"> ${id_no}-${id_code}&nbsp;</td>
   <td nowrap class="list_ll"> ${debt_chi}&nbsp;</td>
   <td nowrap class="list_cc"> ${debit_item}&nbsp;</td>
   <td nowrap class="list_cc"> ${post_date.YMD}&nbsp;</td>
   <td nowrap class="list_ll"> ${c_debt_key}&nbsp;</td>
   <td nowrap class="list_ll"> ${tt_value_type}&nbsp;</td>
   <td nowrap class="list_rr"> ${orginal_amt.(999)}&nbsp;</td>
   <td nowrap class="list_rr"> ${bef_amt.(999)}&nbsp;</td>
   <td nowrap class="list_rr"> ${aft_amt.(999)}&nbsp;</td>
   <td nowrap class="list_rr"> ${bef_d_amt.(999)}&nbsp;</td>
   <td nowrap class="list_rr"> ${aft_d_amt.(999)}&nbsp;</td>
   <td nowrap class="list_ll"> ${reference_no}&nbsp;</td>
   <td nowrap class="list_cc"> ${adjust_type}&nbsp;</td>
   <td nowrap class="list_ll"> ${card_no}&nbsp;</td>
   <td nowrap class="list_ll"> ${adj_reason_code}&nbsp;</td>
   <td nowrap class="list_ll"> ${adj_comment}&nbsp;</td>
   <td nowrap class="list_ll"> ${chg_user}&nbsp;</td>
   <td nowrap class="list_ll"> ${apr_user}&nbsp;</td>
   <td nowrap class="list_cc"> ${apr_date.YMD}&nbsp;</td>
  </tr>
  <!-- END DYNAMIC : DETAIL -->
 </table>
    
 <input type="hidden"  name="data_k1" value="" >
 <input type="hidden"  name="data_k2" value="" >
 <input type="hidden"  name="data_k3" value="" >

 <input type="hidden"  name="MOD_PGM" value="dbap0030">
 <input type="hidden"  name="HIDE"  value="${HIDE_DATA}">
 <input type="hidden"  name="pageType"  value="cond">

</form>
</body>
</html>

<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
	tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>

<script language="javascript">

 top.refreshButton2('0');
 //top.pageRows="999";
 
 document.dataForm.exAcctKey.focus();
 //document.dataForm.ex_selectAll.checked=true;
 //selectAll();

 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }

    if ( top.actionCode == "C" ) {
    	if ( !chkdata() ) { 
    		return false; 
    	} 
    	if (confirm("是否執行科目明細調整放行/解放行 !") === false) {
            return false;
        } 
    }
    return true;
  }

 function selectAll() {
	var aElements = document.dataForm.getElementsByTagName("input");
	for ( var i=0;  i < aElements.length; i++ ) {
		if  ( aElements[i].type == "checkbox" && aElements[i].disabled == false) {
			aElements[i].checked = document.dataForm.ex_selectAll.checked;
		}
	}
	
	return;
 }
 
 function chkdata() {
	 var seq = 0;
	 var agy = document.getElementsByName('opt');
	 var ll = agy.length;
	 if (typeof ll === 'undefined') {
		 if (agy.checked){ seq++; }
	 }else{
		 for ( var i=0; i < ll; i++ ) {
			 if(agy[i].checked){
				 seq++;
			 }
		 }
	 }
	 
	 if(seq == 0){
		 alert("未選取覆核資料!");
		 return false;
 	 }
	 return true;
 }
 
</script>
