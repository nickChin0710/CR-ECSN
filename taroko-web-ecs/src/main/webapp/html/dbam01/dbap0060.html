<html>
<head>
<title>VD線上解圈-2022-03-22</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
<link rel="stylesheet" href="js/Calendar/calendar.css">
</head>
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>

<body background="${water_mark}" >
<form  name="dataForm" method="post" action="" >

<div id="condBlock">
<table width="60%" border="0" cellspacing="0" cellpadding="4">
  <tr>    
    <td nowrap>
      <span class="col_radio">
         <input type="radio" value="00" id="ex_iso_resp_code_success" name="ex_iso_resp_code" ${ex_iso_resp_code-00} ${DEFAULT_CHK} />交易成功
         <input type="radio" value="11" id="ex_iso_resp_code_fail" name="ex_iso_resp_code" ${ex_iso_resp_code-11} />交易失敗
      </span>
   </td>
   <td nowrap>&nbsp;  
      <input type="Button" name="btnQuery" value="查詢" onClick="return top.submitControl('Q')" class="btQuery" >&nbsp;&nbsp;
      <input type="Button" name="btnClear" value="清除" onClick="return top.submitControl('L')" class="btClear" >&nbsp;&nbsp;      
      <input type="Button" name="btnProcQuery" value="執行解圈 (送主機)" onClick="return top.submitControl('C')" class="btProcess" >&nbsp;&nbsp;
      <input type="Button" name="btnProcQuery2" value="執行解圈 (不送主機)" onClick="return top.submitControl('C2')" class="btProcess" >&nbsp;&nbsp;
   </td>   
  </tr>
  <tr>
    <td nowrap colspan="2">&nbsp;交易時間:
        <input type="text" class="col_date" id="ex_date1" name="ex_date1" value="${ex_date1}" zEdit="date,yyyymmdd" MaxLength=8 size=10 />
        <script language="JavaScript">
            new tcal ({'formname': 'dataForm','controlname': 'ex_date1'});
        </script>
      --
      <input type="text" class="col_date" id="ex_date2" name="ex_date2" value="${ex_date2}" zEdit="date,yyyymmdd" MaxLength=8 size=10 />
      <script language="JavaScript">
        new tcal ({'formname': 'dataForm','controlname': 'ex_date2'});
      </script>
    </td>
  </tr>
  <tr>
   <td nowrap >&nbsp;卡號:
      <input type="text" class="col_text" id="ex_card_no" name="ex_card_no" value="${ex_card_no}" maxlength="16" size="18" zEdit="number" />
   </td>
   <td nowrap >&nbsp;身分證:
      <input type="text" class="col_text" name="ex_idno" value="${ex_idno}" maxlength="10" size="12" zEdit="alphanum,upper" />
   </td>    
  </tr>
 </table>
</div>
<hr>

 <table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
 <tr>
    <th nowrap class="list_th" width="10%"> 
	 <input type="checkbox" name="ex_selectAll" value="Y" onClick="selectAll();" >解圈
	</th>
    <th nowrap>卡號 </th>
    <th nowrap>有效日期 </th>
    <th nowrap>消費日期_時間 </th>
    <th nowrap>特店代碼 </th>
    <th nowrap>特店名稱 </th>
    <th nowrap>MCC </th>
    <th nowrap>Entry Mody </th>
    <th nowrap>Entry Mode類別 </th>
    <th nowrap>型態</th>
    <th nowrap>台幣金額 </th>
    <th nowrap>實際圈存金額 </th>
    <th nowrap>國家 </th>
    <th nowrap>幣別 </th>
    <th nowrap>回覆碼 </th>
    <th nowrap>授權碼 </th>
    <th nowrap>授權人員 </th>
    <th nowrap>VIP </th>
    <th nowrap>姓名 </th>
    <th nowrap>收單行 </th>
    <th nowrap>等級 </th>
    <th nowrap>授權單位 </th>
    <th nowrap>狀況說明 </th>
    <th nowrap>當時OTB </th>
    <th nowrap>當時額度 </th>
    <th nowrap>標準額度 </th>
    <th nowrap>fall back </th>
    <th nowrap colspan="2">IBM </th>
    <th nowrap>EC </th>
    <th nowrap>UCAF </th>
    <th nowrap>圈存序號</th>
    <th nowrap>授權留言 </th>
  </tr>
  <!-- BEGIN DYNAMIC : DETAIL -->
  <tr>
    <td nowrap class="list_no">
		<span class="dsp_flag">${ok_flag}</span>
   		<input type="checkbox" name="opt" value="${ser_num}" ${opt_on} />${SER_NUM}&nbsp;
    	<input type="hidden" name="ser_num" value="${ser_num}" />
    	<input type="hidden" name="rowid" value="${rowid}" />
    	<input type="hidden" name="new_end_date" value="${new_end_date}" />
    	<input type="hidden" name="acct_no" value="${acct_no}" />
    	<input type="hidden" name="ori_amt" value="${ori_amt}" />
    	<input type="hidden" name="trace_no" value="${trace_no}" />
    	<input type="hidden" name="ref_no" value="${ref_no}" />
    	<input type="hidden" name="card_no" value="${card_no}" />
    	<input type="hidden" name="tx_date" value="${tx_date}" />
    	<input type="hidden" name="tx_time" value="${tx_time}" />
    	<input type="hidden" name="v_card_no" value="${v_card_no}" />    	
    	<input type="hidden" name="corp_no" value="${corp_no}" />    
    	<input type="hidden" name="card_ref_num" value="${card_ref_num}" />	
    	<input type="hidden" name="card_acct_idx" value="${card_acct_idx}" />
    	<input type="hidden" name="acno_p_seqno" value="${acno_p_seqno}" />
    </td>
    <td nowrap class="list_cc">${card_no}</td>
    <td nowrap class="list_cc">${eff_date_end.YMD}
    	<input type="hidden" name="eff_date_end" value="${eff_date_end}" />
    </td>
    <td nowrap class="list_cc">${tx_date.YMD}&nbsp;${tx_time.TIME}</td>
    <td nowrap class="list_cc">${mcht_no}
    	<input type="hidden" name="mcht_no" value="${mcht_no}" />
    </td>    	   	
    <td nowrap class="list_cc">${mcht_name}
    	<input type="hidden" name="mcht_name" value="${mcht_name}" />
    </td>
    <td nowrap class="list_cc">${mcc_code}
    	<input type="hidden" name="mcc_code" value="${mcc_code}" />
    </td>
    <td nowrap class="list_cc">${pos_mode_1_2}
    	<input type="hidden" name="pos_mode_1_2" value="${pos_mode_1_2}" />
    </td>
    <td nowrap class="list_cc">${db_entry_mode_type}
    	<input type="hidden" name="db_entry_mode_type" value="${db_entry_mode_type}" />    	
    </td>
    <td nowrap class="list_cc">${tt_online_redeem}
    	<input type="hidden" name="tt_online_redeem" value="${tt_online_redeem}" />    	
    </td>
    <td nowrap class="list_rr">${nt_amt.(999)}
    	<input type="hidden" name="nt_amt" value="${nt_amt}" />
    </td>
    <td nowrap class="list_rr">${vd_lock_nt_amt.(999)}
    	<input type="hidden" name="vd_lock_nt_amt" value="${vd_lock_nt_amt}" />
    </td>
    <td nowrap class="list_cc">${consume_country}
    	<input type="hidden" name="consume_country" value="${consume_country}" />
    </td>
    <td nowrap class="list_cc">${tx_currency}
    	<input type="hidden" name="tx_currency" value="${tx_currency}" />
    </td>
    <td nowrap class="list_cc">${iso_resp_code}-${auth_status_code}-${iso_adj_code}
    	<input type="hidden" name="iso_resp_code" value="${iso_resp_code}" />
    	<input type="hidden" name="auth_status_code" value="${auth_status_code}" />
    	<input type="hidden" name="iso_adj_code" value="${iso_adj_code}" />
    </td>
    <td nowrap class="list_cc">${auth_no}
    	<input type="hidden" name="auth_no" value="${auth_no}" />
    </td>
    <td nowrap class="list_cc">${auth_user}
    	<input type="hidden" name="auth_user" value="${auth_user}" />
    </td>
    <td nowrap class="list_cc">${vip_code}
    	<input type="hidden" name="vip_code" value="${vip_code}" />
    </td>
    <td nowrap class="list_cc">${db_idno_name}
    	<input type="hidden" name="db_idno_name" value="${db_idno_name}" />
    </td>
    <td nowrap class="list_cc">${stand_in}
    	<input type="hidden" name="stand_in" value="${stand_in}" />
    </td>
    <td nowrap class="list_cc">${class_code}
    	<input type="hidden" name="class_code" value="${class_code}" />
    </td>
    <td nowrap class="list_cc">${tt_auth_unit}
    	<input type="hidden" name="tt_auth_unit" value="${tt_auth_unit}" />
    </td>
    <td nowrap class="list_cc">${logic_del}.${tt_logic_del}
    	<input type="hidden" name="logic_del" value="${logic_del}" />
    	<input type="hidden" name="tt_logic_del" value="${tt_logic_del}" />
    </td>
    <td nowrap class="list_rr">${curr_otb_amt.(999)}
    	<input type="hidden" name="curr_otb_amt" value="${curr_otb_amt}" />
    </td>
    <td nowrap class="list_cc">${curr_tot_lmt_amt.(999)}
    	<input type="hidden" name="curr_tot_lmt_amt" value="${curr_tot_lmt_amt}" />
    </td>
    <td nowrap class="list_cc">${curr_tot_std_amt.(999)}
    	<input type="hidden" name="curr_tot_std_amt" value="${curr_tot_std_amt}" />
    </td>
    <td nowrap class="list_cc">${fallback}
    	<input type="hidden" name="fallback" value="${fallback}" />
    </td>
    <td nowrap class="list_cc">${ibm_bit39_code}
    	<input type="hidden" name="ibm_bit39_code" value="${ibm_bit39_code}" />
    </td>
    <td nowrap class="list_cc">${ibm_bit33_code}
    	<input type="hidden" name="ibm_bit33_code" value="${ibm_bit33_code}" />
    </td>
    <td nowrap class="list_cc">${ec_flag}
    	<input type="hidden" name="ec_flag" value="${ec_flag}" />
    </td>
    <td nowrap class="list_cc">${ucaf}
    	<input type="hidden" name="ucaf" value="${ucaf}" />
    </td>
    <td nowrap class="list_cc">${tx_seq}
    	<input type="hidden" name="tx_seq" value="${tx_seq}" />
    </td>
    <td nowrap class="list_cc">${auth_remark}
 		<input type="hidden" name="auth_remark" value="${auth_remark}" />   
    </td>
    </tr>
  <!-- END DYNAMIC : DETAIL -->
 </table>
    
 <input type="hidden"  name="data_k1" value="" >
 <input type="hidden"  name="data_k2" value="" >
 <input type="hidden"  name="data_k3" value="" >

 <input type="hidden"  name="HIDE"  value="${HIDE_DATA}">
 <input type="hidden"  name="pageType"  value="cond">

</form>
</body>
</html>

<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
	tigra_tables('table1');
</script>

<script language="javascript">

 top.refreshButton2('0');
 top.pageRows="20";
 

 function validateInput()
  {
    

    if ( !top.checkFormat() )
       { return false; }

    if (top.actionCode == 'Q') {

        if (document.getElementById("ex_date1").value == "" || document.getElementById("ex_date2").value == ""){
                alert("查詢功能，日期起訖日為必填欄位");
                return false;
        }

        if (document.getElementById("ex_iso_resp_code_fail").checked){
            // fail
            if (document.getElementById("ex_card_no").value.trim() == ""){
                alert("查詢條件為「交易失敗」時，卡號為必填欄位");
                return false;
            }
        }
    }

    return true;
  }
 
 function selectAll() {
	 var opt_select =document.dataForm.ex_selectAll.checked;
    var aElements = document.dataForm.getElementsByTagName("input");
    for ( var i=0;  i < aElements.length; i++ ) 
    {
		if  ( aElements[i].type == "checkbox" ) {
			aElements[i].checked = opt_select;
		}
    }
    return;
 }
 
  
</script>
