<html>
<head>
<title>rskm1012 消費通知參數維護作業明細維護</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
<script language="JavaScript" src="js/jquery.js"></script>
</head>


<body bgcolor="#FFFFFF">
<form name="dataForm"  method="post" action="">
${#PLUGIN:htmcomm_plugin.apr_user}
<table border="0" cellpadding="0" cellspacing="0" style="margin-bottom:10px;">
	
<tr>
 <td width="100">&nbsp;</td>
 <td> 
  <img height="30" src="images/upperLevel.gif" style="cursor:hand;" onClick="top.upperLevel()"; alt="回上層"; onmouseout="top.light_img(this);"; onmouseover="top.dark_img(this);">&nbsp;
  <input type="Button"     value="讀取" onClick="return top.submitControl('R2')" class="btQuery" >&nbsp;&nbsp;
  <input type="Button"    value="存檔" ${btnUpdate_disable} onClick="return top.submitControl('U2')" class="btUpdate" >&nbsp;&nbsp;
  </td>
</tr>
</table>

<div id="dataBlock">
<table width="60%" border="0" cellspacing="0" cellpadding="4">
  <tr>
   <td nowrap class="colKey">卡片等級:
		<span class="dsp_text"> ${card_note}.${#JAVA:ecsfunc.DeCodeCrd.cardNote(card_note)}</span>
      <input type=hidden name="card_note" value="${card_note}">
   </td>
   <td nowrap class="colKey">Entry Mode類別:
		<span class="dsp_text"> ${entry_mode_type} </span>
      <input type=hidden name="entry_mode_type" value="${entry_mode_type}">
   </td>
  </tr>
  <tr>
   <td nowrap class="colKey">交易類別:
		<span class="dsp_text"> ${web3d_flag}.${tt_web3d_flag}</span>
    <input type=hidden name="web3d_flag" value="${web3d_flag}">
    <input type="hidden" name="tt_web3d_flag" value="${tt_web3d_flag}">
   </td>
   <td nowrap class="colKey">風險類別:
		<span class="dsp_text"> ${risk_type} </span>
      <input type=hidden name="risk_type" value="${risk_type}">
   </td>
  </tr>
  <tr>
   <td nowrap class="colKey" colspan="2" >明細類別：
		<span class="dsp_text">期數利率</span>
      <input type=hidden id="data_type1" name="data_type1" value="AMT1">
   </td>
  </tr>
  <tr>
  	<td nowrap colspan="2" >
  	  <input type="Button"   value="排除MCC" onclick="wf_detl_2page('MCC1');" class="btAdd_detl" />
      <input type="Button"   value="排除特店" onclick="wf_detl_2page('MCHT1');" class="btAdd_detl" />
      <input type="Button"   value="排除風險類別" onclick="wf_detl_2page('RISK1');" class="btAdd_detl" />
      <input type="Button"   value="期數利率設定" onclick="wf_detl_2page('AMT1');" disabled />      
  	</td>
  </tr>  
</table>  
<table width="60%" border="0" cellspacing="0" cellpadding="4">
  <tr>
   <td nowrap width="90%">金額門檻:
      <input type="text" class="col_number" id="ex_amt" name="ex_amt" value="${ex_amt}" maxlength="12" size="14" zEdit="number" />       
      &nbsp;期數:
      <input type="text" class="col_number" id="ex_term" name="ex_term" value="${ex_term}" maxlength="2" size="4" zEdit="number" />
      &nbsp;利率:
      <input type="text" class="col_number" id="ex_rate" name="ex_rate" value="${ex_rate}" maxlength="6" size="8" zEdit="dignumber" />
      &nbsp;
      <input type="Button" id="detl_btnAdd" value="新增明細" class="btAdd_detl" />
      &nbsp;IND_NUM=${ind_num}            
   </td>
  </tr>
</table>  
<hr>
 <table width="60%" id="table1" class="sortable" border="0" >
  <tr>
    <th nowrap class="list_cc" width="5%">刪除 </th>    
    <th nowrap class="list_cc">金額門檻 </th>
    <th nowrap class="list_cc">期數</th>
    <th nowrap class="list_cc">利率(%)</th>
  </tr>
  <!-- BEGIN DYNAMIC : DETAIL -->
  <tr>
    <td nowrap class="list_no">
      <span class="dsp_flag">${ok_flag}</span>
      <input type="checkbox" name="opt" value="${ser_num}">
      ${SER_NUM}
      <input type="hidden" name="ser_num" value="${ser_num}">
      <input type="hidden" name="data_code1" value="${data_code1}">
      <input type="hidden" name="data_code2" value="${data_code2}">
      <input type="hidden" name="data_code3" value="${data_code3}">
      <input type="hidden" name="data_type" value="${data_type}">
    </td>    
    <td nowrap class="list_cc" >&nbsp;${data_code1} </td>
    <td nowrap class="list_rr" >&nbsp;${data_code2} </td>
    <td nowrap class="list_rr" >&nbsp;${data_code3} </td>
  </tr>
  <!-- END DYNAMIC : DETAIL -->
</table>  

<!--hidden -->
<input type=hidden name="data_k1" value="${card_note}" />
<input type=hidden name="data_k2" value="${entry_mode_type}" />
<input type=hidden name="data_k3" value="${web3d_flag}" />
<input type=hidden name="data_k4" value="${risk_type}" />
<input type=hidden name="data_k5" value="" />

<!-- -->
<input type="hidden" name="ROWID" value="${rowid}">
<input type="hidden" name="MOD_SEQNO" value="${mod_seqno}">
<input type="hidden" name="HIDE" value="${HIDE_DATA}">
<input type="hidden" name="pageType" value="detl_accttype">

</form>
</body>
</html>

<script language="javascript">
var ind=${IND_NUM};
var rowNum=${IND_NUM},colNum=0,fi=0;
</script>

<script language="javascript">

 top.refreshButton2('2');
 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }
   return true;
 }

 $("#detl_btnAdd").click(function(){

   var ex_amt =$("#ex_amt").val();
   var ex_term =$("#ex_term").val();
   var ex_rate =$("#ex_rate").val();
   
   if (ex_amt.trim()=='') {
      alert("金額門檻: 不可空白");
      return false;
   }
   
   if (ex_term.trim()=='') {
	  alert("期數: 不可空白");
	  return false;
   }
   
   if (ex_rate.trim()=='') {
	  alert("利率: 不可空白");
	  return false;
   }
   
   var ls_data_type =$("#data_type1").val();
	

   rowNum++;
   ind++;
   var serNo ="0";
   if ( ind < 10 )
      { serNo = "0"+ind; }
   else
   	{ serNo = ""+ind;  }

   $("#table1").append(
      "<tr>"
      +"<td nowrap class='list_no'>"
      +"<input type='checkbox' value='"+serNo+"' name='opt' />"
      +"&nbsp;"+serNo
      +"<input type='hidden' value='"+serNo+"' name='ser_num' />"
      +"<input type='hidden' value='"+ex_amt+"' name='data_code1' />"
      +"<input type='hidden' value='"+ex_term+"' name='data_code2' />"
      +"<input type='hidden' value='"+ex_rate+"' name='data_code3' />"
      +"<input type='hidden' value='"+ls_data_type+"' name='data_type' />"      
      +"</td>"
      +"<td nowrap class='list_cc'>"+ex_amt
      +"</td>"
      +"<td nowrap class='list_rr'>"+ex_term
      +"</td>"
      +"<td nowrap class='list_rr'>"+ex_rate
      +"</td>"      
      +"</tr>"
   );

   //-clear-
   $("#ex_amt").val('');
   $("#ex_term").val('');
   $("#ex_rate").val('');
   
  });

 function wf_detl_2page(parm) {
	 if (parm==="MCC1") {
		top.respHtml  = "ccam5270_mcc1";
	 }
	 else if (parm==="MCHT1") {
		top.respHtml  = "ccam5270_mcht1";
	 }
	 else if (parm=="RISK1") {
		top.respHtml  = "ccam5270_risk1";
	 }	 
	 else if (parm=="AMT1") {
		top.respHtml  = "ccam5270_amt1";
	 }
	 	
    top.respLevel = 2;
	document.dataForm.data_k5.value = parm;
    top.submitControl("S2");
    return true;
 }
</script>
