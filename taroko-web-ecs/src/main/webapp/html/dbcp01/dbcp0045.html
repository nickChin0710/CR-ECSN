<html>

<head>
    <title>DebitCard非新製卡轉入送製卡檔覆核作業-107-08-03-V1.00.00-Andy-[Initial]</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="css/ecsBank.css" type="text/css">
    <link rel="stylesheet" href="js/Calendar/calendar.css">
    <script language="JavaScript" src="js/jquery.js"></script>
</head>
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>

<body background="${water_mark}">
    <form name="dataForm" method="post" action="">
        <div id="condBlock">
            <!--COND -->
            <table width="60%" border="0" cellspacing="0" cellpadding="4">
                <tr>
                    <td nowrap colspan=4>&nbsp;批號:
                        <input type="text" class="col_any" name="ex_batchno1" value="${ex_batchno1}" zEdit="alphanum" maxlength=10 size=10 /> &nbsp;--
                        <input type="text" class="col_any" name="ex_batchno2" value="${ex_batchno2}" zEdit="alphanum" maxlength=10 size=10 />
                    </td>
                    <td nowrap colspan=4>&nbsp;產生日期：
                        <input type="text" class="col_date" name="exDateS" value="${exDateS}" zEdit="date,yyyymmdd" maxlength="8" size="8" />
                        <script language="JavaScript">
                        new tcal({
                            'formname': 'dataForm',
                            'controlname': 'exDateS'
                        });
                        </script>
                        --
                        <input type="text" class="col_date" name="exDateE" value="${exDateE}" zEdit="date,yyyymmdd" maxlength="8" size="8" />
                        <script language="JavaScript">
                        new tcal({
                            'formname': 'dataForm',
                            'controlname': 'exDateE'
                        });
                        </script>
                    </td>
                    <td nowrap colspan=4>&nbsp;排序:
                        <select size="1" name="ex_order" class="col_ddlb">
                            <option value="">--</option>
                            <option value="batchno" ${ex_order-batchno}>批號</option>
                            <option value="card_no" ${ex_order-card_no}>卡號</option>
                            <option value="crt_user" ${ex_order-crt_user}>登錄人員</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td nowrap colspan=3>&nbsp;製卡來源:
                        <select size="1" name="ex_emboss_source" class="col_ddlb">
                            <option value="">--</option>
                            <option value="1" ${ex_emboss_source-1}>新製卡</option>
                            <option value="2" ${ex_emboss_source-2}>普升金</option>
                            <option value="3" ${ex_emboss_source-3}>整批續卡</option>
                            <option value="4" ${ex_emboss_source-4}>線上續卡</option>
                            <option value="5" ${ex_emboss_source-5}>重製</option>
                        </select>
                    </td>
                    <td nowrap colspan=3>&nbsp;重製原因:
                        <select size="1" name="ex_reason" class="col_ddlb">
                            <option value="">--</option>
                            <option value="0" ${ex_reason-0}></option>
                            <option value="1" ${ex_reason-1}>掛失</option>
                            <option value="2" ${ex_reason-2}>損毀</option>
                            <option value="3" ${ex_reason-3}>偽卡</option>
                            <option value="4" ${ex_reason-4}>星座卡重製</option>
                        </select>
                    </td>
                    <td nowrap colspan=3>&nbsp;登錄人員:
                        <select name="ex_keyin" class="col_ddlb">
                            ${dddw_keyin}
                        </select>
                    </td>
                    <td nowrap colspan=3>&nbsp;
                        <input type="Button"  value="查詢" onClick="return top.submitControl('Q')" class="btQuery">&nbsp;&nbsp;
                        <input type="Button"  value="清除" onClick="return top.submitControl('L')" class="btClear">&nbsp;&nbsp;
                        <input type="Button"  value="執行" onClick="return top.submitControl('S2')" class="btAdd">&nbsp;&nbsp;
                    </td>
                </tr>
            </table>
        </div>
        <hr>
        <!--List -->
        <table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4" width="40%">
            <tr>
                <th nowrap class="list_th" width="5%">
                    <input type="checkbox" name="ex_selectAll" id="allcheck" value="Y" onChange="selectAll();" style="color:blue">覆核&nbsp;
                </th>
                <th nowrap class="list_th">Err_msg</th>
                <th nowrap class="list_th">批號</th>
                <th nowrap class="list_th">製卡來源</th>
                <th nowrap class="list_th">重製原因</th>
                <th nowrap class="list_th">卡號</th>
                <th nowrap class="list_th">舊卡號</th>
                <th nowrap class="list_th">卡種</th>
                <th nowrap class="list_th">申請人ID</th>
                <th nowrap class="list_th">統一編號</th>
                <th nowrap class="list_th">姓名</th>
                <th nowrap class="list_th">生日</th>
                <th nowrap class="list_th">英文姓名</th>
                <th nowrap class="list_th">有效年月起</th>
                <th nowrap class="list_th">有效年月止</th>
                <th nowrap class="list_th">正卡ID</th>
                <th nowrap class="list_th">團體代號</th>
                <th nowrap class="list_th">錯誤</th>
                <th nowrap class="list_th">送取三軌註記</th>
            </tr>
            <!-- BEGIN DYNAMIC : DETAIL -->
            <tr>
                <td nowrap class="list_no" rowspan="2">
                    <span class="dsp_flag">${ok_flag}</span> ${SER_NUM}
                    <input type="checkbox" name="opt" value="${ser_num}" ${set_opt}/>
                    <input type="hidden" name="rowid" value="${rowid}" />
                    <input type="hidden" name="ser_num" value="${ser_num}" />
                    <input type="hidden" name="mod_seqno" value="${mod_seqno}" />
                </td>
            </tr>
            <tr>
                <td nowrap class="list_cc" style="color: red"> ${err_msg}&nbsp; </td>
                <td nowrap class="list_cc"> ${db_batchno}&nbsp; </td>
                <td nowrap class="list_cc"> ${db_emboss_source}&nbsp; </td>
                <td nowrap class="list_cc"> ${db_emboss_reason}&nbsp; </td>
                <td nowrap class="list_ll"> ${card_no}&nbsp; </td>
                <td nowrap class="list_ll"> ${old_card_no}&nbsp; </td>
                <td nowrap class="list_ll"> ${card_type}&nbsp; </td>
                <td nowrap class="list_ll"> ${db_apply_id}&nbsp; </td>
                <td nowrap class="list_ll"> ${db_corp_no}&nbsp; </td>
                <td nowrap class="list_ll"> ${chi_name}&nbsp; </td>
                <td nowrap class="list_ll"> ${birthday}&nbsp; </td>
                <td nowrap class="list_ll"> ${eng_name}&nbsp; </td>
                <td nowrap class="list_ll"> ${valid_fm}&nbsp; </td>
                <td nowrap class="list_ll"> ${valid_to}&nbsp; </td>
                <td nowrap class="list_ll"> ${db_pm_id}&nbsp; </td>
                <td nowrap class="list_ll"> ${group_code}&nbsp; </td>
                <td nowrap class="list_ll"> ${error_code}&nbsp; </td>
                <td nowrap class="list_ll"> ${third_rsn}&nbsp; </td>                
                <input type="hidden" name="db_batchno" value="${db_batchno}">
                <input type="hidden" name="db_emboss_source" value="${db_emboss_source}">
                <input type="hidden" name="db_emboss_reason" value="${db_emboss_reason}">              
                <input type="hidden" name="db_apply_id" value="${db_apply_id}">
                <input type="hidden" name="db_corp_no" value="${db_corp_no}">
                <input type="hidden" name="batchno" value="${batchno}">
                <input type="hidden" name="emboss_source" value="${emboss_source}">
                <input type="hidden" name="emboss_reason" value="${emboss_reason}">
                <input type="hidden" name="card_no" value="${card_no}">
                <input type="hidden" name="old_card_no" value="${old_card_no}">
                <input type="hidden" name="card_type" value="${card_type}">
                <input type="hidden" name="chi_name" value="${chi_name}">
                <input type="hidden" name="birthday" value="${birthday}">
                <input type="hidden" name="eng_name" value="${eng_name}">
                <input type="hidden" name="valid_fm" value="${valid_fm}">
                <input type="hidden" name="valid_to" value="${valid_to}">
                <input type="hidden" name="db_pm_id" value="${db_pm_id}">
                <input type="hidden" name="group_code" value="${group_code}">
                <input type="hidden" name="error_code" value="${error_code}">
                <input type="hidden" name="third_rsn" value="${third_rsn}">
                <input type="hidden" name="db_opt_code" value="${db_opt_code}">
                <input type="hidden" name="db_mark" value="${db_mark}">
                <input type="hidden" name="confirm_date" value="${confirm_date}">
                <input type="hidden" name="confirm_user" value="${confirm_user}">
                <input type="hidden" name="emboss_date" value="${emboss_date}">
                
            </tr>
            <!-- END DYNAMIC : DETAIL -->
        </table>
        <input type="hidden" name="data_k1" value="">
        <input type="hidden" name="data_k2" value="">
        <input type="hidden" name="data_k3" value="">
        <input type="hidden" name="HIDE" value="${HIDE_DATA}">
        <input type="hidden" name="pageType" value="cond">
    </form>
</body>

</html>
<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>
<script language="javascript">
top.refreshButton2('0');
top.pageRows = "20";
document.dataForm.ex_batchno1.focus();

function validateInput() {
    if (!top.checkFormat()) { return false; }
    if (top.actionCode == "X") {
        top.respLevel = 1;
        top.respHtml = "dbcp0045_detl";
    }

    if (top.actionCode == "S2") {
        if (!chkdata()) {
            return false;
        }
        if (confirm("是否執行作業?!") === false) {
            return false;
        }
    }

    return true;
}

function detailScreen(serNum, parm, parm2, parm3) {
    top.respLevel = 1;
    top.currRows = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    top.respHtml = "dbcp0045_detl";
    top.submitControl('S');
    return true;
}
//全選
function selectAll() {
    var aElements = document.dataForm.getElementsByTagName("input");
    for (var i = 0; i < aElements.length; i++) {
        if (aElements[i].type == "checkbox") {
            aElements[i].checked = document.dataForm.ex_selectAll.checked;
        }
    }

    return;
}

function chkdata() {
    var agy = 0;
    $("input[name=opt]").each(function() {
        if ($(this).prop("checked") == true) {
            agy++;
        }
    })
    // if (agy == 0) {
    //     alert("未選取資料!");
    //     return false;
    // }
    return true;
}
</script>