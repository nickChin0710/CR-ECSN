<!--**************************************************************************-->
<!--                                                                          -->
<!--                              MODIFICATION LOG                            -->
<!--                                                                          -->
<!--    DATE    VERSION     AUTHOR                 DESCRIPTION                -->
<!-- ---------  --------  -----------    ------------------------------------ -->
<!-- 109-12-15  V1.00.02    Justin        remove the second zz_file_name      -->
<!--**************************************************************************-->
<html>
<head>
<title>dbbm0010線上加檔登錄作業-2021215</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
</head>

<body background="${water_mark}" >
<form  name="dataForm" method="post" action="" >

<div id="condBlock">
<table width="60%" border="0" cellspacing="0" cellpadding="4">
  <tr>
   <td nowrap >&nbsp;登錄批號:
   		<input type="text" class="col_text" name="ex_key_no" value="${ex_key_no}" maxlength="4" size="6" zEdit="alphanum,upper" >
   </td>
   <td nowrap >&nbsp;登錄人員:
   		<input type="text" class="col_any" name="ex_user" value="${ex_user}" maxlength="10" size="12" zEdit="any,canTw" >
   </td>   	
   <td nowrap >&nbsp;  
      <input type="Button"  value="查詢" onClick="return top.submitControl('Q')" class="btQuery" >&nbsp;&nbsp;
      <input type="Button"  value="清除" onClick="return top.submitControl('L')" class="btClear" >&nbsp;&nbsp;
      <input type="Button"  value="新增" onClick="return top.submitControl('X')" class="btAdd" >&nbsp;&nbsp;    
      <input type="Button" value="資料匯入" onClick="return top.submitControl('UPLOAD')" class="btConfirm" >&nbsp;&nbsp;  
      <input type="Button"  value="刪除" ${btnDelete_disable} onClick="return top.submitControl('C2')" class="btDelete" >&nbsp;&nbsp;
   </td>   
   <td nowrap rowspan="3">&nbsp;錯誤代碼說明：   	
    <span class="dsp_text" style="color:8608FB">    	
      <br>&nbsp;1:ID Error <br>&nbsp;3:金額 Error <br>&nbsp;4:卡號 Error <br>&nbsp;5:帳戶 Error <br>
    </span>  
   </td>
  </tr>
  <tr>
   <td nowrap >&nbsp;正卡身分證號:
   		<input type="text" class="col_text" name="ex_idno" value="${ex_idno}" maxlength="10" size="12" zEdit="alphanum,upper" >
   </td>
   <td nowrap >&nbsp;卡號:
   		<input type="text" class="col_text" name="ex_card_no" value="${ex_card_no}" maxlength="19" size="21" zEdit="number" >
   </td>
   <td nowrap >&nbsp;錯誤代碼:
   		<span class="col_radio">
         <input type="radio" value="0" name="ex_error_code" ${ex_error_code-0} ${DEFAULT-ex_error_code} />全部
         <input type="radio" value="Y" name="ex_error_code" ${ex_error_code-Y} />有
         <input type="radio" value="N" name="ex_error_code" ${ex_error_code-N} />無
      </span>
   </td>
  </tr>
  <tr>
   <td nowrap colspan="3">&nbsp;匯入媒體檔:
      <input type="text" class="dsp_text"  name="zz_file_name" value="${zz_file_name}" readonly size="50" zEdit="any,canTw" />
      <input type="button"  value="..." class="btProcess" onclick="return upload_click()">
   </td>
  </tr>
 </table>
</div>
<hr>

 <table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th width="10%">
    	<input type="checkbox" name="ex_selectAll" value="Y" onClick="selectAll();" >
    	刪除
    </th>
    <th >錯誤代碼&nbsp;</th>
    <th >帳戶類別&nbsp;</th>
    <th >正卡身分證號&nbsp;</th>
    <th >中文姓名&nbsp;</th>
    <th >加檔項目&nbsp;</th>
    <th >加檔卡號&nbsp;</th>
    <th >金額&nbsp;</th>
    <th >消費日期&nbsp;</th>
    <th >對帳單文字&nbsp;</th>
    <th >覆核人員&nbsp;</th>
    <th >登錄人員&nbsp;</th>
  </tr>
  <!-- BEGIN DYNAMIC : DETAIL -->
  <tr >
   <td nowrap class="list_no"> 
   		<span class="dsp_flag">${ok_flag}</span>
   		<input type="checkbox" name="opt" value="${ser_num}" />   		
   		${SER_NUM}&nbsp;
   		<img src="images/btnQuery.gif" width="20" height="15" onclick="detailScreen('${SER_NUM}','${rowid}','${mod_seqno}','')" style="cursor:hand">
   		<input type="hidden" name="rowid" value="${rowid}">
   		<input type="hidden" name="mod_seqno" value="${mod_seqno}">
   		<input type="hidden" name="acct_type" value="${acct_type}">
   		<input type="hidden" name="id_no" value="${id_no}">
   		<input type="hidden" name="chi_name" value="${chi_name}">
   		<input type="hidden" name="add_item" value="${add_item}">
   		<input type="hidden" name="card_no" value="${card_no}">
   		<input type="hidden" name="dest_amt" value="${dest_amt}">
   		<input type="hidden" name="purchase_date" value="${purchase_date}">
   		<input type="hidden" name="bill_desc" value="${bill_desc}">
   		<input type="hidden" name="apr_user" value="${apr_user}">
   		<input type="hidden" name="mod_user" value="${mod_user}">
   		<input type="hidden" name="error_code" value="${error_code}">
	 </td>
	 <td nowrap class="list_cc"> ${error_code}&nbsp;</td>
	 <td nowrap class="list_cc"> ${acct_type}&nbsp;</td>
	 <td nowrap class="list_cc"> ${id_no}&nbsp;</td>
	 <td nowrap class="list_cc"> ${chi_name}&nbsp;</td>
	 <td nowrap class="list_cc"> ${add_item}&nbsp;</td>
	 <td nowrap class="list_cc"> ${card_no}&nbsp;</td>
	 <td nowrap class="list_rr"> ${dest_amt.(999)}&nbsp;</td>
	 <td nowrap class="list_cc"> ${purchase_date.YMD}&nbsp;</td>
	 <td nowrap class="list_ll"> ${bill_desc}&nbsp;</td>
	 <td nowrap class="list_cc"> ${apr_user}&nbsp;</td>
	 <td nowrap class="list_cc"> ${mod_user}&nbsp;</td>
	</tr>
  <!-- END DYNAMIC : DETAIL -->
 </table>
 
 <input type="hidden"  name="upload_file" value="" /> 
    
 <input type="hidden"  name="data_k1" value="" >
 <input type="hidden"  name="data_k2" value="" >
 <input type="hidden"  name="data_k3" value="" >

 <input type="hidden"  name="HIDE"  value="${HIDE_DATA}">
 <input type="hidden"  name="pageType"  value="cond">

</form>
</body>
</html>

<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
	tigra_tables('table1');
</script>

<script language="javascript">

 top.refreshButton2('0');
 top.pageRows="20";
 

 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }

    if ( top.actionCode == "X" ) {
        top.respLevel = 1;
        top.respHtml = "dbbm0010_detl"; 
    }

    return true;
  }

 function detailScreen(serNum,parm,parm2,parm3) { 
    top.respLevel = 1;
    top.currRows  = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    top.respHtml  = "dbbm0010_detl";
    top.submitControl('S');
    return true;
  }
  
    function upload_click() {
    document.dataForm.zz_file_name.value = "";
    
    var parmHtml    = "TarokoUpload";
    var parmName    = "upload_file,zz_file_name";
    var windowSize  = "width=700, height=250, top=100, left=200, resizable=yes";
    top.packageName = "taroko.com";
    top.javaName    = "TarokoUpload";
    top.methodName  = "showScreen";
    top.openWindow("",parmHtml,parmName,windowSize);

    //alert("rskm1070-aaaa");
    top.packageName = "dbbm01";
    top.javaName    = "Dbbm0010";
    //methodName  = "actionFunction";
    top.requHtml    = "dbbm0010";
    top.respHtml    = "dbbm0010";
    return true;
  }
  
 function wf_uploadAfter() {
 		return ;
/*
    var ss=document.dataForm.zz_file_name.value.trim();    
    if (ss.length>0) {    	
      top.submitControl('UPLOAD');
    }
*/
 }  
 
 function selectAll() {
	 var opt_select =document.dataForm.ex_selectAll.checked;
    var aElems = document.getElementsByName("opt");
    for ( var i=0;  i < aElems.length; i++ ) 
    {
		if  ( aElems[i].type == "checkbox" && aElems[i].disabled==false) {
			aElems[i].checked = opt_select;
		}
    }

    return;
 }
  
</script>
