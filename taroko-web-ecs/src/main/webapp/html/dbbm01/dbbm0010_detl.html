<!--**************************************************************************-->
<!--                                                                          -->
<!--                              MODIFICATION LOG                            -->
<!--                                                                          -->
<!--    DATE    VERSION     AUTHOR                 DESCRIPTION                -->
<!-- ---------  --------  -----------    ------------------------------------ -->
<!--            V1.00.00                Initial                               -->
<!-- 109-01-03  V1.00.01  Justin Wu     updated for archit.  change           -->
<!--**************************************************************************-->
<html>

<head>
    <title>dbbm0010線上加檔登錄作業</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="css/ecsBank.css" type="text/css">
    <link rel="stylesheet" href="css/jquery-ui.css" />
    <script language="JavaScript" src="js/jquery-2.2.2.min.js"></script>
    <script language="JavaScript" src="js/jquery-ui.js"></script>
    <link rel="stylesheet" href="js/Calendar/calendar.css">
</head>
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>

<body background="${water_mark}">
    <form name="dataForm" method="post" action="">
        <table border="0" cellpadding="0" cellspacing="0" style="margin-bottom:10px;">
            <tr>
                <td width="100">&nbsp;</td>
                <td>
                    <img height="30" src="images/upperLevel.gif" style="cursor:hand;" onClick="top.upperLevel()" ; alt="回上層" ;>
                    <input type="Button"  value="讀取" onClick="return top.submitControl('R')" class="btQuery">&nbsp;&nbsp;
                    <input type="Button" value="新增" ${btnAdd_disable} onClick="return top.submitControl('A')" class="btAdd">&nbsp;&nbsp;
                    <input type="Button"  value="修改" ${btnUpdate_disable} onClick="return top.submitControl('U')" class="btUpdate">&nbsp;&nbsp;
                    <input type="Button"  value="刪除" ${btnDelete_disable} onClick="return top.submitControl('D')" class="btDelete">&nbsp;&nbsp;
                    <input type="Button"  value="清除" onClick="return top.submitControl('L')" class="btClear">&nbsp;&nbsp;
                </td>
            </tr>
        </table>
        <div id="dataBlock">
            <table width="60%" border="0" cellspacing="0" cellpadding="4">
                <tr>
                    <td nowrap>&nbsp;登錄批號:
                        <input type="text" class="col_text" name="kk_key_no" value="${kk_key_no}" maxlength="4" size="6" zEdit="alphanum,upper">
                    </td>
                </tr>
            </table>
            <hr>
            <table width="80%" border="0" cellspacing="0" cellpadding="4">
                <tr>
                    <td nowrap>&nbsp;登錄批號:
                        <span class="dsp_text">${key_no}&nbsp;</span>
                        <input type="hidden" name="key_no" value="${key_no}">
                    </td>
                    <td nowrap>&nbsp;帳戶類別:
                        <span class="dsp_text">90</span>
                        <input type="hidden" name="acct_type" value="90">
                    </td>
                </tr>
                <tr>
                    <td nowrap>&nbsp;正卡身分證:
                        <input type="text" class="col_text" id="id_no" name="id_no" value="${id_no}" maxlength="10" size="12" zEdit="alphanum,upper" onChange="idnoChange('1')" zRequire="Y" ${db_read}>
                    </td>
                    <td nowrap>&nbsp;中文姓名:
                        <label class="dsp_text" id="chi_name">${chi_name}</label>
                        <input type="hidden" name="chi_name" value="${chi_name}">
                    </td>
                </tr>
                <tr>
                    <td nowrap>&nbsp;加檔卡號:
                        <input type="text" class="col_text" id="card_no" name="card_no" value="${card_no}" maxlength="19" size="21" zEdit="number" onChange="cardnoChange('2')">
                    </td>
                    <td nowrap>&nbsp;加檔項目:
                        <select size="1" name="add_item" class="col_ddlb" zRequire="Y">
                            <option value="">--</option>
                            ${dddw_add_item}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td nowrap>&nbsp;金額:
                        <input type="text" class="col_number" name="dest_amt" value="${dest_amt}" maxlength="12" size="14" zEdit="number">
                    </td>
                    <td nowrap>&nbsp;消費日期:
                        <input type="text" class="col_date" name="purchase_date" value="${purchase_date}" zEdit="date,yyyymmdd" MaxLength=8 size=10 />
                        <script language="JavaScript">
                            new tcal ({'formname': 'dataForm','controlname': 'purchase_date'});
         </script>
                    </td>
                </tr>
                <tr>
                    <td nowrap colspan="2">&nbsp;對帳單文字:
                        <input type=text class="col_any" id="bill_desc" name="bill_desc" value="${bill_desc}" zeditType="any,canTW" maxlength="30" size="30" />
                        <input type="Button" class="btOther" id="btn_adjcommt" value="..." onClick="wf_adj_comment()">
                    </td>
                </tr>
                <tr>
                    <td nowrap>&nbsp;覆核人員:
                        <span class="dsp_text">${apr_user}&nbsp;</span>
                        <input type="hidden" name="apr_user" value="${apr_user}">
                    </td>
                    <td nowrap>&nbsp;登錄人員:
                        <span class="dsp_text">${mod_user}&nbsp;</span>
                        <input type="hidden" name="mod_user" value="${mod_user}">
                    </td>
                </tr>
            </table>
        </div>
        <br>
        <table width="60%" border="0" cellspacing="1" cellpadding="2" style="margin-left: 30px">
            <tr>
                <td nowrap class="td_text" width="20%">異動日期：</td>
                <td nowrap class="td_data" width="30%">
                    <span class="dsp_date">${mod_date.YMD}</span>
                    <input type="hidden" name="mod_date" value="${mod_date}">
                </td>
                <td nowrap class="td_text" width="20%">異動人員：</td>
                <td nowrap class="td_data" width="30%">
                    <span class="dsp_text"> ${mod_user} </span>
                    <input type="hidden" name="mod_user" value="${mod_user}">
                </td>
            </tr>
        </table>
        <div id="dlg_adj_comment">
            <table border="0">
                <tr>
                    <td>&nbsp;對帳單文字:
                        <select size="1" id="ddlb_bill_desc" name="ddlb_bill_desc" class="col_ddlb">
                            <option value="">--</option>
                            <option value="收回誤入　貴戶之繳款" ${ddlb_bill_desc-收回誤入　貴戶之繳款}>收回誤入　貴戶之繳款</option>
                            <option value="其他費用" ${ddlb_bill_desc-其他費用}>其他費用</option>
                        </select>
                    </td>
                <tr>
            </table>
        </div>
        <!-- -->
        <input type="hidden" name="apr_flag" value="${apr_flag}">
        <input type="hidden" name="ROWID" value="${rowid}">
        <input type="hidden" name="MOD_PGM" value="dbbm01">
        <input type="hidden" name="MOD_SEQNO" value="${mod_seqno}">
        <input type="hidden" name="HIDE" value="${HIDE_DATA}">
        <input type="hidden" name="pageType" value="detl">
    </form>
</body>

</html>
<script language="JavaScript" src="js/AJAXFunction_11.js"></script>
<script language="javascript">
top.refreshButton2('1');

$(document).ready(function() {
    $("#dlg_adj_comment").dialog({
        title: 'Bill_desc select',
        autoOpen: false,
        resizable: false,
        modal: true,
        //height: 200,
        //width: 300,
        buttons: {
            "確定": function() {
                $("#bill_desc").val($('#ddlb_bill_desc').val());
                $(this).dialog("close");
            },
            "取消": function() {
                $(this).dialog("close");
            }
        }
    });

});

function validateInput() {
    if (!top.checkFormat()) { return false; }

    return true;
}

function wf_adj_comment() {
    $("#dlg_adj_comment").dialog("open");
}

function idnoChange(ps1) {
    var id_no = document.forms["dataForm"]["id_no"].value.toUpperCase();
    if (id_no === '') {
        return false;
    }
    idCode = ps1;
    top.actionCode = "AJAX";
/*    if (idCode === '1') {
        top.methodName = "wf_ajax_key";
    }*/

    resetJSON();
    addJSON("ajaxName", "idno");
    addJSON("ax_idno", id_no);
    processAJAX();
}

function cardnoChange(ps2) {
    var card_no1 = $('#card_no').val();
    if (card_no1 === '') {
        return false;
    }
    idCode = ps2;
    top.actionCode = "AJAX";
/*    if (idCode === '2') {
        top.methodName = "wf_ajax_key";
    }*/

    resetJSON();
    addJSON("ajaxName", "cardno");
    addJSON("ax_cardno", card_no1);
    processAJAX();
}


function ajaxResponse() {
    top.respHtml = "dbbm0010_detl";
    top.requHtml = "dbbm0010_detl";
    if (idCode === '1') {
        var chi_name = getJSONvalue("chi_name", 0);
        var card_no = getJSONvalue("card_no", 0);
        if (chi_name.length > 0) {
            $("#chi_name").text(chi_name);
            $("#chi_name").val(chi_name);
        }
        if (card_no.length > 0) {
            $("#card_no").text(card_no);
            $("#card_no").val(card_no);
        }
    }

    // if ( idCode === '1')
    // { return false; }

    if (idCode === '2') {
        var chi_name = getJSONvalue("chi_name", 0);
        var id_no = getJSONvalue("id_no", 0);
        if (chi_name.length > 0) {
            $("#chi_name").text(chi_name);
            $("#chi_name").val(chi_name);
        }
        if (id_no.length > 0) {
            $("#id_no").text(id_no);
            $("#id_no").val(id_no);
        }
    }

    // if ( idCode === '2')
    // { return false; }



}
</script>