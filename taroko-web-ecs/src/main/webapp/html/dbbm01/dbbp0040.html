<html>
<head>
<title>格式查核錯誤維護放行作業-V.2018-0713-ryan-[Initial]</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
<script language="JavaScript" src="js/jquery.js"></script>
</head>

<body background="${water_mark}" >
<form  name="dataForm" method="post" action="" >

<div id="condBlock">
<!--COND -->
<table width="50%" border="0" cellspacing="0" cellpadding="4">
	<tr>
		<td nowrap>&nbsp;請款批號:
        	<input type="text" class="col_any" name="ex_batch_no" value="${ex_batch_no}" 
        	zEdit="any" maxlength="14" size="14" />   
      	</td> 
      	<td nowrap>&nbsp;請款單位:
          	<select size="1" name="ex_batch_unit" class="col_ddlb">
            	<option value="">--</option>
            	${dddw_liab_type}
          	</select>    
      	</td>
   		<td nowrap >&nbsp;  
			<input type="Button" value="查詢" onClick="return top.submitControl('Q')" class="btQuery" >&nbsp;&nbsp;
			<input type="Button" value="清除" onClick="return top.submitControl('L')" class="btClear" >&nbsp;&nbsp;
			<input type="Button" value="執行" onClick="return top.submitControl('C')" class="btAdd" >&nbsp;&nbsp;
		</td>
	</tr>
</table>
</div>
<hr>

<!--List -->
<table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
	<tr>
		<th nowrap class="list_th" width="5%">
			<input type="checkbox" name="ex_selectAll" id="allcheck" value="Y" onChange="selectAll();" style="color:blue"><span class="ex_selectAll">放行&nbsp;</span></th>
		<th nowrap class="list_th">交易卡號</th>
		<th nowrap class="list_th">刪除否</th>
		<th nowrap class="list_th">參考號碼</th>
		<th nowrap class="list_th">交易日期</th>
		<th nowrap class="list_th">微縮影編號</th>
		<th nowrap class="list_th">交易金額</th>
		<th nowrap class="list_th">幣別</th>
		<th nowrap class="list_th">原始金額</th>
		<th nowrap class="list_th">原始幣別</th>
		<th nowrap class="list_th">錯誤碼</th>
		<th nowrap class="list_th">請款類別</th>
		<th nowrap class="list_th">交易別</th>
	</tr>
<!-- BEGIN DYNAMIC : DETAIL -->
	<tr>
		<td nowrap class="list_no" rowspan="2">
			<span class="col_key">${ok_flag}</span>
			<input type="checkbox" name="opt" class="check"  value="${ser_num}" ${opt_disabled}/>
			${SER_NUM}&nbsp;
			<input type="hidden" name="rowid" value="${rowid}">
			<input type="hidden" name="ser_num" value="${ser_num}">
			<input type="hidden" name="mod_seqno" value="${mod_seqno}">
			<input type="hidden" name="card_no" value="${card_no}">
			<input type="hidden" name="mod_log" value="${mod_log}">
			<input type="hidden" name="tt_mod_log" value="${tt_mod_log}">
			<input type="hidden" name="reference_no" value="${reference_no}">
			<input type="hidden" name="purchase_date" value="${purchase_date}">
			<input type="hidden" name="film_no" value="${film_no}">
			<input type="hidden" name="dest_amt" value="${dest_amt}">
			<input type="hidden" name="dest_curr" value="${dest_curr}">
			<input type="hidden" name="source_amt" value="${source_amt}">
			<input type="hidden" name="source_curr" value="${source_curr}">
			<input type="hidden" name="doubt_type" value="${doubt_type}">
			<input type="hidden" name="bill_type" value="${bill_type}">
			<input type="hidden" name="txn_code" value="${txn_code}">
			<input type="hidden" name="opt_disabled" value="${opt_disabled}" />
		</td>
	</tr>
	<tr>
		<td nowrap class="list_ll">${card_no}&nbsp;</td>
		<td nowrap class="list_ll" style='color:red'>${tt_mod_log}&nbsp;</td>
		<td nowrap class="list_ll">${reference_no}&nbsp;
		<td nowrap class="list_ll">${purchase_date.YMD}&nbsp;</td>
		<td nowrap class="list_ll">${film_no}&nbsp;</td>
		<td nowrap class="list_rr">&nbsp;${dest_amt.(999)}</td>
		<td nowrap class="list_ll">${dest_curr}&nbsp;</td>
		<td nowrap class="list_rr">&nbsp;${source_amt.(999)}</td>
		<td nowrap class="list_ll">${source_curr}&nbsp;</td>
		<td nowrap class="list_ll">${doubt_type}&nbsp;</td>
		<td nowrap class="list_ll">${bill_type}&nbsp;</td>
		<td nowrap class="list_ll">${txn_code}&nbsp;</td>
	</tr>
<!-- END DYNAMIC : DETAIL -->
</table>   
<input type="hidden"  name="data_k1" value="" >
<input type="hidden"  name="data_k2" value="" >
<input type="hidden"  name="data_k3" value="" >
<input type="hidden"  name="MOD_PGM" value="dbbp0040">
<input type="hidden"  name="HIDE"  value="${HIDE_DATA}">
<input type="hidden"  name="pageType"  value="cond">
</form>
</body>
</html>

<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
	tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>

<script language="javascript">

 top.refreshButton2('0');
 top.pageRows="20";
 
 document.dataForm.ex_batch_no.focus();

 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }

    if ( top.actionCode == "X" ) {
        top.respLevel = 1;
        top.respHtml = "dbbp0040_detl"; 
    }

    if ( top.actionCode == "C" ) {
    	if ( !chkdata() ) { 
    		return false; 
    	} 
    	if (confirm("是否執行"+$(".ex_selectAll").text()+"作業?") === false) {
            return false;
        } 
    }
    return true;
  }

 function detailScreen(serNum,parm,parm2,parm3) { 
    top.respLevel = 1;
    top.currRows  = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    top.respHtml  = "dbbp0040_detl";
    top.submitControl('S');
    return true;
  }
//全選
 function selectAll() {
	var aElements = document.dataForm.getElementsByTagName("input");
	for ( var i=0;  i < aElements.length; i++ ) {
		if  ( aElements[i].type == "checkbox" && aElements[i].disabled == false) {
			aElements[i].checked = document.dataForm.ex_selectAll.checked;
		}
	}
	
	return;
 }
 
 function chkdata() {
	 var agy =0;
	 $("input[name=opt]").each(function (){
		 if($(this).prop("checked")==true){
			 agy++; 
		 }
	 })
	 if(agy == 0){
		 alert("未選取"+$(".ex_selectAll").text()+"資料!");
		 return false;
 	 }
	 return true;
 }
 
</script>
