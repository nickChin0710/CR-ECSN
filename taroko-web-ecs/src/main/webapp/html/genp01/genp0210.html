<!--**************************************************************************-->
<!--                                                                          -->
<!--                              MODIFICATION LOG                            -->
<!--                                                                          -->
<!--    DATE    VERSION     AUTHOR                 DESCRIPTION                -->
<!-- ---------  --------  -----------    ------------------------------------ -->
<!-- 106-11-15  V1.00.00  andy          Initial                               -->
<!-- 109-01-03  V1.00.01  Justin Wu     updated for archit.  change           -->
<!-- 111-11-25  V1.00.02  Zuwei Su      sync from mega                        -->
<!--**************************************************************************-->
<html>

<head>
    <title>會計科目主檔放行作業</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="css/ecsBank.css" type="text/css">
</head>
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>
<script language="JavaScript" src="js/jquery.js"></script>

<body background="${water_mark}">
    <form name="dataForm" method="post" action="">
        <div id="condBlock">
            <!--COND -->
            <table width="60%" border="0" cellspacing="0" cellpadding="4">
                <tr>
                    <td nowrap>&nbsp;科子細目代碼:
                        <input class="field_style" type="text" name="ex_ac_no" size="15" maxlength="15" value="${ex_ac_no}">&nbsp;&nbsp;
                        <input type="Button" name="detl_btnAdd" value="..." onclick="processVendorCode()" class="btAdd_detl" />
                    </td>
                    <td nowrap>&nbsp;
                        <input type="Button" name="btnQuery"  value="查詢" onClick="return top.submitControl('Q')" class="btQuery">&nbsp;&nbsp;
                        <input type="Button" name="btnClear"  value="清除" onClick="return top.submitControl('L')" class="btClear">&nbsp;&nbsp;
                        <input type="Button" name="btnAdd"  value="執行" onClick="return top.submitControl('S2')" class="btAdd">&nbsp;&nbsp;
                    </td>
                </tr>
            </table>
        </div>
        <hr>
        <!-- 動態 BLOCK 視窗控制 -->
        <div id="disDiv" class="disScreen"></div>
        <div id="popDiv" class="popup1">
            <table id="popup2" style="top:-40px; left:350px; width:300px; height:100px;">
                <tr>
                    <td colspan="2"><img onClick="top.hideBlock('popDiv')" src="./images/close_div2.png" /></td>
                </tr>
                <tr>
                    <td colspan="2">&nbsp;</td>
                </tr>
                <tr>
                    <th nowrap style="width:40%;">科子細目代碼：</th>
                    <td nowrap style="width:60%;">
                        <select size="1" name="ac_no_2" id="ac_no_2">
                            ${OPTION_LIST_2}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input type="Button" value=" ok " onClick="top.setBlockValue('ex_ac_no','ac_no_2'); top.hideBlock('popDiv');" class="btConfirm">
                    </td>
                </tr>
            </table>
        </div>
        <!--List -->
        <table width="60%" id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
            <tr>
                <th nowrap class="list_th" width="5%">
                    <input type="checkbox" name="ex_selectAll" id="allcheck" value="Y" onChange="selectAll();" style="color:blue">執行&nbsp;
                </th>
                <th nowrap class="list_th">科子細目</th>
                <th nowrap class="list_th">會計科目名稱</th>
                <th nowrap class="list_th">會計科目簡稱</th>
                <!-- <th nowrap class="list_th">需待沖<br>聯註記</th> -->
                <!-- <th nowrap class="list_th">待沖傳票<br>銷帳鍵值種類</th> -->
                <!-- <th nowrap class="list_th">產生借方<br>待沖聯註記</th> -->
                <!-- <th nowrap class="list_th">產生貸方<br>待沖聯註記</th> -->
                <!-- <th nowrap class="list_th">產生聯行<br>報單註記</th> -->
            </tr>
            <!-- BEGIN DYNAMIC : DETAIL -->
            <tr>
                <td nowrap class="list_no" rowspan="2">
                    <span class="dsp_flag">${ok_flag}</span> ${SER_NUM}
                    <input type="checkbox" name="opt" value="${ser_num}" ${opt_on} ${opt_disabled}/>
                    <input type="hidden" name="opt_disabled" value="${opt_disabled}" />
                    <input type="hidden" name="rowid" value="${rowid}" />
                    <input type="hidden" name="ser_num" value="${ser_num}" />
                </td>
            </tr>
            <tr>
                <td nowrap class="list_ll"> ${ac_no}&nbsp; </td>
                <td nowrap class="list_ll"> ${ac_full_name}&nbsp; </td>
                <td nowrap class="list_ll"> ${ac_brief_name}&nbsp; </td>
                <!-- <td nowrap class="list_ll"> ${memo3_flag}&nbsp; </td> -->
                <!-- <td nowrap class="list_ll"> ${memo3_kind}&nbsp; </td> -->
                <!-- <td nowrap class="list_ll"> ${dr_flag}&nbsp; </td> -->
                <!-- <td nowrap class="list_ll"> ${cr_flag}&nbsp; </td> -->
                <!-- <td nowrap class="list_ll"> ${brn_rpt_flag}&nbsp; </td> -->
                <input type="hidden" name="ac_no" value="${ac_no}">
                <input type="hidden" name="ac_full_name" value="${ac_full_name}">
                <input type="hidden" name="ac_brief_name" value="${ac_brief_name}">
                <input type="hidden" name="memo3_flag" value="${memo3_flag}">
                <input type="hidden" name="memo3_kind" value="${memo3_kind}">
                <input type="hidden" name="dr_flag" value="${dr_flag}">
                <input type="hidden" name="cr_flag" value="${cr_flag}">
                <input type="hidden" name="brn_rpt_flag" value="${brn_rpt_flag}">
                <input type="hidden" name="online_update_flag" value="${online_update_flag}">
                <input type="hidden" name="write_off_flag" value="${write_off_flag}">
                <input type="hidden" name="count_flag" value="${count_flag}">
                <input type="hidden" name="neuter_flag" value="${neuter_flag}">
                <input type="hidden" name="asset_p_flag" value="${asset_p_flag}">
                <input type="hidden" name="crt_date" value="${crt_date}">
                <input type="hidden" name="crt_user" value="${crt_user}">
            </tr>
            <!-- END DYNAMIC : DETAIL -->
        </table>
        <input type="hidden" name="data_k1" value="">
        <input type="hidden" name="data_k2" value="">
        <input type="hidden" name="data_k3" value="">
        <input type="hidden" name="HIDE" value="${HIDE_DATA}">
        <input type="hidden" name="pageType" value="cond">
    </form>
</body>

</html>
<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript" src="js/AJAXFunction_11.js"></script>
<script language="JavaScript">
tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>
<script language="javascript">
top.refreshButton2('0');
top.pageRows = "999";


function validateInput() {
    if (!top.checkFormat()) { return false; }
    if (top.actionCode == "X") {
        top.respLevel = 1;
        top.respHtml = "genp0210_detl";
    }

    if (top.actionCode == "S2") {
        if (!chkdata()) {
            return false;
        }
        if (confirm("是否執行作業?!") === false) {
            return false;
        }
    }

    return true;
}

function detailScreen(serNum, parm, parm2, parm3) {
    top.respLevel = 1;
    top.currRows = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    top.respHtml = "genp0210_detl";
    top.submitControl('S');
    return true;
}
//全選
function selectAll() {
	 var opt_select =document.dataForm.ex_selectAll.checked;
   var aElems = document.getElementsByName("opt");
   for ( var i=0;  i < aElems.length; i++ ) 
   {
		if  ( aElems[i].type == "checkbox" && aElems[i].disabled==false) {
			aElems[i].checked = opt_select;
		}
   }
    return;
}

function chkdata() {
    var seq = 0;
    var agy = document.dataForm.opt;
    var ll = agy.length;
    if (typeof ll === 'undefined') {
        if (agy.checked) { seq++; }
    } else {
        for (var i = 0; i < ll; i++) {
            if (agy[i].checked) {
                seq++;

            }
        }
    }

    if (seq == 0) {
        //alert("請至少勾選一筆資料!");
        alert("未選取執行資料!");
        return false;
    }
    return true;
}

/* 處理　PUPOP BLOCK */
function processVendorCode() {
    var vendorNo = document.dataForm.ex_ac_no.value;
    
    if (vendorNo.length < 2) { alert("請輸入至少兩碼"); return false; }
    resetJSON();
    autoJSON = false;
    addJSON("ex_ac_no", vendorNo);
    top.actionCode = "AJAX";
    // top.methodName = "actionFunction"; // 20200102 updated for archit.  change
    processAJAX();
    return true;
}

function ajaxResponse() {
    var vendorNo = document.dataForm.ex_ac_no.value;
    var vendorList = document.getElementById("ac_no_2");

    for (var i = vendorList.length - 1; i >= 0; i--) { vendorList.remove(i); }

    var len = getJSONlength("OPTION_TEXT");
    for (var i = 0; i < len; i++) {
        vendorList.options.add(new Option(getJSONvalue("OPTION_TEXT", i), getJSONvalue("OPTION_VALUE", i)));
        if (vendorList.options[i].value == vendorNo && vendorNo.length > 0) { vendorList.options[i].selected = true; }
    }

    top.popupBlock('popDiv');
}

</script>