<html>
<head>
<title>NCCC紅利抵用參數 (指定特店) –主管覆核-V.2018-0709-ryan-[Initial]
								  -V.2020-0805-Amber-[Update]
								  -V.2020-0827-Amber-[Update]
</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
<script language="JavaScript" src="js/jquery.js"></script>
<link rel="stylesheet" href="js/Calendar/calendar.css">
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>
<link rel="stylesheet" href="js/jquery-ui.min.css" />
<script language="JavaScript" src="js/jquery-2.2.2.min.js"></script>
<script language="JavaScript" src="js/jquery-ui.min.js"></script>
</head>

<body background="${water_mark}" >
<form  name="dataForm" method="post" action="" >

<div id="condBlock">
<!--COND -->
<table width="50%" border="0" cellspacing="0" cellpadding="4">
	<tr>
		<td nowrap>&nbsp;建檔人員:
			<input type="text" class="col_any" zEdit="any" name="ex_userid" value="${ex_userid}"
      		maxlength="10" size="12"/>
		</td>
   		<td nowrap rowspan="3">&nbsp;  
			<input type="Button" name="btnQuery" value="查詢" onClick="return top.submitControl('Q')" class="btQuery" >&nbsp;&nbsp;
			<input type="Button" name="btnClear" value="清除" onClick="return top.submitControl('L')" class="btClear" >&nbsp;&nbsp;
			<input type="Button" name="btnAdd"   value="執行" onClick="return top.submitControl('C')" class="btAdd" >&nbsp;&nbsp;
		</td>
	</tr>
	<tr>
		<td nowrap>&nbsp;建檔期間：
      		<input type="text" class="col_date" name="ex_date1" value="${ex_date1}"
         		zeditType="date,ymd" MaxLength=8 size=8 />
       		<script language="JavaScript">
	        	new tcal ({'formname': 'dataForm','controlname': 'ex_date1'});
	    	</script>
      		--   
      		<input type="text" class="col_date" name="ex_date2" value="${ex_date2}"
         		zeditType="date,ymd" MaxLength=8 size=8 />
       		<script language="JavaScript">
	        	new tcal ({'formname': 'dataForm','controlname': 'ex_date2'});
	    	</script>
   		</td>
	</tr>
	<tr>
		<td nowrap >&nbsp;特店代號:
			<input type="text" class="col_any" zEdit="any" name="ex_mchtno1" value="${ex_mchtno1}"
      		maxlength="15" size="17"/>
      		--
      		<input type="text" class="col_any" zEdit="any" name="ex_mchtno2" value="${ex_mchtno2}"
      		maxlength="15" size="17"/>
		</td>
	</tr>
</table>
</div>
<hr>

<!--List -->
<table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
	<tr>
		<th nowrap class="list_th" width="5%">
			<input type="checkbox" name="ex_selectAll" id="allcheck" value="Y" onChange="selectAll();" style="color:blue"><span class="ex_selectAll">覆核&nbsp;</span></th>
		<th nowrap class="list_th"></th>
		<th nowrap class="list_th">特店代號</th>
		<th nowrap class="list_th">序號</th>
		<th nowrap class="list_th">有效期間</th>
		<th nowrap class="list_th">最低交易金額</th>
		<th nowrap class="list_th"></th>
		<th nowrap class="list_th">最高扣抵比例</th>
		<th nowrap class="list_th">最高扣抵金額</th>
		<th nowrap class="list_th">單位兌換點數</th>
		<th nowrap class="list_th">單位兌換金額</th>
		<th nowrap class="list_th">01帳戶</th>
		<th nowrap class="list_th">03帳戶</th>
		<th nowrap class="list_th">06帳戶</th>
<!--		<th nowrap class="list_th">05帳戶</th>
		<th nowrap class="list_th">02帳戶</th>     -->
	</tr>
<!-- BEGIN DYNAMIC : DETAIL -->
	<tr>
		<td nowrap class="list_no" rowspan="2">
			<span class="col_key">${ok_flag}</span>
			<input type="checkbox" name="opt" class="check"  value="${ser_num}" ${opt_on} ${opt_disabled}/>
			<input type="hidden" name="opt_disabled" value="${opt_disabled}" />
			${SER_NUM}&nbsp;
			<!--  
			 <span  class="dsp_flag">${ok_flag}</span>
      		<input type="checkbox" name="opt" value="${ser_num}" />${SER_NUM}&nbsp;
      		<input type=hidden name="ser_num" value="${ser_num}" />  -->
			<input type="hidden" name="rowid" value="${rowid}">
			<input type="hidden" name="ser_num" value="${ser_num}">
			<input type="hidden" name="mod_seqno" value="${mod_seqno}">
			<input type="hidden" name="rdm_mchtno" value="${rdm_mchtno}">
			<input type="hidden" name="rdm_seqno" value="${rdm_seqno}">
			<input type="hidden" name="rdm_strdate" value="${rdm_strdate}">
			<input type="hidden" name="rdm_enddate" value="${rdm_enddate}">
			<input type="hidden" name="rdm_destamt" value="${rdm_destamt}">
			<input type="hidden" name="rdm_discrate" value="${rdm_discrate}">
			<input type="hidden" name="rdm_discamt" value="${rdm_discamt}">
			<input type="hidden" name="rdm_unitpoint" value="${rdm_unitpoint}">
			<input type="hidden" name="rdm_unitamt" value="${rdm_unitamt}">
			<input type="hidden" name="db_type01" value="${db_type01}">
			<input type="hidden" name="db_type03" value="${db_type03}">
			<input type="hidden" name="db_type06" value="${db_type06}">
<!--			<input type="hidden" name="db_type05" value="${db_type05}">
			<input type="hidden" name="db_type02" value="${db_type02}">     -->
			<input type="hidden" name="crt_no" value="${crt_no}">
			<input type="hidden" name="crt_user" value="${crt_user}">
			<input type="hidden" name="crt_date" value="${crt_date}">
			<input type="hidden" name="rdm_binflag" value="${rdm_binflag}">
			<input type="hidden" name="rdm_discratefg" value="${rdm_discratefg}">
			<input type="hidden" name="mod_user" value="${mod_user}">
			<input type="hidden" name="" value="${}">
			
		</td>
		<td nowrap class="list_ll" rowspan="2"><input type="Button" class="btOther" name="button1"  value="複製特店"  
               	onClick="return buttonclicked('${rdm_mchtno}','${rdm_seqno}')" />
        </td>
	</tr>
	<tr onclick="detailScreen('${SER_NUM}','${rowid}','','')" style="cursor:hand">
		
		<td nowrap class="list_ll">${rdm_mchtno}&nbsp;</td>
		<td nowrap class="list_ll">${rdm_seqno}&nbsp;
		<td nowrap class="list_ll">${rdm_strdate.YMD}--${rdm_enddate.YMD}&nbsp;</td>
		<td nowrap class="list_rr">&nbsp;${rdm_destamt.(999)}</td>
		<td nowrap class="list_ll">${rdm_discratefg}&nbsp;</td>
		<td nowrap class="list_ll">${rdm_discrate}&nbsp;</td>
		<td nowrap class="list_rr">&nbsp;${rdm_discamt.(999)}</td>
		<td nowrap class="list_ll">${rdm_unitpoint}&nbsp;</td>
		<td nowrap class="list_rr">&nbsp;${rdm_unitamt.(999)}</td>
		<td nowrap class="list_ll">${db_type01}&nbsp;</td>
		<td nowrap class="list_ll">${db_type03}&nbsp;</td>
		<td nowrap class="list_ll">${db_type06}&nbsp;</td>
<!-- 	<td nowrap class="list_ll">${db_type05}&nbsp;</td>
		<td nowrap class="list_ll">${db_type02}&nbsp;</td>   -->	
	</tr>
<!-- END DYNAMIC : DETAIL -->
</table>   
<div id="dialog" title="同群組特店代號">
<!--List -->
<table id="table2" class="sortable" border="0" cellspacing="0" cellpadding="4">
	<tr>
		<th nowrap class="list_th" width="5%">No</th>
		<th nowrap class="list_th">複製特店代號[名稱]</th>
	</tr>
<!-- BEGIN DYNAMIC : DETAIL -->
	<tr style="cursor:hand">
		<td nowrap class="list_ll">${SER_NUM}&nbsp;</td>
		<td nowrap class="list_ll">${cbc_mcht}&nbsp;</td>
	</tr>
<!-- END DYNAMIC : DETAIL -->
</table>   
</div>
<input type="hidden"  name="data_k1" value="" >
<input type="hidden"  name="data_k2" value="" >
<input type="hidden"  name="data_k3" value="" >
<input type="hidden"  name="data_k4" value="${data_k4}" >
<input type="hidden"  name="MOD_PGM" value="mktp4090">
<input type="hidden"  name="HIDE"  value="${HIDE_DATA}">
<input type="hidden"  name="pageType"  value="cond">
</form>
</body>
</html>

<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
	tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>

<script language="javascript">

 top.refreshButton2('0');
 top.pageRows="9999";
 
 document.dataForm.ex_userid.focus();

 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }

    if ( top.actionCode == "X" ) {
        top.respLevel = 1;
        top.respHtml = "mktp4090_detl"; 
    }

    if ( top.actionCode == "C" ) {
    	if ( !chkdata() ) { 
    		return false; 
    	} 
    	if (confirm("是否執行 紅利積點扣抵資料放行處理 ?") === false) {
            return false;
        } 
    }
    return true;
  }

 function detailScreen(serNum,parm,parm2,parm3) { 
    top.respLevel = 1;
    top.currRows  = serNum;
    document.dataForm.data_k1.value = parm;
    top.respHtml  = "mktp4090_detl";
    top.submitControl('S');
    return true;
  }
//全選
 function selectAll() {
 	 var opt_select =document.dataForm.ex_selectAll.checked;
    var aElems = document.getElementsByName("opt");
    for ( var i=0;  i < aElems.length; i++ ) 
    {
 		if  ( aElems[i].type == "checkbox" && aElems[i].disabled==false) {
 			aElems[i].checked = opt_select;
 		}
    }
    return;
 }
 function chkdata() {
	 var agy =0;
	 $("input[name=opt]").each(function (){
		 if($(this).prop("checked")==true){
			 agy++; 
		 }
	 })
	 if(agy == 0){
		 alert("未選取"+$(".ex_selectAll").text()+"資料!");
		 return false;
 	 }
	 return true;
 }
 
 function buttonclicked(as_mcht_no,al_seq_no){
	// top.respHtml  = "mktp4090";
	document.dataForm.data_k2.value = as_mcht_no;
    document.dataForm.data_k3.value = al_seq_no;
	top.submitControl('S2');

 }
 
 function dialog_open(){
	 	$( "#dialog" ).dialog( "open" );
	}

	$( "#dialog" ).dialog({
	  autoOpen: false,
	  height: 300,
	  width: 600,
	});
	
$(document).ready(function() {
	if($("input[name=data_k4]").val()=='Y'){
		dialog_open();
	}
	$("input[name=data_k4]").val("");
})
</script>
