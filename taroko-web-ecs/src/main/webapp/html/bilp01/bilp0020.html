<!--**************************************************************************-->
<!--                                                                          -->
<!--                              MODIFICATION LOG                            -->
<!--                                                                          -->
<!--    DATE    VERSION     AUTHOR                 DESCRIPTION                -->
<!-- ---------  --------  -----------    ------------------------------------ -->
<!-- 109-01-06  V1.00.02  Ru Chen        modify AJAX                          -->
<!--                                                                          -->
<!--**************************************************************************-->
<html>

<head>
    <title>郵購/分期付款特約商店基本資料覆核作業-107-08-23-V1.00.01-AndyLiu-[Update]</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="css/ecsBank.css" type="text/css">
</head>
<script language="JavaScript" src="js/jquery.js"></script>

<body background="${water_mark}">
    <form name="dataForm" method="post" action="">
        <div id="condBlock">
           <!-- ${#PLUGIN:htmcomm_plugin.apr_user} -->
            <!--COND -->
            <table width="70%" border="0" cellspacing="0" cellpadding="4">
                <tr>
                    <td nowrap>&nbsp;特店代號:
                        <input class="field_style" type="text" name="ex_merchant" size="15" maxlength="15" value="${ex_merchant}">&nbsp;&nbsp;
                        <input type="Button"   value="..." onclick="processVendorCode()" class="btAdd_detl" />
                    </td>
                    <td nowrap>&nbsp;統一編號:
                        <input type="text" class="col_text" name="ex_uniform_no" value="${ex_uniform_no}" zEdit="number" maxlength=8 size=10 />
                    </td>
                </tr>    
                <tr>
                    <td nowrap>&nbsp;鍵檔人員:
                        <input type="text" class="col_text" name="ex_crt_user" value="${ex_crt_user}" zEdit="alphanum" maxlength=8 size=10 />
                    </td>        
                    <td nowrap>&nbsp;
                        <input type="Button"   value="查詢" onClick="return top.submitControl('Q')" class="btQuery">&nbsp;&nbsp;
                        <input type="Button"   value="清除" onClick="return top.submitControl('L')" class="btClear">&nbsp;&nbsp;
                        <input type="Button"   value="執行" onClick="return top.submitControl('S2')" class="btAdd">&nbsp;&nbsp;
                    </td>
                </tr>
            </table>
            <!-- 動態 BLOCK 視窗控制 -->
            <div id="disDiv" class="disScreen"></div>
            <div id="popDiv" class="popup1">
                <table id="popup2" style="top:-40px; left:350px; width:300px; height:100px;">
                    <tr>
                        <td colspan="2"><img onClick="top.hideBlock('popDiv')" src="./images/close_div2.png" /></td>
                    </tr>
                    <tr>
                        <td colspan="2">&nbsp;</td>
                    </tr>
                    <tr>
                        <th nowrap style="width:40%;">特店代號：</th>
                        <td nowrap style="width:60%;">
                            <select size="1" name="merchant_2" id="merchant_2">
                                ${OPTION_LIST_2}
                            </select>
                        </td>
                    </tr>                    
                    <tr>
                        <td colspan="2">
                            <input type="Button" value=" ok " onClick="top.setBlockValue('ex_merchant','merchant_2'); top.hideBlock('popDiv');" class="btConfirm">
                        </td>
                    </tr>
                </table>
            </div>
        </div>
            <hr>
            <!--List -->
            <table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
                <tr>
                    <th nowrap class="list_th" width="5%">
                        <input type="checkbox" name="ex_selectAll" id="allcheck" value="Y" onChange="selectAll();" style="color:blue">放行&nbsp;
                    </th>
                    <th nowrap class="list_th">已佔額</th>
                    <th nowrap class="list_th">特店代號</th>
                    <th nowrap class="list_th">統一編號</th>
                    <th nowrap class="list_th">申</th>
                    <th nowrap class="list_th">購書編號</th>
                    <th nowrap class="list_th">特店英文名稱</th>
                    <th nowrap class="list_th">特店狀態</th>
                    <th nowrap class="list_th">特店<br>郵區</th>
                    <th nowrap class="list_th">特店住址</th>
                    <th nowrap class="list_th">特店中文名稱</th>
                    <th nowrap class="list_th">負責人姓名</th>
                    <th nowrap class="list_th">特店類型</th>
                    <th nowrap class="list_th">當期分期款納入<br>最低應繳金額比例</th>
                    <th nowrap class="list_th">鍵檔人員</th>
                </tr>
                <!-- BEGIN DYNAMIC : DETAIL -->
                <tr>
                    <td nowrap class="list_no" rowspan="2">
                        <span class="dsp_flag">${ok_flag}</span> ${SER_NUM}
                        <input type="checkbox" name="opt" value="${ser_num}" ${opt_disabled}/>
                        <input type="hidden" name="opt_disabled" value="${opt_disabled}" />
                        <input type="hidden" name="rowid" value="${rowid}" />
                        <input type="hidden" name="ser_num" value="${ser_num}" />
                    </td>
                </tr>
                <tr onclick="detailScreen('${SER_NUM}','${mcht_no}','','')" style="cursor:hand">
                    <td nowrap class="list_cc" style="color: red"> ${loan_flag}&nbsp; </td>
                    <td nowrap class="list_ll"> ${mcht_no}&nbsp; </td>
                    <td nowrap class="list_ll"> ${uniform_no}&nbsp; </td>
                    <td nowrap class="list_ll"> ${contract_head}&nbsp; </td>
                    <td nowrap class="list_ll"> ${contract_curr_no}&nbsp; </td>
                    <td nowrap class="list_ll"> ${mcht_eng_name}&nbsp; </td>
                    <td nowrap class="list_ll"> ${db_mcht_status}&nbsp; </td>
                    <td nowrap class="list_ll"> ${mcht_zip}&nbsp; </td>
                    <td nowrap class="list_ll"> ${mcht_address}&nbsp; </td>
                    <td nowrap class="list_ll"> ${mcht_chi_name}&nbsp; </td>
                    <td nowrap class="list_ll"> ${owner_name}&nbsp; </td>
                    <td nowrap class="list_ll"> ${db_mcht_type}&nbsp; </td>
                    <td nowrap class="list_cc"> ${mp_rate}&nbsp; </td>
                    <td nowrap class="list_ll"> ${crt_user}&nbsp; </td>
                    <input type="hidden" name="mcht_no" value="${mcht_no}" />
                    <input type="hidden" name="uniform_no" value="${uniform_no}" />
                    <input type="hidden" name="sign_date" value="${sign_date}" />
                    <input type="hidden" name="forced_flag" value="${forced_flag}" />
                    <input type="hidden" name="mcc_code" value="${mcc_code}" />
                    <input type="hidden" name="broken_date" value="${broken_date}" />
                    <input type="hidden" name="mcht_status" value="${mcht_status}" />
                    <input type="hidden" name="mcht_eng_name" value="${mcht_eng_name}" />
                    <input type="hidden" name="mcht_chi_name" value="${mcht_chi_name}" />
                    <input type="hidden" name="mcht_address" value="${mcht_address}" />
                    <input type="hidden" name="mcht_zip" value="${mcht_zip}" />
                    <input type="hidden" name="owner_name" value="${owner_name}" />
                    <input type="hidden" name="owner_id" value="${owner_id}" />
                    <input type="hidden" name="mcht_tel1" value="${mcht_tel1}" />
                    <input type="hidden" name="mcht_tel1_1" value="${mcht_tel1_1}" />
                    <input type="hidden" name="mcht_tel1_2" value="${mcht_tel1_2}" />
                    <input type="hidden" name="mcht_tel2" value="${mcht_tel2}" />
                    <input type="hidden" name="mcht_tel2_1" value="${mcht_tel2_1}" />
                    <input type="hidden" name="mcht_tel2_2" value="${mcht_tel2_2}" />
                    <input type="hidden" name="mcht_fax1" value="${mcht_fax1}" />
                    <input type="hidden" name="mcht_fax1_1" value="${mcht_fax1_1}" />
                    <input type="hidden" name="mcht_fax2" value="${mcht_fax2}" />
                    <input type="hidden" name="mcht_fax2_1" value="${mcht_fax2_1}" />
                    <input type="hidden" name="e_mail" value="${e_mail}" />
                    <input type="hidden" name="contract_name" value="${contract_name}" />
                    <input type="hidden" name="assign_acct" value="${assign_acct}" />
                    <input type="hidden" name="bank_name" value="${bank_name}" />
                    <input type="hidden" name="oth_bank_id" value="${oth_bank_id}" />
                    <input type="hidden" name="oth_bank_acct" value="${oth_bank_acct}" />
                    <input type="hidden" name="oth_bank_name" value="${oth_bank_name}" />
                    <input type="hidden" name="clr_bank_id" value="${clr_bank_id}" />
                    <input type="hidden" name="mcht_acct_name" value="${mcht_acct_name}" />
                    <input type="hidden" name="mcht_city" value="${mcht_city}" />
                    <input type="hidden" name="mcht_country" value="${mcht_country}" />
                    <input type="hidden" name="mcht_state" value="${mcht_state}" />
                    <input type="hidden" name="confirm_flag" value="${confirm_flag}" />
                    <input type="hidden" name="contract_head" value="${contract_head}" />
                    <input type="hidden" name="contract_curr_no" value="${contract_curr_no}" />
                    <input type="hidden" name="mcht_type" value="${mcht_type}" />
                    <input type="hidden" name="loan_flag" value="${loan_flag}" />
                    <input type="hidden" name="mp_rate" value="${mp_rate}" />
                    <input type="hidden" name="mcht_board_name" value="${mcht_board_name}" />
                    <input type="hidden" name="mcht_open_addr" value="${mcht_open_addr}" />
                    <input type="hidden" name="mcht_capital" value="${mcht_capital}" />
                    <input type="hidden" name="mcht_setup_date" value="${mcht_setup_date}" />
                    <input type="hidden" name="tx_type" value="${tx_type}" />
                    <input type="hidden" name="advance_flag" value="${advance_flag}" />
                    <input type="hidden" name="chain_type" value="${chain_type}" />
                    <input type="hidden" name="mcht_property" value="${mcht_property}" />
                    <input type="hidden" name="card_type_name" value="${card_type_name}" />
                    <input type="hidden" name="pos_flag" value="${pos_flag}" />
                    <input type="hidden" name="video_flag" value="${video_flag}" />
                    <input type="hidden" name="rsecind_kind" value="${rsecind_kind}" />
                    <input type="hidden" name="rsecind_flag" value="${rsecind_flag}" />
                    <input type="hidden" name="tx_post" value="${tx_post}" />
                    <input type="hidden" name="post_jcic" value="${post_jcic}" />
                    <input type="hidden" name="trans_flag" value="${trans_flag}" />
                    <input type="hidden" name="gift_file_name" value="${gift_file_name}" />
                    <input type="hidden" name="gift_file_passwd" value="${gift_file_passwd}" />
                    <input type="hidden" name="gift_file_dir" value="${gift_file_dir}" />
                    <input type="hidden" name="installment_delay" value="${installment_delay}" />
                    <input type="hidden" name="stmt_inst_flag" value="${stmt_inst_flag}" />
                    <input type="hidden" name="crt_user" value="${crt_user}" />
                    <input type="hidden" name="crt_date" value="${crt_date}" />
                    <input type="hidden" name="mod_seqno" value="${mod_seqno}" />
                    <input type="hidden" name="h_mod_seqno" value="${h_mod_seqno}" />
                    <input type="hidden" name="chk_online" value="${chk_online}" />
                </tr>
                <!-- END DYNAMIC : DETAIL -->
            </table>
            <input type="hidden" name="data_k1" value="">
            <input type="hidden" name="data_k2" value="">
            <input type="hidden" name="data_k3" value="">
            <input type="hidden" name="HIDE" value="${HIDE_DATA}">
            <input type="hidden" name="pageType" value="cond">
            <input type="hidden" name="MOD_PGM" value="bilp0020">
    </form>
</body>

</html>
<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript" src="js/AJAXFunction_11.js"></script>
<script language="JavaScript">
tigra_tables('table1', 1, 0, '', '', '#ffcc66', '#cccccc');
</script>
<script language="javascript">
top.refreshButton2('0');
top.pageRows = "20";


function validateInput() {
    if (!top.checkFormat()) { return false; }
    if (top.actionCode == "X") {
        top.respLevel = 1;
        top.respHtml = "bilp0020_detl";
    }

    if (top.actionCode == "S2") {
        if (!chkdata()) {
            return false;
        }
        if (confirm("是否執行作業?!") === false) {
            return false;
        }
    }

    return true;
}

function detailScreen(serNum, parm, parm2, parm3) {
    top.respLevel = 1;
    top.currRows = serNum;
    document.dataForm.data_k1.value = parm;
    document.dataForm.data_k2.value = parm2;
    document.dataForm.data_k3.value = parm3;
    top.respHtml = "bilp0020_detl";
    top.submitControl('S');
    return true;
}
//全選
function selectAll() {
    var aElements = document.dataForm.getElementsByTagName("input");
    for (var i = 0; i < aElements.length; i++) {
        if (aElements[i].type == "checkbox" && aElements[i].disabled == false) {
            aElements[i].checked = document.dataForm.ex_selectAll.checked;
        }
    }

    return;
}

function chkdata() {
    var seq = 0;
    var agy = document.dataForm.opt;
    var ll = agy.length;
    if (typeof ll === 'undefined') {
        if (agy.checked) { seq++; }
    } else {
        for (var i = 0; i < ll; i++) {
            if (agy[i].checked) {
                seq++;

            }
        }
    }

    if (seq == 0) {
        //alert("請至少勾選一筆資料!");
        alert("未選取執行資料!");
        return false;
    }
    return true;
}
/* 處理　PUPOP BLOCK */
function processVendorCode() {
    var vendorNo = document.dataForm.ex_merchant.value;

    if (vendorNo.length < 2) { alert("請輸入至少兩碼"); return false; }
    resetJSON();
    autoJSON = false;
    addJSON("ex_merchant", vendorNo);
    top.actionCode = "AJAX";
    //20200106 modify AJAX
    //top.methodName = "actionFunction";
    processAJAX();
    return true;
}

function ajaxResponse() {
    var vendorNo = document.dataForm.ex_merchant.value;
    var vendorList = document.getElementById("merchant_2");

    for (var i = vendorList.length - 1; i >= 0; i--) { vendorList.remove(i); }

    var len = getJSONlength("OPTION_TEXT");
    for (var i = 0; i < len; i++) {
        vendorList.options.add(new Option(getJSONvalue("OPTION_TEXT", i), getJSONvalue("OPTION_VALUE", i)));
        if (vendorList.options[i].value == vendorNo && vendorNo.length > 0) { vendorList.options[i].selected = true; }
    }

    top.popupBlock('popDiv');
}
</script>