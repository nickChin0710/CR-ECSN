<!--**************************************************************************-->
<!--                                                                          -->
<!--                              MODIFICATION LOG                            -->
<!--                                                                          -->
<!--    DATE    VERSION     AUTHOR                 DESCRIPTION                -->
<!-- ---------  --------  -----------    ------------------------------------ -->
<!-- 109-01-06  V1.00.02  Ru Chen        modify AJAX                          -->
<!--                                                                          -->
<!--**************************************************************************-->
<html>

<head>
    <title>郵購/分期付款撥款明細表-107-08-23-V1.00.01-AndyLiu-[Update]</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="css/ecsBank.css" type="text/css">
    <link rel="stylesheet" href="js/Calendar/calendar.css">
</head>
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>

<body background="${water_mark}">
    <form name="dataForm" method="post" action="">
        <div id="condBlock">
            <table width="80%" border="0" cellspacing="0" cellpadding="4">
                <tr>
                    <td nowrap colspan=6>&nbsp;首期入帳日期:
                        <input type="text" class="col_date" name="exDateS" value="${exDateS}" zEdit="date,yyyymmdd" maxlength="8" size="8" zRequire ="k"/>
                        <script language="JavaScript">
                        new tcal({
                            'formname': 'dataForm',
                            'controlname': 'exDateS'
                        });
                        </script>
                        --
                        <input type="text" class="col_date" name="exDateE" value="${exDateE}" zEdit="date,yyyymmdd" maxlength="8" size="8" />
                        <script language="JavaScript">
                        new tcal({
                            'formname': 'dataForm',
                            'controlname': 'exDateE'
                        });
                        </script>&nbsp;
                    </td>
                    <td nowrap colspan=6>&nbsp;
                        <input type="Button"   ${btnQuery_disable} value="查詢" onClick="return top.submitControl('Q')" class="btQuery">&nbsp;&nbsp;
                        <input type="Button"   ${btnClear_disable} value="清除" onClick="return top.submitControl('L')" class="btClear">&nbsp;&nbsp;
                        <!-- <img height="25" src="images/Excel.jpg" ${btnExcel_disable} style="cursor:hand;" onClick="top.submitControl('XLS');" onmouseout="top.light_img(this);" onmouseover="top.dark_img(this);">&nbsp;&nbsp; -->
                        <img height="25" src="images/Pdf.jpg" ${btnPDF_disable} style="cursor:hand;" onClick="top.submitControl('PDF');" onmouseout="top.light_img(this);" onmouseover="top.dark_img(this);">&nbsp;&nbsp;
                    </td>
                </tr>
                <tr>
                    <td nowrap>&nbsp;特店代號:
                        <input class="field_style" type="text" name="ex_merchant" size="21" maxlength="20" value="${ex_merchant}">&nbsp;&nbsp;
                        <input type="Button"   value="..." onclick="processVendorCode()" class="btAdd_detl" />&nbsp;
                    </td>
                    <td nowrap colspan=6>&nbsp;選項:
                        <input type="radio" value="1" name="ex_op" ${ex_op-1} />ONUS
                        <input type="radio" value="4" name="ex_op" ${ex_op-4} />NCCC
                        <input type="radio" value="2" name="ex_op" ${ex_op-2} />人工
                        <input type="radio" value="3" name="ex_op" ${ex_op-3}${DEFAULT-ex_op} />全部&nbsp;
                    </td>
                </tr>
                <tr>
                    <td nowrap colspan=12>&nbsp;類別:
                        <input type="radio" value="1" name="ex_kind" ${ex_kind-1} />分期-全部
                        <input type="radio" value="2" name="ex_kind" ${ex_kind-2} />分期-折抵
                        <input type="radio" value="3" name="ex_kind" ${ex_kind-3} />分期-全折
                        <input type="radio" value="4" name="ex_kind" ${ex_kind-4} />分期-無折
                        <input type="radio" value="5" name="ex_kind" ${ex_kind-5} />郵購-全部
                        <input type="radio" value="6" name="ex_kind" ${ex_kind-6} />郵購-折抵
                        <input type="radio" value="7" name="ex_kind" ${ex_kind-7} />郵購-全折
                        <input type="radio" value="8" name="ex_kind" ${ex_kind-8} />郵購-無折
                        <input type="radio" value="9" name="ex_kind" ${ex_kind-9}${DEFAULT-ex_kind} />全部&nbsp;
                    </td>
                </tr>
            </table>
        </div>
        <hr>
        <!-- 動態 BLOCK 視窗控制 -->
        <div id="disDiv" class="disScreen"></div>
        <div id="popDiv" class="popup1">
            <table id="popup2" style="top:-40px; left:350px; width:300px; height:100px;">
                <tr>
                    <td colspan="2"><img onClick="top.hideBlock('popDiv')" src="./images/close_div2.png" /></td>
                </tr>
                <tr>
                    <td colspan="2">&nbsp;</td>
                </tr>
                <tr>
                    <th nowrap style="width:40%;">特店代號：</th>
                    <td nowrap style="width:60%;">
                        <select size="1" name="merchant_2" id="merchant_2">
                            ${OPTION_LIST_2}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input type="Button" value=" ok " onClick="top.setBlockValue('ex_merchant','merchant_2'); top.hideBlock('popDiv');" class="btConfirm">
                    </td>
                </tr>
            </table>
        </div>
        <!-- 明細============================ -->
        <table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
            <tr>
                <th nowrap class="list_th" width="5%">No&nbsp;</th>
                <th nowrap class="list_th">特店代號</th>
                <th nowrap class="list_th">特店中文名稱</th>
                <th nowrap class="list_th">總期數</th>
                <!--  <th nowrap class="list_th">關係人</th>  -->
                <th nowrap class="list_th">首期入帳日期</th>
                <th nowrap class="list_th">申購書編號</th>
                <th nowrap class="list_th">序號</th>
                <th nowrap class="list_th">交易卡號</th>
                <th nowrap class="list_th">商品代號</th>
                <th nowrap class="list_th">商品名稱</th>
                <th nowrap class="list_th">EDC</th>
                <th nowrap class="list_th">訂購數量</th>
                <th nowrap class="list_th">*商品單價</th>
                <th nowrap class="list_th">+額外費用</th>
                <th nowrap class="list_th">-折抵金額</th>
                <th nowrap class="list_th">-折抵點數</th>
                <th nowrap class="list_th">-兌換券金額</th>
                <th nowrap class="list_th">=實付金額</th>
                <th nowrap class="list_th">手續費固定金額</th>
                <th nowrap class="list_th">手續費比率</th>
                <th nowrap class="list_th">手續費金額</th>
                <th nowrap class="list_th">當日退貨</th>
            </tr>
            <!-- BEGIN DYNAMIC : DETAIL -->
            <tr>
                <td nowrap class="list_no"> ${SER_NUM}&nbsp;</td>
                <td nowrap class="list_ll"> ${mcht_no} </td>
                <td nowrap class="list_ll"> ${mcht_chi_name} </td>
                <td nowrap class="list_cc"> ${install_tot_term} </td>
                <!-- <td nowrap class="list_ll"> ${fh_flag} </td>  -->
                <td nowrap class="list_ll"> ${first_post_date} </td>
                <td nowrap class="list_ll"> ${contract_no} </td>
                <td nowrap class="list_cc"> ${contract_seq_no} </td>
                <td nowrap class="list_cc"> ${card_no} </td>
                <td nowrap class="list_cc"> ${product_no} </td>
                <td nowrap class="list_ll"> ${product_name} </td>
                <td nowrap class="list_ll"> ${cps_flag} </td>
                <td nowrap class="list_rr"> ${qty} </td>
                <td nowrap class="list_rr"> ${tot_amt.(999)} </td>
                <td nowrap class="list_rr"> ${extra_fees.(999)} </td>
                <td nowrap class="list_rr"> ${amt_redeem.(999)} </td>
                <td nowrap class="list_rr"> ${point_redeem.(999)} </td>
                <td nowrap class="list_rr"> ${exchange_amt.(999)} </td>
                <td nowrap class="list_rr"> ${amt_temp.(999)} </td>
                <td nowrap class="list_rr"> ${fees_fix_amt.(999)} </td>
                <td nowrap class="list_rr"> ${fees_rate.(999)} </td>
                <td nowrap class="list_rr"> ${amt_all.(999)} </td>
                <td nowrap class="list_rr"> ${wk_curr_flag} </td>
                <input type="hidden" name="mcht_ct" value="${mcht_ct}">
                <input type="hidden" name="q_amt" value="${q_amt}">
                <input type="hidden" name="wk_curr_flag_amt" value="${wk_curr_flag_amt}">
                <input type="hidden" name="wk_curr_flag_cnt" value="${wk_curr_flag_cnt}">
                <input type="hidden" name="wk_curr_extra_fees" value="${wk_curr_extra_fees}">
                <input type="hidden" name="wk_curr_exchange_amt" value="${wk_curr_exchange_amt}">
                <input type="hidden" name="wk_curr_flag_fee" value="${wk_curr_flag_fee}">
                <input type="hidden" name="wk_curr_amt_temp" value="${wk_curr_amt_temp}">
                <input type="hidden" name="sum_cnt" value="${sum_cnt}">
                <input type="hidden" name="sum1" value="${sum1}">
                <input type="hidden" name="sum2" value="${sum2}">
                <input type="hidden" name="sum3" value="${sum3}">
                <input type="hidden" name="sum4" value="${sum4}">
                <input type="hidden" name="sum5" value="${sum5}">
                <input type="hidden" name="sum6" value="${sum6}">
                <input type="hidden" name="sum7" value="${sum7}">
            </tr>
            <!-- END DYNAMIC : DETAIL -->
        </table>
        <input type="hidden" name="HIDE" value="${HIDE_DATA}">
        <input type="hidden" name="pageType" value="cond">
        <input type="hidden" name="row_ct" value="${row_ct}">
        <input type="hidden" name="user_id" value="${user_id}">
        <input type="hidden" name="wk_temp" value="${wk_temp}">
        <input type="hidden" name="db_gp_key" value="${db_gp_key}">
    </form>
</body>

</html>
<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript" src="js/AJAXFunction_11.js"></script>
<script language="JavaScript">
tigra_tables('table1');
</script>
<script language="javascript">
top.refreshButton2('0');
top.pageRows = "20";
document.dataForm.exDateS.focus();

function validateInput() {

    if (!top.checkFormat()) {
        return false;
    }
    return true;
}

/* 處理　PUPOP BLOCK */
function processVendorCode() {
    var vendorNo = document.dataForm.ex_merchant.value;

    if (vendorNo.length < 2) { alert("請輸入至少兩碼"); return false; }
    resetJSON();
    autoJSON = false;
    addJSON("ex_merchant", vendorNo);
    top.actionCode = "AJAX";
    //20200106 modify AJAX
    //top.methodName = "actionFunction";
    processAJAX();
    return true;
}

function ajaxResponse() {
    var vendorNo = document.dataForm.ex_merchant.value;
    var vendorList = document.getElementById("merchant_2");

    for (var i = vendorList.length - 1; i >= 0; i--) { vendorList.remove(i); }

    var len = getJSONlength("OPTION_TEXT");
    for (var i = 0; i < len; i++) {
        vendorList.options.add(new Option(getJSONvalue("OPTION_TEXT", i), getJSONvalue("OPTION_VALUE", i)));
        if (vendorList.options[i].value == vendorNo && vendorNo.length > 0) { vendorList.options[i].selected = true; }
    }

    top.popupBlock('popDiv');
}
</script>