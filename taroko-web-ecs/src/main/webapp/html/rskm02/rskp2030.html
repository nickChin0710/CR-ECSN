<!--**************************************************************************-->
<!--                                                                          -->
<!--                              MODIFICATION LOG                            -->
<!--                                                                          -->
<!--    DATE    VERSION     AUTHOR                 DESCRIPTION                -->
<!-- ---------  --------  -----------    ------------------------------------ -->
<!-- 109-08-19   V1.00.01  JH                                                 -->
<!-- 109-01-06   V1.00.02  Justin Wu     updated for archit.                  -->
<!--**************************************************************************-->
<html>
<head>
<title>期中覆審產生名單查詢處理</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/ecsBank.css" type="text/css">
<script language="JavaScript" src="js/jquery.js"></script>
<link rel="stylesheet" href="js/Calendar/calendar.css">
</head>
<script language="JavaScript" src="js/Calendar/calendar_db.js"></script>

<body background="${water_mark}" >
<form  name="dataForm" method="post" action="" >

<div id="condBlock">
<table width="60%" border="0" cellspacing="0" cellpadding="4">
  <tr>
   <td nowrap>&nbsp;登錄類別：
      <select   size="1"  name="ex_regist_type" class="col_ddlb">
         <option value="0" ${ex_regist_type-0} >0.全部&nbsp;</option>
         <option value="1" ${ex_regist_type-1} >1.人工匯入&nbsp;</option>
         <option value="2" ${ex_regist_type-2} >2.批次產生&nbsp;</option>
      </select>
   </td>
   <td nowrap >&nbsp;查詢批次:
      <input type="text" class="col_text" name="ex_batch_no" value="${ex_batch_no}" maxlength="10" size="12" >
   </td>
   <td nowrap>&nbsp;  
      <input type="Button" value="查詢" onClick="return top.submitControl('Q')" class="btQuery" >&nbsp;&nbsp;
      <input type="Button" value="清除" onClick="return top.submitControl('L')" class="btClear" >&nbsp;&nbsp;
   </td>   
  </tr>
  <tr>
   <td nowrap  >&nbsp;查詢日期:
      <input type="text" class="col_date" name="ex_query_date1" value="${ex_query_date1}"
         zEdit="date,yyyymmdd" MaxLength=8 size=10  />
         <script language="JavaScript">
	        new tcal ({'formname': 'dataForm','controlname': 'ex_query_date1'});
	      </script>
	      --
	      <input type="text" class="col_date" name="ex_query_date2" value="${ex_query_date2}"
         zEdit="date,yyyymmdd" MaxLength=8 size=10 />
         <script language="JavaScript">
	        new tcal ({'formname': 'dataForm','controlname': 'ex_query_date2'});
	      </script>
	</td>
	<td nowrap >&nbsp;傳輸方式:
	   <span class="col_radio">
         <input type="radio" value="A" name="ex_trans_type" ${ex_trans_type-A} ${default-ex_trans_type} />全部
         <input type="radio" value="F" name="ex_trans_type" ${ex_trans_type-F} />FTP
         <input type="radio" value="M" name="ex_trans_type" ${ex_trans_type-M} />MQ
      </span>
   </td>
   <td nowrap >&nbsp;
      <input type="Button" value="產生名單" onClick="return top.submitControl('C')" class="btConfirm" >&nbsp;&nbsp;
      <input type="Button" value="刪除名單" onClick="return wf_ajax_delete();" class="btConfirm" >&nbsp;&nbsp;
      <input type="Button" value="轉入JCIC查詢檔" onClick="return top.submitControl('C2')" class="btConfirm" >&nbsp;&nbsp;
  </tr>
  <tr>
  	<td nowrap colspan="3" class="td_remark">
  			&nbsp;1.少量查詢筆數傳輸方式請點選MQ, (./media/col)<br>
  			&nbsp;2.傳輸方式點選"全部"將以「FTP」方式傳送, (./media/rpt)
  	</td>
  </tr>
 </table>
</div>
<hr>
 <table id="table1" class="sortable" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <th nowrap width="5%">No&nbsp;</th>
    <th nowrap >查詢批次&nbsp;</th>
    <th nowrap >查詢日期&nbsp;</th>
    <th nowrap >登錄類別&nbsp;</th>
    <th nowrap >名單<br>產生日期</th>
    <th nowrap >產生筆數&nbsp;</th>
    <th nowrap >轉入<br>JCIC日期</th>
    <th nowrap >轉入<br>JCIC筆數</th>
    <th nowrap >未轉入<br>JCIC筆數</th>
    <th nowrap >查詢原因&nbsp;</th>
    <th nowrap >傳輸方式&nbsp;</th>
    <th nowrap >匯入媒體檔&nbsp;</th>
  </tr>
  <!-- BEGIN DYNAMIC : DETAIL -->
  <tr>
   <td nowrap class="list_no">
	   <span class="dsp_flag">${ok_flag}</span>
	   <input type="radio" name="opt" value="${ser_num}" ${opt_on} onchange="wf_opt_select(${row_num});" >
 	   ${SER_NUM}&nbsp;
	   <input type="hidden" name="ser_num" value="${ser_num}" />
	   <input type="hidden" name="row_num" value="${row_num}" />
	</td>
   <td nowrap class="list_cc"> ${batch_no}&nbsp;
      <input type="hidden" name="batch_no" value="${batch_no}">
   </td>
	<td nowrap class="list_cc"> ${query_date.YMD}&nbsp;
      <input type="hidden" name="query_date" value="${query_date}">
   </td>
   <td nowrap class="list_cc"> ${regist_type}.${tt_regist_type}&nbsp;
      <input type="hidden" name="regist_type" value="${regist_type}">
      <input type="hidden" name="tt_regist_type" value="${tt_regist_type}">
   </td>
   <td nowrap class="list_cc"> ${list_crt_date.YMD}&nbsp;
      <input type="hidden" name="list_crt_date" value="${list_crt_date}">
   </td>
   <td nowrap class="list_rr"> ${list_crt_rows.(999)}&nbsp;
      <input type="hidden" name="list_crt_rows" value="${list_crt_rows}">
   </td>
   <td nowrap class="list_cc"> ${imp_jcic_date.YMD}&nbsp;
      <input type="hidden" name="imp_jcic_date" value="${imp_jcic_date}">
   </td>
   <td nowrap class="list_rr"> ${imp_jcic_rows.(999)}&nbsp;
      <input type="hidden" name="imp_jcic_rows" value="${imp_jcic_rows}">
   </td>
   <td nowrap class="list_rr"> ${db_unimp_row.(999)}&nbsp;
      <input type="hidden" name="db_unimp_row" value="${db_unimp_row}">
   </td>
   <td nowrap class="list_ll"> ${trial_reason}&nbsp;
      <input type="hidden" name="trial_reason" value="${trial_reason}">
   </td>
   <td nowrap class="list_cc"> ${trans_type}&nbsp;
      <input type="hidden" name="trans_type" value="${trans_type}">
   </td>
   <td nowrap class="list_ll"> ${imp_file_name}&nbsp;
      <input type="hidden" name="imp_file_name" value="${imp_file_name}">
   </td>
	</tr>
  <!-- END DYNAMIC : DETAIL -->
 </table>

 <input type="hidden"  name="db_batch_no" value="" size=10 />
 <input type="hidden"  name="conf_flag" value="" />
 <input type="hidden"  id="conf_mesg" value="${conf_mesg}" />

 <input type="hidden"  name="HIDE"  value="${HIDE_DATA}" />
 <input type="hidden"  name="pageType"  value="cond" />

</form>
</body>
</html>


<script language=JavaScript src="js/tigra_tables.js"></script>
<script language="JavaScript">
	tigra_tables('table1');
</script>

<script language="JavaScript" src="js/AJAXFunction_11.js"></script>
<script language="javascript">

 top.refreshButton2('0');
 top.pageRows="20";

 function wf_opt_select(parm1) {
   var ii =parseInt(parm1);
   var ls_bb2 =document.getElementsByName("batch_no")[ii].value;
   //alert("BB="+ls_bb2);
   document.forms['dataForm']['db_batch_no'].value =ls_bb2
 }

 function validateInput()
  {
    if ( !top.checkFormat() )
       { return false; }
    return true;
  }

function wf_ajax_delete() {
    resetJSON();
    var ls_batch_no = $("input[name=db_batch_no]").val();
    //alert("batch_no="+ls_batch_no);
    var form_data = "ax_batch_no="+ls_batch_no;
    set_hideData();
    var serv_url ="MainControl?HIDE="+top.hideData;
    $.ajax({
        url : serv_url,
        type: 'POST',
        data : form_data,
        success: function (response) {
          decodeJSON(response);
          ajaxResponse();
        },
        error: function (jqXHR, textStatus, errorMessage) {
           alert("form.submit.error="+errorMessage);
        }
    });
}

function set_hideData() {
    // top.methodName  = "wf_ajax_confirm"; // 20200102 updated for archit.  change
    top.actionCode  = "AJAX"
    top.hideData   = "";
    top.createHideData();
}
function ajaxResponse() {
    top.respHtml ="rskp2030";
    top.requHtml ="rskp2030";
    var ls_mesg =$('#conf_mesg').val();
    var ls_conf =getJSONvalue("conf_flag",0);
    if (ls_conf=='Y1') {
        var resp =confirm("是否刪除 已產生(匯入)之名單");
         if (resp==false) {
            return false;
         }
       top.deleteConfirm_show ="";
    }
    if (ls_conf=='Y2') {
        var resp =confirm("未產生名單, 是否刪除");
         if (resp==false) {
            return false;
         }
       top.deleteConfirm_show ="";
    }
    top.submitControl('D');
}

</script>
